<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><title>PHP实现简单图片验证码 | 冰是睡着的水的博客</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="验证码是网站会员系统中不可缺少的，目前验证码有很多种，但用的比较多的还是图片验证码，这里就用面向对象的方式来简单的实现图片验证码，"><meta name="keywords" content="PHP,验证码"><meta property="og:type" content="article"><meta property="og:title" content="PHP实现简单图片验证码"><meta property="og:url" content="http://yoursite.com/2017/12/07/PHP实现简单图片验证码/index.html"><meta property="og:site_name" content="冰是睡着的水的博客"><meta property="og:description" content="验证码是网站会员系统中不可缺少的，目前验证码有很多种，但用的比较多的还是图片验证码，这里就用面向对象的方式来简单的实现图片验证码，"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://www.changbin.me/wp-content/uploads/2017/12/newscreen694839625.jpg"><meta property="og:updated_time" content="2019-02-28T05:32:26.399Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="PHP实现简单图片验证码"><meta name="twitter:description" content="验证码是网站会员系统中不可缺少的，目前验证码有很多种，但用的比较多的还是图片验证码，这里就用面向对象的方式来简单的实现图片验证码，"><meta name="twitter:image" content="http://www.changbin.me/wp-content/uploads/2017/12/newscreen694839625.jpg"><link rel="alternate" href="/atom.xml" title="冰是睡着的水的博客" type="application/atom+xml"><link rel="icon" href="/favicon.png"><link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/style.css"></head></html><body><div id="container"><div id="wrap"><header id="header"><div id="banner"></div><div id="header-outer" class="outer"><div id="header-title" class="inner"><h1 id="logo-wrap"><a href="/" id="logo">冰是睡着的水的博客</a></h1><h2 id="subtitle-wrap"><a href="/" id="subtitle">我的编程笔记和一些计算机的实用教程</a></h2></div><div id="header-inner" class="inner"><nav id="main-nav"><a id="main-nav-toggle" class="nav-icon"></a> <a class="main-nav-link" href="/">首页</a> <a class="main-nav-link" href="/archives">归档</a></nav><nav id="sub-nav"><a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a> <a id="nav-search-btn" class="nav-icon" title="搜索"></a></nav><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div></div></div></header><div class="outer"><section id="main"><article id="post-PHP实现简单图片验证码" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2017/12/07/PHP实现简单图片验证码/" class="article-date"><time datetime="2017-12-06T16:35:39.000Z" itemprop="datePublished">2017-12-07</time></a><div class="article-category"><a class="article-category-link" href="/categories/PHP/">PHP</a></div></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">PHP实现简单图片验证码</h1></header><div class="article-entry" itemprop="articleBody"><p>验证码是网站会员系统中不可缺少的，目前验证码有很多种，但用的比较多的还是图片验证码，这里就用面向对象的方式来简单的实现图片验证码，<br><a id="more"></a></p><p>PHP代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Administrator</span></span><br><span class="line"><span class="comment"> * Date: 2017/10/6</span></span><br><span class="line"><span class="comment"> * Time: 20:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Verification</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $fontfile = <span class="string">''</span>;  <span class="comment">//  字体文件</span></span><br><span class="line">    <span class="keyword">protected</span> $width = <span class="number">120</span>;  <span class="comment">//  图片宽度 默认120</span></span><br><span class="line">    <span class="keyword">protected</span> $height = <span class="number">40</span>;  <span class="comment">//  图片高度  默认40</span></span><br><span class="line">    <span class="keyword">protected</span> $size = <span class="number">20</span>;  <span class="comment">//  字体大小  默认20</span></span><br><span class="line">    <span class="keyword">protected</span> $length = <span class="number">4</span>;  <span class="comment">//  长度  默认4个字</span></span><br><span class="line">    <span class="keyword">protected</span> $image = <span class="keyword">null</span>;  <span class="comment">//  画布资源</span></span><br><span class="line">    <span class="keyword">protected</span> $snow = <span class="number">0</span>;  <span class="comment">//  雪花干扰  默认没有干扰</span></span><br><span class="line">    <span class="keyword">protected</span> $pixel = <span class="number">0</span>;  <span class="comment">//  像素点干扰  默认没有干扰</span></span><br><span class="line">    <span class="keyword">protected</span> $line = <span class="number">0</span>;  <span class="comment">//  线段干扰  默认没有干扰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//  初始化数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($config = array<span class="params">()</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($config) &amp;&amp; count($config) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//  检测字体文件是否存在</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'fontfile'</span>]) &amp;&amp; is_file($config[<span class="string">'fontfile'</span>])) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;fontfile = $config[<span class="string">'fontfile'</span>];  <span class="comment">//  设置字体文件位置</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了宽度和宽度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'width'</span>]) &amp;&amp; $config[<span class="string">'width'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//  设置宽度属性为传入的宽度</span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;width = (int)$config[<span class="string">'width'</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入高度和高度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'height'</span>]) &amp;&amp; $config[<span class="string">'height'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;height = (int)$config[<span class="string">'height'</span>];  <span class="comment">//  设置高度属性</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了字体大小和是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'size'</span>]) &amp;&amp; $config[<span class="string">'size'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;size = (int)$config[<span class="string">'size'</span>];  <span class="comment">//  设置字体大小属性</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了验证码长度和长度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'length'</span>]) &amp;&amp; $config[<span class="string">'length'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;length = (int)$config[<span class="string">'length'</span>];  <span class="comment">//  设置长度</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了雪花干扰以及雪花数量是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'snow'</span>]) &amp;&amp; $config[<span class="string">'lsnow'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;snow = (int)$config[<span class="string">'snow'</span>];  <span class="comment">//  设置雪花干扰</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了像素点干扰和数量是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'pixel'</span>]) &amp;&amp; $config[<span class="string">'pixel'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;pixel = (int)$config[<span class="string">'pixel'</span>];  <span class="comment">//  设置像素点干扰</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了线条干扰和线条数量</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'line'</span>]) &amp;&amp; $config[<span class="string">'line'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;line = (int)$config[<span class="string">'line'</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;image = imagecreatetruecolor(<span class="keyword">$this</span>-&gt;width,<span class="keyword">$this</span>-&gt;height);  <span class="comment">//  创建画布</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;image;  <span class="comment">//  返回i画布资源</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成验证码</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCaptcha</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//  创建白色作为背景</span></span><br><span class="line">        $white = imagecolorallocate(<span class="keyword">$this</span>-&gt;image,<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">        <span class="comment">//  填充背景颜色</span></span><br><span class="line">        imagefilledrectangle(<span class="keyword">$this</span>-&gt;image, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">$this</span>-&gt;width, <span class="keyword">$this</span>-&gt;height, $white);</span><br><span class="line">        <span class="comment">//  调用生成验证码内容的方法</span></span><br><span class="line">        $str = <span class="keyword">$this</span>-&gt;generateStr(<span class="keyword">$this</span>-&gt;length);</span><br><span class="line">        <span class="comment">//  判断生成内容是否成功</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">false</span> === $str) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $fontfile = <span class="keyword">$this</span>-&gt;fontfile;  <span class="comment">//  设置字体文件位置</span></span><br><span class="line">        <span class="comment">//  使用for循环来生成图片验证码，循环次数是验证码的长度</span></span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;length;$i ++) &#123;</span><br><span class="line">            $size = <span class="keyword">$this</span>-&gt;size;  <span class="comment">//  设置字体大小</span></span><br><span class="line">            $angle = rand(<span class="number">-30</span>, <span class="number">30</span>);  <span class="comment">//  设置字体角度</span></span><br><span class="line">            $x = ceil(<span class="keyword">$this</span>-&gt;width / <span class="keyword">$this</span>-&gt;length) * $i + rand(<span class="number">5</span>, <span class="number">10</span>);  <span class="comment">//  设置X轴位置</span></span><br><span class="line">            $y = ceil(<span class="keyword">$this</span>-&gt;height / <span class="number">1.5</span>);  <span class="comment">//  设置X轴位置</span></span><br><span class="line">            <span class="comment">//  设置字体颜色，调用生成随机颜色的方法</span></span><br><span class="line">            $color = <span class="keyword">$this</span>-&gt;getRandColor();</span><br><span class="line">            $text = $str&#123;$i&#125;;  <span class="comment">//  设置验证码内容</span></span><br><span class="line">            <span class="comment">//  把验证码添加到画布上</span></span><br><span class="line">            imagettftext(<span class="keyword">$this</span>-&gt;image, $size, $angle, $x, $y, $color, $fontfile, $text);  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//  是否需要雪花干扰</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;snow &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;getSnow();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  只有在没有雪花干扰的情况下才可以使用像素点和线段干扰</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;pixel) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;getPixel();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;line) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;getLine();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        header(<span class="string">'content-type:image/png'</span>);  <span class="comment">//  设置显示方式</span></span><br><span class="line">        imagepng(<span class="keyword">$this</span>-&gt;image);  <span class="comment">//  把生成的验证码图片显示在网页上</span></span><br><span class="line">        imagedestroy(<span class="keyword">$this</span>-&gt;image);  <span class="comment">//  销毁画布 节省资源</span></span><br><span class="line">        <span class="keyword">return</span> strtolower($str);  <span class="comment">//  返回生成的验证码内容，用来设置session验证</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成雪花干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getSnow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;snow;$i ++) &#123;</span><br><span class="line">            imagestring(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">1</span>, <span class="number">5</span>), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="string">'*'</span>, <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成像素点干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getPixel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;pixel;$i ++) &#123;</span><br><span class="line">            imagesetpixel(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  线段干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getLine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;line;$i ++) &#123;</span><br><span class="line">            imageline(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成验证码字符</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">generateStr</span><span class="params">($length = <span class="number">4</span>)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//  判断验证码长度是否小于1或大于30</span></span><br><span class="line">        <span class="keyword">if</span> ($length &lt; <span class="number">1</span> || $length &gt; <span class="number">30</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  验证码可能出现的内容</span></span><br><span class="line">            $chars = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>,</span><br><span class="line">                <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>,<span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>,</span><br><span class="line">                <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//  取出指定长度的验证码</span></span><br><span class="line">        $str = join(<span class="string">''</span>, array_rand(array_flip($chars), $length));</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  用来生成随机颜色的</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandColor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imagecolorallocate(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="number">255</span>), rand(<span class="number">0</span>, <span class="number">255</span>), rand(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用方法</p><p>对象接收一个数组，除字体文件以外其他参数可以省略，省略的参数会使用默认参数</p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Administrator</span></span><br><span class="line"><span class="comment"> * Date: 2017/10/8</span></span><br><span class="line"><span class="comment"> * Time: 16:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'verification_class.php'</span>;  <span class="comment">//  引入类文件</span></span><br><span class="line">$arr = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'fontfile'</span>=&gt;<span class="string">'fonts/arial.ttf'</span>,  <span class="comment">//  字体文件位置</span></span><br><span class="line">    <span class="string">'line'</span>=&gt;<span class="number">4</span>,  <span class="comment">//  设置线条干扰数量为4</span></span><br><span class="line">    <span class="string">'pixel'</span>=&gt;<span class="number">50</span>  <span class="comment">//  设置像素点干扰为50</span></span><br><span class="line">);</span><br><span class="line">$img = <span class="keyword">new</span> Verification($arr);  <span class="comment">//  实例化对象并且传入数组</span></span><br><span class="line">session_start();  <span class="comment">//  启用session</span></span><br><span class="line">$_SESSION[<span class="string">'str'</span>] = $img-&gt;getCaptcha();  <span class="comment">//  把返回的验证码保存到session</span></span><br></pre></td></tr></table></figure><p>完整的传入数组参数可在类属性看到</p><p>最终效果</p><p><img src="http://www.changbin.me/wp-content/uploads/2017/12/newscreen694839625.jpg" alt="验证码图片"></p><p>验证码的每一个字都是随机颜色，角度也是随机的，如果要让验证码在img标签显示 就把img的src设置为调用类的php文件即可。</p><p>验证方法</p><p>直接判断表单提交的参数和session保存的验证码是否一致即可。</p><p>这就是简单实现图片验证码的方法，这个验证码还有很大的优化空间。</p><p>代码下载可点击下方的下载代码链接，百度网盘提取码：w39g</p><p><a href="https://pan.baidu.com/s/1pKU5PB9" target="_blank" rel="noopener">下载代码</a></p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p></div><footer class="article-footer"><a data-url="http://yoursite.com/2017/12/07/PHP实现简单图片验证码/" data-id="cjsoum63m00303gtlijbt7ti3" class="article-share-link">Share</a><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/验证码/">验证码</a></li></ul></footer></div><nav id="article-nav"><a href="/2017/12/07/HTML5-localStorage简单使用方法/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">HTML5 localStorage简单使用方法</div></a></nav></article></section><aside id="sidebar"><div class="widget-wrap"><h3 class="widget-title">分类</h3><div class="widget"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Linux相关/">Linux相关</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/实用教程/">实用教程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">标签</h3><div class="widget"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AJAX/">AJAX</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSON/">JSON</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VPS/">VPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Win10/">Win10</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jQuery/">jQuery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/上传文件/">上传文件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/下载/">下载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/域名/">域名</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库/">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/验证码/">验证码</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">标签云</h3><div class="widget tagcloud"><a href="/tags/AJAX/" style="font-size:15px">AJAX</a> <a href="/tags/HTML5/" style="font-size:12.5px">HTML5</a> <a href="/tags/JSON/" style="font-size:10px">JSON</a> <a href="/tags/JavaScript/" style="font-size:12.5px">JavaScript</a> <a href="/tags/Linux/" style="font-size:17.5px">Linux</a> <a href="/tags/Mysql/" style="font-size:15px">Mysql</a> <a href="/tags/PHP/" style="font-size:20px">PHP</a> <a href="/tags/VPS/" style="font-size:12.5px">VPS</a> <a href="/tags/Win10/" style="font-size:12.5px">Win10</a> <a href="/tags/jQuery/" style="font-size:10px">jQuery</a> <a href="/tags/上传文件/" style="font-size:12.5px">上传文件</a> <a href="/tags/下载/" style="font-size:10px">下载</a> <a href="/tags/域名/" style="font-size:10px">域名</a> <a href="/tags/数据库/" style="font-size:12.5px">数据库</a> <a href="/tags/验证码/" style="font-size:10px">验证码</a></div></div><div class="widget-wrap"><h3 class="widget-title">归档</h3><div class="widget"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li></ul></div></div><div class="widget-wrap"><h3 class="widget-title">最新文章</h3><div class="widget"><ul><li><a href="/2018/11/17/在namesilo购买域名/">在namesilo购买域名</a></li><li><a href="/2018/10/24/PHP-PDO简单使用教程/">PHP PDO简单使用教程</a></li><li><a href="/2018/09/28/关于Linux的软链接和硬链接/">关于Linux的软链接和硬链接</a></li><li><a href="/2018/09/11/使用Linux-VPS-宝塔Linux面板快速搭建网站/">使用Linux VPS + 宝塔Linux面板快速搭建网站</a></li><li><a href="/2018/08/30/启用Win10的Linux子系统/">启用Win10的Linux子系统</a></li></ul></div></div></aside></div><footer id="footer"><div class="outer"><div id="footer-info" class="inner">&copy; 2019 冰是睡着的水<br>Email <a href="javascript:;" target="_blank">email@changbin.me</a></div></div></footer></div><nav id="mobile-nav"><a href="/" class="mobile-nav-link">首页</a> <a href="/archives" class="mobile-nav-link">归档</a></nav><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/js/script.js"></script></div></body>