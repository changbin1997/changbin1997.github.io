<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JavaScript拖拽文件上传和本地图片预览</title>
      <link href="/2019/03/09/JavaScript%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88/"/>
      <url>/2019/03/09/JavaScript%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E6%9C%AC%E5%9C%B0%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88/</url>
      
        <content type="html"><![CDATA[<p>在图形界面的操作系统中，拖拽操作应该是一个比较常见的功能，例如，对于电脑小白来说最简单的删除文件的方式就是直接将文件拖到桌面上的垃圾桶图标，需要打开文件的时候也是直接把文件拖到相应的软件里。拖拽操作可以说是极大的降低了计算机的使用难度，哪怕是不懂计算机的老人或小孩都能很方便的操作。<br><a id="more"></a></p><h2 id="拖拽文件上传"><a href="#拖拽文件上传" class="headerlink" title="拖拽文件上传"></a>拖拽文件上传</h2><p>目前大多数的网络相册和网盘都支持直接拖拽文件上传，例如，百度网盘、Google云端硬盘、Google相册 等，都支持拖拽文件上传。不过要使用拖拽文件上传浏览器必须要能很好的支持HTML5，也就是说那些老IE都是用不了的。</p><p>这里先放一个 <code>div</code> 来接收文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>把文件拖到此处上传<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>给 <code>div</code> 加一些CSS方便查看：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#00e080</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="https://www.changbin.me/img/拖拽文件截图.png" alt="拖拽文件截图"></p><p>我这里只是为了方便演示，在实际的开发中接收文件的范围可以大一些，下面是JS：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Div = <span class="built_in">document</span>.querySelector(<span class="string">'div'</span>);  <span class="comment">//  获取div</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  文件进入div</span></span><br><span class="line">Div.ondragenter = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  阻止浏览器默认事件</span></span><br><span class="line">    event.preventDefault();</span><br><span class="line">    event.stopPropagation();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  文件在div上，但是还未松开鼠标</span></span><br><span class="line">Div.ondragover = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  阻止浏览器默认事件</span></span><br><span class="line">    event.preventDefault();</span><br><span class="line">    event.stopPropagation();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  文件进入Div并且已经松开鼠标</span></span><br><span class="line">Div.ondrop = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  阻止浏览器默认事件</span></span><br><span class="line">    event.preventDefault();</span><br><span class="line">    event.stopPropagation();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  把文件传入files变量，有的浏览器需要通过event获取</span></span><br><span class="line">    <span class="keyword">var</span> files = <span class="keyword">this</span>.files || event.dataTransfer.files;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//  新建FormData对象</span></span><br><span class="line">    <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    <span class="comment">//  封装一个formData</span></span><br><span class="line">    formData.append(<span class="string">'files'</span>, files[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新建XMLHttpRequest对象</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">//  设置提交方式 url 是否异步</span></span><br><span class="line">    xhr.open(<span class="string">'post'</span>, <span class="string">'server.php'</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//  设置请求头</span></span><br><span class="line">    xhr.setRequestHeader(<span class="string">'X-Request-With'</span>, <span class="string">'XMLHttpRequest'</span>);</span><br><span class="line">    <span class="comment">//  提交数据，传入已封装的FormData</span></span><br><span class="line">    xhr.send(formData);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  此方法在成功提交并接收到数据的时候触发</span></span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//  验证一下是否全部接收完成</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="comment">//  在控制台输出接收到的数据</span></span><br><span class="line">            <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这里因为有注释和空行，所以看起来内容很多，实际上很简单，下面是详细说明：</p><h3 id="dragenter-事件"><a href="#dragenter-事件" class="headerlink" title="dragenter  事件"></a>dragenter 事件</h3><p>被拖动的内容进入目标元素时触发，上面的文件如果拖入到div就会触发，在不放开鼠标的情况下也会触发，<code>event.preventDefault()</code> 主要是禁止浏览器的默认事件，有的浏览器文件拖入以后可能会直接读取文件，详细的 <code>preventDefault</code> 说明可以访问： <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Event/preventDefault" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/Event/preventDefault</a> 。<code>event.stopPropagation()</code> 主要是阻止冒泡，详细的可以看： <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopPropagation" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopPropagation</a> 。</p><h3 id="dragover-事件"><a href="#dragover-事件" class="headerlink" title="dragover  事件"></a>dragover 事件</h3><p>被拖动的内容在目标元素上时触发，而且是连续触发，上面 的文件拖入 <code>div</code> 内只要不离开就会连续触发。</p><h3 id="drop-事件"><a href="#drop-事件" class="headerlink" title="drop  事件"></a>drop 事件</h3><p>被拖动的内容进入目标元素并且已经放开鼠标时触发，上面的文件进入 <code>div</code> 放开鼠标后触发，如果文件移出 <code>div</code> 放开鼠标也不会触发。</p><h3 id="this-files"><a href="#this-files" class="headerlink" title="this.files"></a>this.files</h3><p>获取拖入的文件列表，有的浏览器可能用不了。</p><h3 id="event-dataTransfer-files-属性"><a href="#event-dataTransfer-files-属性" class="headerlink" title="event.dataTransfer.files  属性"></a>event.dataTransfer.files 属性</h3><p>获取拖入的文件列表，有的浏览器可能不支持。</p><p>上面的两种方式都是获取拖入的文件列表，文件拖入后会返回一个包含文件列表的数组，数组的长度取决于文件数量。我上面上传的是第一个文件。文件列表中的文件又包含一些属性，下面是详细说明：</p><table><thead><tr><th>属性</th><th>类型</th><th>读/写</th><th>说明</th></tr></thead><tbody><tr><td>lastModified</td><td>Number</td><td>只读</td><td>文件最后修改时间，1970年1月1日到现在的时间戳。</td></tr><tr><td>lastModifiedDate</td><td>object</td><td>只读</td><td>文件的最后修改日期。</td></tr><tr><td>name</td><td>string</td><td>只读</td><td>文件名，不包含路径。</td></tr><tr><td>type</td><td>string</td><td>只读</td><td>文件类型，如 image/png 。</td></tr><tr><td>size</td><td>Number</td><td>只读</td><td>文件大小（字节）。</td></tr></tbody></table><p>以上面的 <strong>files</strong> 数组为例，我想获取第一个文件的大小，代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">files[<span class="number">0</span>].size</span><br></pre></td></tr></table></figure><p>到这里拖拽的部分就算是写完了，关于 <code>FormData</code> 和 <code>XMLHttpRequest</code> 可以看下面两篇文章：</p><ul><li><a href="https://www.changbin.me/index.php/2018/07/25/%e4%bd%bf%e7%94%a8ajax-formdata%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">使用AJAX + FORMDATA上传文件</a></li><li><a href="https://www.changbin.me/index.php/2018/04/17/ajax%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8%e6%95%99%e7%a8%8b/" target="_blank" rel="noopener">AJAX简单使用教程</a></li></ul><p>这里获取的files文件对象和文件表单的files对象是一样的。</p><h2 id="预览本地图片"><a href="#预览本地图片" class="headerlink" title="预览本地图片"></a>预览本地图片</h2><p>在用户上传头像或各种图片背景时可以在正式上传之前就加载图片让用户预览，满意在上传，避免用户多次更换头像造成服务器带宽和空间的浪费。</p><p>这里用的是文件表单选择文件，用拖拽的方式也可以实现，主要还是需要files对象，下面是HTML：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">""</span> <span class="attr">alt</span>=<span class="string">"图片"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>设置一下 <code>img</code> 的宽度和高度，方便演示：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">img</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">640px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">360px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#0063b1</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果如下：</p><p><img src="https://www.changbin.me/img/img标签.png" alt="img"></p><p>在实际开发中可以隐藏文件表单，用按钮调用文件表单来选择文件。</p><p>下面是JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Img = <span class="built_in">document</span>.querySelector(<span class="string">'img'</span>);  <span class="comment">//  获取img</span></span><br><span class="line"><span class="keyword">var</span> fileInput = <span class="built_in">document</span>.querySelector(<span class="string">'input'</span>);  <span class="comment">//  获取文件表单</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  文件表单的内容改变，也就是选择完文件触发</span></span><br><span class="line">fileInput.onchange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  如果未选择任何文件</span></span><br><span class="line">    <span class="keyword">if</span> (fileInput.value == <span class="string">''</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  创建FileReader对象</span></span><br><span class="line">    <span class="keyword">var</span> reader = <span class="keyword">new</span> FileReader();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  读取文件</span></span><br><span class="line">    reader.readAsDataURL(fileInput.files[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  读取文件完成时触发</span></span><br><span class="line">    reader.onload = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//  设置img的src</span></span><br><span class="line">        Img.src = event.target.result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>最终效果如下：</p><p><img src="https://www.changbin.me/img/图片预览.gif" alt="图片预览"></p><p>下面是详细说明：</p><h3 id="change-事件"><a href="#change-事件" class="headerlink" title="change  事件"></a>change 事件</h3><p>在域的内容改变时触发，例如input的内容改变就会触发，选择完文件后文件表单的value会变为选择的文件的文件名，如果选择了多个文件也只会显示第一个文件的文件名。</p><h3 id="FileReader-对象"><a href="#FileReader-对象" class="headerlink" title="FileReader  对象"></a>FileReader 对象</h3><p><strong>FileReader</strong> 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容，使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/File" target="_blank" rel="noopener"><code>File</code></a> 或 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Blob" target="_blank" rel="noopener"><code>Blob</code></a> 对象指定要读取的文件或数据。</p><h3 id="readAsDataURL-方法"><a href="#readAsDataURL-方法" class="headerlink" title="readAsDataURL()  方法"></a>readAsDataURL() 方法</h3><p>readAsDataURL 方法会读取指定的 Blob 或 File 对象。读取操作完成的时候，readyState 会变成已完成DONE，并触发 loadend 事件，同时 result 属性将包含一个data:URL格式的字符串（base64编码）以表示所读取文件的内容。</p><h3 id="FileReader-onload-事件"><a href="#FileReader-onload-事件" class="headerlink" title="FileReader.onload  事件"></a>FileReader.onload 事件</h3><p>FileReader的onload事件会在文件读取完成时触发。</p><p>下面是 <code>FileReader</code> 的一些事件说明：</p><table><thead><tr><th>事件</th><th>说明</th></tr></thead><tbody><tr><td>FileReader.onabort</td><td>处理abort事件。该事件在读取操作被中断时触发。</td></tr><tr><td>FileReader.onerror</td><td>处理error事件。该事件在读取操作发生错误时触发。</td></tr><tr><td>FileReader.onload</td><td>处理load事件。该事件在读取操作完成时触发。</td></tr><tr><td>FileReader.onloadstart</td><td>处理loadstart事件。该事件在读取操作开始时触发。</td></tr><tr><td>FileReader.onloadend</td><td>处理loadend事件。该事件在读取操作结束时（要么成功，要么失败）触发。</td></tr><tr><td>FileReader.onprogress</td><td>处理progress事件。该事件在读取Blob时触发。</td></tr></tbody></table><h3 id="event-target-result-属性"><a href="#event-target-result-属性" class="headerlink" title="event.target.result  属性"></a>event.target.result 属性</h3><p>在 <code>readAsDataURL</code> 读取文件完成后会返回一个URL，把img的src设置为 <code>readAsDataURL</code> 返回的图片URL就能显示图片了。</p><p>以上就是JavaScript拖拽文件上传和预览本地图片的方法，无论是拖拽上传还是预览本地图片都需要浏览器支持HTML5。</p><p>相关参考文章：</p><ul><li><a href="https://www.changbin.me/index.php/2018/07/25/%e4%bd%bf%e7%94%a8ajax-formdata%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">使用AJAX + FORMDATA上传文件</a></li><li><a href="https://www.changbin.me/index.php/2018/04/17/ajax%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8%e6%95%99%e7%a8%8b/" target="_blank" rel="noopener">AJAX简单使用教程</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader" target="_blank" rel="noopener">FileReader MDN文档</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/File" target="_blank" rel="noopener">File对象 MDN文档</a></li></ul><p><a href="https://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> HTML5 </tag>
            
            <tag> AJAX </tag>
            
            <tag> 上传文件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单给WordPress主题汉化</title>
      <link href="/2019/03/07/%E7%AE%80%E5%8D%95%E7%BB%99WordPress%E4%B8%BB%E9%A2%98%E6%B1%89%E5%8C%96/"/>
      <url>/2019/03/07/%E7%AE%80%E5%8D%95%E7%BB%99WordPress%E4%B8%BB%E9%A2%98%E6%B1%89%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>最近准备给博客换个主题，在Wordpress的主题库中找了一下发现很难找到合适的，大多主题都只适合用来作电商和企业官网。唯一找到几个比较适合作博客的还全是英文，没有中文翻译，最终只能自己手动来翻译，这里就简单记录一下翻译过程。<br><a id="more"></a><br>为了方便翻译，还需要下载一个名为 <a href="https://poedit.net/" target="_blank" rel="noopener">Poedit</a> 的软件，下面是维基百科对Poedit的简单介绍：</p><blockquote><p>Poedit是一个免费增值软件及跨平台的gettext类国际化翻译编辑器，也是同类型软件中最广泛使用的一个。现时它不论在Unix+GTK 或 Windows平台 配合wxWidgets 均有相关版本。</p></blockquote><p>Poedit的官网是： <a href="https://poedit.net/" target="_blank" rel="noopener">https://poedit.net/</a> 进入后直接下载和系统对应的版本，下载完成后安装，我这里以汉化一个未安装的Wordpress主题为例，一般未安装的主题都是zip的压缩包，解压压缩包，在主题目录下找到 <strong>languages</strong> 目录，看一下有没有 <strong>.pot</strong> 后缀的文件，如果有的话就可以使用Poedit打开翻译。打开Poedit后界面如下：</p><p><img src="https://wsmcb.github.io/img/Poedit界面.png" alt="Poedit界面"></p><p>Wordpress相关的翻译是需要购买专业版的，因为我的是免费版，所以只能完全手动了，点击 <strong>创建新的翻译</strong> 设置要翻译的语言，我选择的是简体中文，</p><p><img src="https://wsmcb.github.io/img/Poedit设置要翻译的语言.png" alt="Poedit设置要翻译的语言"></p><p>因为我用的是免费版，所以 <strong>预翻译</strong> 和 <strong>翻译建议</strong> 之类的功能都是不能用的，遇到不会的只能查词典或使用谷歌翻译了，不过还好我这个主题需要翻译的只有120多句。</p><p><img src="https://wsmcb.github.io/img/Poedit翻译界面.png" alt="Poedit翻译界面"></p><p>软件会提示需要翻译的句子数量和甚于的句子数量。</p><p>全部翻译完成后点击工具栏的保存按钮，保存到主题目录下的 <strong>languages</strong> 目录下，然后按原来的结构重新把主题压缩为zip，然后在Wordpress的添加主题的地方上传主题压缩包，启用 主题就可以看到效果了。</p><p>如果需要给一个已安装的主题汉化可以在 <strong>Wordpress目录/wp-content/themes/你的主题目录/languages目录</strong> 找到<strong>.pot</strong> 后缀的文件，把文件下载到本地，用Poedit按照上面的方法打开汉化，汉化完成后把生成的 <strong>zh_CN.mo</strong> 和 <strong>zh_CN.po</strong> 上传到 <strong>Wordpress目录/wp-content/themes/你的主题目录/languages目录</strong> 。</p><p>如果需要修改已汉化的语言文件可以在 <strong>Wordpress目录/wp-content/themes/你的主题目录/languages目录</strong> 找到 <strong>.po</strong> 后缀的语言文件，用Poedit打开编辑，编辑完成后保存。</p><p><a href="https://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>highlight.js一个在网页上实现代码高亮的JS库</title>
      <link href="/2019/03/05/highlight-js%E4%B8%80%E4%B8%AA%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%8A%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE%E7%9A%84JS%E5%BA%93/"/>
      <url>/2019/03/05/highlight-js%E4%B8%80%E4%B8%AA%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%8A%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE%E7%9A%84JS%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>目前的很多博客例如 <a href="https://wordpress.org/" target="_blank" rel="noopener">Wordpress</a> 、<a href="http://typecho.org/" target="_blank" rel="noopener">Typecho</a> 等默认的代码高亮效果都不是太好，我刚用 <a href="https://wordpress.org/" target="_blank" rel="noopener">Wordpress</a> 的时候默认就没有代码高亮功能，浏览器默认的代码高亮也基本和没有差不多，在代码比较多的情况下对于读者来说看起来还是比较费力的。对于一部分博客来说可以通过插件解决，但是如果你对插件的效果不满意的话就可以考虑使用highlight.js。<br><a id="more"></a><br><a href="https://highlightjs.org/" target="_blank" rel="noopener">highlight.js</a> 是一个能实现网页代码高亮功能的JS库，最多可支持185种语言的代码高亮和89种主题样式，目前主流的IDE主题样式在 <a href="https://highlightjs.org/" target="_blank" rel="noopener">highlight.js</a> 上都能实现。如果你想在网页 中实现代码高亮 <a href="https://highlightjs.org/" target="_blank" rel="noopener">highlight.js</a> 是一个不错的选择，<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a> 默认的代码高亮插件就是用 <a href="https://highlightjs.org/" target="_blank" rel="noopener">highlight.js</a> 实现的。</p><p>下图是浏览器默认的代码高亮，主要就是 <code>&lt;pre&gt;</code> 和 <code>&lt;code&gt;</code> 标签，基本没有什么效果：</p><p><img src="https://wsmcb.github.io/img/浏览器默认代码高亮.png" alt="浏览器默认代码高亮"></p><p>这种情况下一旦代码比较多看起来就比较费力了。</p><p>highLight.js的官网地址是： <a href="https://highlightjs.org/usage/" target="_blank" rel="noopener">https://highlightjs.org/usage/</a> ，进入后点击 <a href="https://highlightjs.org/download/" target="_blank" rel="noopener">Get version 9.15.6</a> 下载，版本号显示的可能会和我这里的不一样，选择需要的语言，选择完成后 点击 <strong>Download</strong> ，</p><p><img src="https://wsmcb.github.io/img/highlightjs选择需要的语言.png" alt="highlightjs选择需要的语言"></p><p>下载完成后是一个压缩包，主要需要用到的文件是 <strong>highlight.pack.js</strong> 和 <strong>styles</strong> 里的css主题，其他的是帮助文件和许可证，</p><p><img src="https://wsmcb.github.io/img/highlightjs文件结构.png" alt="highlightjs文件结构"></p><p>在网页中引入一个css主题和 <strong>highlight.pack</strong> 然后初始化，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/vs2015.css"</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/highlight.pack.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined">hljs.initHighlightingOnLoad();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>我这里选择的是VS2015主题，还有一种方式就是使用官方的CDM，不过在国内不一定稳定：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>初始化的部分还是一样的，代码使用 <code>&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;</code> 包裹，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line">        var a = 0;</span><br><span class="line">    </span><br><span class="line">        if (a == 0) &#123;</span><br><span class="line">            for (var i = 0;i <span class="tag">&lt; <span class="attr">10</span>;<span class="attr">i</span> ++) &#123;</span></span><br><span class="line"><span class="tag">                <span class="attr">console.log</span>(<span class="attr">i</span>);</span></span><br><span class="line"><span class="tag">            &#125;</span></span><br><span class="line"><span class="tag">        &#125;</span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag">        <span class="attr">function</span> <span class="attr">fn</span>() &#123;</span></span><br><span class="line"><span class="tag">            <span class="attr">console.log</span>('<span class="attr">Hello</span>');</span></span><br><span class="line"><span class="tag">        &#125;</span></span><br><span class="line">    &lt;/code&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>最终效果：</p><p><img src="https://wsmcb.github.io/img/highlightjs效果.png" alt="highlightjs效果"></p><p>highlight.js可以自动检测语言，你也可以给 <code>&lt;code&gt;</code> 标签加上类名，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">"html"</span>&gt;</span><span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure><p>要查看所有可用的class名可以访问： <a href="https://highlightjs.readthedocs.io/en/latest/css-classes-reference.html" target="_blank" rel="noopener">https://highlightjs.readthedocs.io/en/latest/css-classes-reference.html</a> ，如果要更换主题只需要更换css文件即可，</p><p><img src="https://wsmcb.github.io/img/highlightjs主题截图1.png" alt="highlightjs主题截图1"></p><p><img src="https://wsmcb.github.io/img/highlightjs主题截图2.png" alt="highlightjs主题截图2"></p><p>如需预览更多样式可以访问： <a href="https://highlightjs.org/static/demo/" target="_blank" rel="noopener">https://highlightjs.org/static/demo/</a> 。</p><p>如果要在Wordpress中使用highlight.js可以选择 <strong>外观</strong> -&gt; <strong>编辑</strong> 在 <strong>header.php</strong> 文件中引入css和js即可，需要插入代码的时候在编辑器中选择纯文本，然后加入 <code>&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;</code> 标签，或者也可以下载Markdown插件，用Markdown写，最终预览的时候也会被转为代码标签。</p><p><a href="https://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript操作Cookie</title>
      <link href="/2019/03/04/JavaScript%E6%93%8D%E4%BD%9CCookie/"/>
      <url>/2019/03/04/JavaScript%E6%93%8D%E4%BD%9CCookie/</url>
      
        <content type="html"><![CDATA[<p>HTTP Cookie（也叫Web Cookie或浏览器Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。Cookie使基于无状态的HTTP协议记录稳定的状态信息成为了可能。<br><a id="more"></a><br>目前大多数的网站都在使用Cookie，虽然现在有了localStorage，但是因为localStorage是HTML5中加入的，虽然HTML5标准已经制定很久了，但还是有少部分用户还在使用IE10以下的浏览器，而且localStorage只能由前端来操作，而Cookie后端也可以操作。</p><h2 id="Cookie和localStorage的区别"><a href="#Cookie和localStorage的区别" class="headerlink" title="Cookie和localStorage的区别"></a>Cookie和localStorage的区别</h2><p>Cookie和localStorage都是浏览器用来存储数据的，虽然都是存储数据的，但是区别还是很大的，下面简单对比一下区别：</p><h3 id="创建方式"><a href="#创建方式" class="headerlink" title="创建方式"></a>创建方式</h3><p>Cookie大多是有后端创建，但前端通过Javascript也可以创建。localStorage只能由前端创建，且后端无法访问。</p><h3 id="数据量"><a href="#数据量" class="headerlink" title="数据量"></a>数据量</h3><p>Cookie的大小一般不能超过4KB，而localStorage可以达到5MB。</p><h3 id="可访问性"><a href="#可访问性" class="headerlink" title="可访问性"></a>可访问性</h3><p>Cookie在发送HTTP请求的时候也会一起发送到服务器，后端也能访问，但是通过Javascript访问Cookie只能获取一堆字符串，如果要操作单条Cookie还要拆分过滤。而localStorage不会发送到服务器，所以只能由前端来操作，但是localStorage提供了一堆方法，非常方便前端操作。</p><h3 id="失效性"><a href="#失效性" class="headerlink" title="失效性"></a>失效性</h3><p>Cookie在存储的时候可以设置有效期，到期后Cookie将无法使用。localStorage没有有效期，只要不通过Javascript删除或清理浏览器就不会失效。</p><p>如果要了解localStorage的使用可以看： <a href="https://www.changbin.me/index.php/2017/12/07/html5-localstorage%e7%9a%84%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8/" target="_blank" rel="noopener">HTML5 localStorage的简单使用</a> 。</p><h2 id="JavaScript设置Cookie"><a href="#JavaScript设置Cookie" class="headerlink" title="JavaScript设置Cookie"></a>JavaScript设置Cookie</h2><p>写入Cookie的方式是使用 <code>document.cookie</code> ，下面存储一个名为 <strong>userName=123</strong> 的Cookie</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'userName=123'</span>;</span><br></pre></td></tr></table></figure><p>上面写入了一个 <strong>userName</strong> 的Cookie，没有设置有效期，关闭浏览器后失效。如果要加入过期时间可以这样写：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'userName=123;expires=Tue, 05 Mar 2019 00:00:00 GMT'</span>;</span><br></pre></td></tr></table></figure><p>键值对间用分号分隔，这里的过期时间为：2019年3月5日 00:00:00，时间格式如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2019-03-05'</span>);  <span class="comment">//  时间对象</span></span><br><span class="line"><span class="built_in">console</span>.log(date.toUTCString());  <span class="comment">//  在控制台输出UTC字符串</span></span><br><span class="line"><span class="comment">//  Tue, 05 Mar 2019 00:00:00 GMT</span></span><br></pre></td></tr></table></figure><p>在浏览器中也可以看到刚才设置的Cookie，</p><p><img src="https://wsmcb.github.io/img/cookie.png" alt="cookie"></p><p>使用 <code>path</code> 可以设置路径，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'userName=123;path=/dir'</span>;</span><br></pre></td></tr></table></figure><p>默认情况下路径和网页路径一样。使用 <code>domain</code> 可以设置域名，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'userName=123;domain=www.qq.com'</span>;</span><br></pre></td></tr></table></figure><p>同域下的目录都可以访问，默认情况下为当前目录的域名。</p><h2 id="JavaScript读取Cookie"><a href="#JavaScript读取Cookie" class="headerlink" title="JavaScript读取Cookie"></a>JavaScript读取Cookie</h2><p>读取Cookie也是用 <code>document.cookie</code> 如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Cookie = <span class="built_in">document</span>.cookie;  <span class="comment">//  读取Cookie</span></span><br><span class="line"><span class="built_in">console</span>.log(Cookie);  <span class="comment">//  在控制台输出</span></span><br></pre></td></tr></table></figure><p>控制台输出如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userName=<span class="number">123</span></span><br></pre></td></tr></table></figure><p>如果有多个Cookie输出如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userName=<span class="number">123</span>; password=<span class="number">123</span></span><br></pre></td></tr></table></figure><p>通过Javascript读取的Cookie都是字符串，如果想通过输入Cookie名来获取Cookie值就需要拆分字符串，下面来封装一个简单的获取Cookie的函数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> cookieArr = <span class="built_in">document</span>.cookie.split(<span class="string">'; '</span>);  <span class="comment">//  获取Cookie并分割为数组</span></span><br><span class="line">    <span class="keyword">var</span> cookie = <span class="string">''</span>;  <span class="comment">//  用来储存单对Cookie数组</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>;i &lt; cookieArr.length;i ++) &#123;</span><br><span class="line">        cookie = cookieArr[i].split(<span class="string">'='</span>);  <span class="comment">//  用=来分割数组</span></span><br><span class="line">        <span class="comment">//  如果传入的key和Cookie的key一致</span></span><br><span class="line">        <span class="keyword">if</span> (cookie[<span class="number">0</span>] == key) &#123;</span><br><span class="line">            <span class="keyword">return</span> cookie[<span class="number">1</span>];  <span class="comment">//  返回对应的value</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">//  如果循环完成还没有匹配到就返回false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面获取 <strong>userName</strong> 的值：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(getCookie(<span class="string">'userName'</span>));  <span class="comment">//  获取userName的值，并在控制台输出</span></span><br></pre></td></tr></table></figure><p>最终控制台就会输出 <strong>123</strong> 。</p><h2 id="删除Cookie"><a href="#删除Cookie" class="headerlink" title="删除Cookie"></a>删除Cookie</h2><p>如果要删除Cookie只需要让Cookie过期，代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.cookie = <span class="string">'userName=123;expires=Tue, 05 Mar 1970 00:00:00 GMT'</span>;</span><br></pre></td></tr></table></figure><p>直接设置一个同名的Cookie，然后在设置一个比当前时间更早的时间。</p><p><a href="https://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Github Pages + Hexo搭建个人静态博客（下）</title>
      <link href="/2019/02/28/%E4%BD%BF%E7%94%A8Github-Pages-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%8B%EF%BC%89/"/>
      <url>/2019/02/28/%E4%BD%BF%E7%94%A8Github-Pages-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%8B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在上一篇文章 <a href="http://www.changbin.me/index.php/2019/02/27/%E4%BD%BF%E7%94%A8github-pages-hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%8A%EF%BC%89/" target="_blank" rel="noopener">Github Pages + Hexo搭建个人博客（上）</a> 写了Hexo的搭建和基本使用，因为内容太多，所以只能分两篇写，这一篇主要是Github Pages的域名设置和其他的一些配置。<br><a id="more"></a></p><h2 id="设置域名"><a href="#设置域名" class="headerlink" title="设置域名"></a>设置域名</h2><p>Github Pages默认的域名都是 github.username.io，域名中还包括github的名称，别人一看就知道是使用Github Pages搭建的，还能直接通过域名找到你的Github账户，如果设置一个域名，至少不会在域名中暴露你的Github用户名，而且别人一看就知道是独立博客。不过一个域名一年至少也需要几十元，而Github的域名是免费的。</p><p>关于域名提供商，我个人比较推荐 <a href="https://www.namesilo.com/" target="_blank" rel="noopener">namesilo</a> ，如果要在namesilo购买域名可以看： <a href="http://www.changbin.me/index.php/2018/11/17/%E5%9C%A8namesilo%E8%B4%AD%E4%B9%B0%E5%9F%9F%E5%90%8D/" target="_blank" rel="noopener">在namesilo购买域名</a> ，如果要在国内购买的话 阿里云这一类的都可以，但是国内购买的域名需实名认证后才能解析。设置域名解析 打开你的域名的控制面板，找到设置DNS之类的，添加一条CNAME记录，解析到你的Github Pages的域名，也就是 <strong>your username.github.io</strong> ，其中的 <strong>your username</strong> 就是你的Github用户名。设置完成后打开你的Hexo网站目录下的source目录，新建一个名为CNAME的文件，文件名没有任何后缀，在CNAME文件中输入你的域名，注意！<strong>域名前面没有www、也没有http和https</strong> ，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">changbin.me</span><br></pre></td></tr></table></figure><p>输入完成后保存，进入命令行，切换到你的Hexo网站目录，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>重新生成网页文件，然后接着输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>把网站同步到Github，这时候在输入你的域名就可以访问你的Github Pages博客了，如果还不能访问的话可能是域名解析还没有生效，等一段时间在访问。</p><h2 id="设置分类和标签"><a href="#设置分类和标签" class="headerlink" title="设置分类和标签"></a>设置分类和标签</h2><p>Hexo默认是没有分类的，这样的话文章多了以后就会比较乱，读者也不方便寻找相关类型的文章，所以还需要手动开启分类功能。打开命令行，切换到Hexo网站目录，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page categories</span><br></pre></td></tr></table></figure><p>新建一个分类页，如果成功会提示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Created: ~\hexo\source\categories\index.md</span><br></pre></td></tr></table></figure><p>根据Hexo文件夹名称的不同，显示的内容也会有些不一样，打开Hexo网站目录下的source目录下的categories目录下的index.md文件，把内容改为如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">文章分类</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="bullet">-02</span><span class="bullet">-27</span> <span class="number">19</span><span class="string">:18:38</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">"categories"</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>默认的title是英文的，可以改为中文，date可以不用改，加入一个 <strong>type: “categories”</strong> ，修改完成后保存。打开你的文章，给没有分类的文章加入分类，如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">文章标题</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="bullet">-02</span><span class="bullet">-27</span> <span class="number">00</span><span class="string">:28:43</span></span><br><span class="line"><span class="attr">categories:</span> </span><br><span class="line">    <span class="string">"实用教程"</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>其中的 <strong>categories</strong> 下面的 <strong>实用教程</strong> 就是类型，一篇文章只能属于一个类型，以后写文章的时候也可以加入分类。修改完成后输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>重新生成网页，如果要在本地预览的话输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>进入 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 就可以看到分类了。</p><p><img src="https://wsmcb.github.io/img/hexocategories.png" alt="hexo分类截图"></p><p>标签相当于是文章的一些关键词，他能让读者更准确的找到所需要的文章，一篇文章可以有多个关键词，例如 PHP实现图片验证码 就可以有 PHP、验证码 两个标签，hexo默认也是没有开启标签，开启的方法是打开命令行，切换到hexo的网站目录，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page tags</span><br></pre></td></tr></table></figure><p>如果成功的话会提示一个文件路径，按照提示打开你的hexo网站目录下的source目录下的tags目录下的index文件，把文件修改为如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">标签</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="bullet">-02</span><span class="bullet">-27</span> <span class="number">19</span><span class="string">:48:08</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">"tags"</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>date可以不用改，完成后保存，打开你要添加标签的文章，输入标签，如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">PHP实现图片验证码</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="bullet">-02</span><span class="bullet">-27</span> <span class="number">00</span><span class="string">:28:43</span></span><br><span class="line"><span class="attr">categories:</span> </span><br><span class="line">    <span class="string">"PHP"</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">PHP</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">验证码</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p>其中 <strong>tags</strong> 下面的 <strong>PHP</strong> 和 <strong>验证码</strong> 就是标签，以后写文章也可以设置标签，保存后重新生成网页，然后就可以在文章的下方或侧边看到标签了。</p><p><img src="https://wsmcb.github.io/img/hexotags.png" alt="Hexo标签截图"></p><h2 id="首页显示文章摘要"><a href="#首页显示文章摘要" class="headerlink" title="首页显示文章摘要"></a>首页显示文章摘要</h2><p>Hexo默认首页是显示全文的，因为显示的文章过长，不利于浏览，所以需要设置文章摘要，Hexo有的主题自带有摘要功能，但有的主题就没有。Hexo本身是有摘要功能的，但需要在写文章的时候手动设置，设置的方法如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Hello Hexo</span><br><span class="line">date: 2019-02-27 16:40:17</span><br><span class="line">tags:</span><br><span class="line">---</span><br><span class="line">这里是摘要</span><br><span class="line"><span class="comment">&lt;!-- more --&gt;</span></span><br><span class="line">这里是正文</span><br></pre></td></tr></table></figure><p>主要就是加入一个类似于HTML的注释，把摘要和正文用 <code>&lt;!-- more --&gt;</code> 隔开，这样在首页 设置过的文章只会显示摘要内容，需要点击 阅读全文 或点击标题才能查看全文。</p><h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><p>Hexo和Wordpress一样也能装插件，下面推荐几个插件：</p><h3 id="网站地图生成插件"><a href="#网站地图生成插件" class="headerlink" title="网站地图生成插件"></a>网站地图生成插件</h3><p>网站地图就是一个记录了网站的各种页面信息以及页面之间的关系的文件，主要是为了方便搜索引擎抓取网页，要安装网站地图生成插件可以打开命令行，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap</span><br></pre></td></tr></table></figure><p>安装完成后只需要输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>插件就能自动生成网站地图，网站地图在Hexo网站目录下的public目录，使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>同步网站的时候也会把网站地图上传到Github的网站根目录。</p><h3 id="网站资源压缩"><a href="#网站资源压缩" class="headerlink" title="网站资源压缩"></a>网站资源压缩</h3><p>主要功能就是压缩生成的网页资源，HTML、CSS、JS 等…… 可以减少对存储空间的占用，同时也能加快网页的加载速度，尤其是对于国内访问来说。安装方法 在命令行输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-all-minifier</span><br></pre></td></tr></table></figure><p>如果要查看更多插件可以访问： <a href="https://hexo.io/plugins/" target="_blank" rel="noopener">https://hexo.io/plugins/</a> 。</p><h2 id="关于图片"><a href="#关于图片" class="headerlink" title="关于图片"></a>关于图片</h2><p>如果图片不多的话可以把图片放到Hexo目录下的public目录下的img目录，写文章的时候图片地址直接写 <strong>域名/img/图片名称</strong> ,例如我的博客域名是 <a href="http://www.changbin.me" target="_blank" rel="noopener">http://www.changbin.me</a> ，我把一张名为1.jpg的图片放到Hexo目录下的public目录下的img目录，图片地址就是： <strong><a href="https://wsmcb.github.io/img/1.jpg" target="_blank" rel="noopener">https://wsmcb.github.io/img/1.jpg</a></strong> ，不过要先把网页同步到Github才能访问图片，虽然Hexo可以直接用相对路径引用图片，但是语法很乱，不利于移植到其他地方，还有在public目录下存储图片 在清理缓存和静态文件的时候记得备份图片。</p><p>如果图片比较多的话可以考虑使用图床，目前免费的图床有： <a href="https://sm.ms/" target="_blank" rel="noopener">SM.MS</a> ，只需要上传图片就能自动生成图片url，只需要把生成的url粘贴到Markdown或者img图片标签中就能直接使用，但是我个人使用的移动网络图片加载比较慢，也不知道其他网络的情况，而且这一类的图床没有像Github一样的大公司背景，说不定哪一天就不能用了。还有一种方式就是在注册一个Github账户，在开一个Github Pages来存储图片，但是听说空间只有300M。如果条件允许的话也可以自己买云服务器来搭建图床，现在国外的服务器也比较便宜，而且基本上都是1G的带宽。</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Github Pages + Hexo搭建个人静态博客（上）</title>
      <link href="/2019/02/27/%E4%BD%BF%E7%94%A8Github-Pages-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%8A%EF%BC%89/"/>
      <url>/2019/02/27/%E4%BD%BF%E7%94%A8Github-Pages-Hexo%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%8A%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>GitHub Pages是GitHub提供的一个网页寄存服务，于2008年推出。可以用于存放静态网页，包括博客、项目文档甚至整本书。Jekyll软件可以用于将文档转换成静态网页，该软件提供了将网页上传到GitHub Pages的功能。一般GitHub Pages的网站使用github.io的子域名，但是用户也可以使用第三方域名。<br><a id="more"></a><br>简单的说就是可以免费托管静态网站，而且还可以绑定域名，所以可以直接把类似于Hexo这样的静态博客托管到Github pages，不需要购买云服务器，每年只需要支付一个域名的价格，如果对域名没有要求的话直接就是免费的。但静态博客也有一个问题就是没有数据库，所以不能使用评论功能。</p><h2 id="建立环境"><a href="#建立环境" class="headerlink" title="建立环境"></a>建立环境</h2><p>要使用Github pages首先需要注册一个Github账户，<a href="https://github.com/" target="_blank" rel="noopener">点击进入Github</a> ，注册方法和大多数网站都差不多，按照提示填写资料即可。注册完成后登录Github，建立一个存储库，存储库的名称设置为 <strong>username.github.io</strong>，其中 <strong>username</strong> 就是你的Github用户名，创建完成后进入刚创建的存储库，创建一个index.html，随便输入一些内容，然后在浏览器地址栏输入 <strong><a href="https://username.github.io/" target="_blank" rel="noopener">https://username.github.io/</a></strong> ，其中的username就是你的用户名，如果能看到index.html中的内容说明环境创建成功，这时候就可以删除之前创建的index.html自己上传网页了。</p><h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><p>有了网站运行环境后就可以上传网页了，如果你愿意的话可以完全自己写HTML网页，但是从长远考虑为了方便还是需要一个静态博客的生成工具，这里使用的是Hexo。</p><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p><p>Hexo是用Node.js开发的，所以在安装Hexo之前还需要先安装Node.js，<a href="https://nodejs.org/zh-cn/download/" target="_blank" rel="noopener">点击此处进入官网下载Node.js</a> ，下载后安装Node.js，因为Hexo的一些文件在Github上，在生成网页的时候需要到Github上克隆文件，所以还需要安装 <strong>Git</strong> ，<a href="https://git-scm.com/" target="_blank" rel="noopener">点击此处进入Git官网下载Git</a> ，下载完成后安装，安装方法和一般的安装软件方法差不多，确认电脑上安装了Node.js和Git后就可以安装Hexo了。</p><p>打开cmd或Node.js command prompt，输入 <strong>npm install -g hexo-cli</strong> 安装Hexo，如果有代理的话建议话代理，如果没有代理的话需要很长时间才能安装完成，当看到如下提示时说明安装完成，</p><p><img src="http://www.changbin.me/img/installhexo.png" alt="Hexo安装完成的截图"></p><p>安装完成后输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init folder</span><br></pre></td></tr></table></figure><p>建立网站，其中 <strong>folder</strong> 是文件夹名，例如我的命令行的位置在：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;</span><br></pre></td></tr></table></figure><p>当我输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init hexo</span><br></pre></td></tr></table></figure><p>Hexo就会在 <strong>C:\Users\Administrator</strong> 目录下建立一个 <strong>hexo</strong>文件夹，并且会把网站文件写入到 <strong>C:\Users\Administrator\hexo</strong> ，建立完成后把命令行的位置切换到 <strong>hexo文件夹</strong> ，以后执行与Hexo相关的命令都需要在Hexo文件夹下，接着输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>生成静态文件，第一次输入 <strong>hexo g</strong> 的时候Hexo会自动生成一篇Hello World的文章，接着输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>启动hexo服务，如果看到命令行上输出：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INFO  Start processing</span><br><span class="line">INFO  Hexo is running at http://localhost:<span class="number">4000</span> . Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure><p>hexo服务启动成功，在浏览器地址栏输入 <strong><a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a></strong> 就可以看到hexo生成的网页了。</p><p><img src="https://wsmcb.github.io/img/hexo1.png" alt="Hexo网站截图"></p><h2 id="写文章"><a href="#写文章" class="headerlink" title="写文章"></a>写文章</h2><p>新建文章 在命令行输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">"文章标题"</span><span class="string">"</span></span><br></pre></td></tr></table></figure><p>在hexo目录下的source目录下的_posts目录下会生成一个 <strong>文章标题.md</strong> 的Markdown文件，只需要打开这个文件，就可以直接使用Markdown来写文章了。关于Markdown的使用可以看 <a href="http://www.changbin.me/index.php/2019/02/26/markdown%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" target="_blank" rel="noopener">Markdown简单使用教程</a>，这里在推荐一下 <a href="https://typora.io/" target="_blank" rel="noopener">Typora</a>，这是一个免费且功能强大的Markdown编辑器，支持所见即所得，哪怕你不会Markdown也能用它生成Markdown。写完以后直接保存，然后在命令行输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>生成静态网页，然后再次输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>启动Hexo服务，然后用浏览器访问 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ，就可以在本地预览刚才写的文章了。</p><p><img src="https://wsmcb.github.io/img/hexo2.png" alt="Hexo截图"></p><h2 id="部署到Github"><a href="#部署到Github" class="headerlink" title="部署到Github"></a>部署到Github</h2><p>在第一次部署之前还需要安装一个名为 <a href="https://github.com/hexojs/hexo-deployer-git" target="_blank" rel="noopener">hexo-deployer-git</a> 的插件，安装插件在命令行输入：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>安装完成后打开Hexo根目录下的 <strong>_config.yml</strong> 文件，找到：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span></span><br></pre></td></tr></table></figure><p>在 <strong>type</strong> 后面加入git，在type下面在建立一个 <strong>repo</strong> 属性，在 <strong>repo</strong> 后面输入你在Github建立的 <strong>username.github.io</strong> 的仓库地址，如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">git</span></span><br><span class="line"><span class="attr">  repo:</span> <span class="attr">https://github.com/username/username.github.io</span></span><br></pre></td></tr></table></figure><p>其中 <strong>username</strong> 部分就是你的Github用户名，修改完成后保存，打开命令行，输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>如果是第一次部署的话会要求输入Github的用户名和密码，按照提示输入，然后确定。</p><p><img src="https://wsmcb.github.io/img/githublogin.png" alt="要求输入Github用户名和密码的截图"></p><p>等待一段时间，完成后进入你的Github的user.github.io的仓库就可以看到网页文件了，这时候用浏览器访问 <strong>user.github.io</strong> 就能看到Hexo博客了。</p><h2 id="修改和删除文章"><a href="#修改和删除文章" class="headerlink" title="修改和删除文章"></a>修改和删除文章</h2><p>如果需要修改已发布的文章可以在本地的Hexo目录下source/_posts目录下找到文章，直接用Markdown编辑器打开编辑，编辑完成后保存，打开命令行 输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>生成网页，如果要在本地预览一下的话可以输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>用浏览器访问 <a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> ，确认无误后在输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>把修改同步到Github。</p><p>删除文章也是一样的 在本地Hexo目录下的source/_posts目录下找到文章，直接删除，然后在命令行输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>生成网页，在输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>把文章同步到Github，这时候在访问 user.github.io 就看不到文章了。</p><h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><p>在成功部署博客后如果对默认的主题不满意的话可以更改主题，因为Hexo是静态博客、不像wordpress直接可以在后台下载主题，下载Hexo的主题可以访问 <a href="https://hexo.io/themes/" target="_blank" rel="noopener">Hexo官方的主题库</a> 。</p><p><img src="https://wsmcb.github.io/img/hexo3.png" alt="Hexo官方主题库截图"></p><p>点击图片可以直接预览主题，点击主题名称会直接进入Github，如果主题作者有详细说明的话就按照说明来做。这里以安装 <a href="https://github.com/wuchong/jacman" target="_blank" rel="noopener">Jacman主题</a> 为例，打开命令行，在命令行中切换到hexo目录，输入命令克隆主题：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/wuchong/jacman.git themes/jacman</span><br></pre></td></tr></table></figure><p>克隆完成后打开Hexo目录下的 <strong>_config.yml</strong> ，把 <strong>theme</strong> 的属性设置为 <strong>jacman</strong> ，如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">jacman</span></span><br></pre></td></tr></table></figure><p>修改完成后保存，启动Hexo服务预览一下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>用浏览器访问： <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ，就可以看到修改后的主题了，更多的主题配置可以看作者的说明，如果要把修改后的Hexo同步到Github还是使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>注意！<strong>修改主题 如果对主题不了解的话一切要按作者的说明来做</strong> 。</p><h2 id="一些必要的配置"><a href="#一些必要的配置" class="headerlink" title="一些必要的配置"></a>一些必要的配置</h2><p>下面是一些必要的配置，打开Hexo目录下的 <strong>_config.yml</strong> ，把 <strong>title</strong> 也就是网站标题，改为你需要的博客名称，默认是Hexo，在把 <strong>subtitle</strong> 也就是网站副标题，改为你需要的副标题，默认为空，如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">冰是睡着的水的博客</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">我的编程笔记和一些计算机的实用教程</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">这是我的个人博客，用来记录我的编程笔记，有时候也会写一些计算机的实用教程</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">冰是睡着的水</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span></span><br></pre></td></tr></table></figure><p>下面是一些配置说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>title</td><td>网站标题</td></tr><tr><td>subtitle</td><td>网站副标题</td></tr><tr><td>description</td><td>网站描述，主要是给搜索引擎看的，不会直接显示在网站上</td></tr><tr><td>author</td><td>您的名字，会显示在主题的文章作者</td></tr><tr><td>language</td><td>网站使用的语言</td></tr><tr><td>timezone</td><td>网站时区。Hexo 默认使用您电脑的时区</td></tr></tbody></table><p>修改主题底部的Powered by信息，例如Hexo默认的主题底部就会显示 Powered by <a href="http://hexo.io/" target="_blank" rel="noopener">Hexo</a> ，如果你不在乎的话也可以不用管，但如果要更改的话可以打开Hexo目录下的themes目录，找到你要修改的主题目录，进入主题目录下的 <strong>landscape\layout_partial</strong> 目录，打开 <strong>footer.ejs</strong> ，</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"footer-info"</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span></span><br><span class="line">    &amp;copy; <span class="tag">&lt;<span class="name">%=</span> <span class="attr">date</span>(<span class="attr">new</span> <span class="attr">Date</span>(), '<span class="attr">YYYY</span>') %&gt;</span> <span class="tag">&lt;<span class="name">%=</span> <span class="attr">config.author</span> || <span class="attr">config.title</span> %&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">__</span>('<span class="attr">powered_by</span>') %&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://hexo.io/"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Hexo<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以把 <strong>powered_by</strong> 改为你想显示的文字，然后把后面的Hexo链接改为你想显示的链接，或者你也可以直接删除，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"footer-info"</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span></span><br><span class="line">    &amp;copy; <span class="tag">&lt;<span class="name">%=</span> <span class="attr">date</span>(<span class="attr">new</span> <span class="attr">Date</span>(), '<span class="attr">YYYY</span>') %&gt;</span> <span class="tag">&lt;<span class="name">%=</span> <span class="attr">config.author</span> || <span class="attr">config.title</span> %&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">__</span>('我的邮箱') %&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript;;"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>xxx@gmail.com<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="常用命令说明"><a href="#常用命令说明" class="headerlink" title="常用命令说明"></a>常用命令说明</h2><p>安装Hexo，在电脑上有Node.js和Git的情况下就可以使用如下命令安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>新建网站，Hexo会在命令行的当前目录下建立网站：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init folder</span><br></pre></td></tr></table></figure><p>上面的 <strong>folder</strong> 就是网站目录的名称。</p><p>新建文章：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new "title"</span><br></pre></td></tr></table></figure><p>上面的 <strong>title</strong> 就是文章标题，在hexo目录下的source目录下的_posts目录下可以找到建立的文章。</p><p>生成静态网页：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo generate</span><br></pre></td></tr></table></figure><p>也可以简写为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p>启动Hexo服务器，用于本地预览：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo server</span><br></pre></td></tr></table></figure><p>可以简写为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>启动后一般情况下可以用： <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> 访问。</p><p>部署网站，需提前配置好类型和地址：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><p>可以简写为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>清除缓存文件和静态文件，在更改主题的时候如果发现更改无效可以使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br></pre></td></tr></table></figure><p>查看Hexo版本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo version</span><br></pre></td></tr></table></figure><p>以上就是Hexo基本的搭建和使用，更多的设置和配置我会在写一篇。</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown简单使用教程</title>
      <link href="/2019/02/26/Markdown%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2019/02/26/Markdown%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>Markdown是一种轻量级标记语言，创始人为约翰·格鲁伯（英语：John Gruber）。它允许人们“使用易读易写的纯文本格式编写文档，然后转换成有效的XHTML（或者HTML）文档”。这种语言吸收了很多在电子邮件中已有的纯文本标记的特性。<br><a id="more"></a><br>由于Markdown的轻量化、易读易写特性，并且对于图片，图表、数学式都有支持，当前许多网站都广泛使用 Markdown 来撰写帮助文档或是用于论坛上发表消息。例如：GitHub、reddit、Diaspora、Stack Exchange、OpenStreetMap 、SourceForge、简书 等。甚至Markdown能被使用来撰写电子书。</p><p>因为正在学习Markdown，所以准备写篇文章来练练手，这篇文章就是用Markdown写的，Markdown其实很简单，比HTML简单多了，只需要花几分钟时间阅读一下文档，在写几篇文章练练手，基本上就会使用了。</p><p>关于编辑器：我现在使用的是Visual Studio Code，配合Markdown Preview Enhanced插件可以实现实时预览，除了Visual Studio Code外其他也有很多好用的编辑器，但因为我还要写其他语言的代码，所以直接用VsCode了。</p><p><img src="https://wsmcb.github.io/img/vscodemarkdown.png" alt="VsCode截图"></p><p>这里也推荐一个Markdown编辑器 <a href="https://typora.io/" target="_blank" rel="noopener">Typora</a>，这是一款很强大的Markdown编辑器，拥有所见即所得功能，哪怕你不会Markdown也能无障碍的使用，软件不仅有颜值，而且还是免费的。</p><p><img src="https://wsmcb.github.io/img/Typora.png" alt="Typora截图"></p><h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h2><p>下面是6种标题的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 一级标题，类似于HTML的h1</span></span><br><span class="line"><span class="section">## 二级标题，类似于HTML的h2</span></span><br><span class="line"><span class="section">### 一级标题，类似于HTML的h3</span></span><br><span class="line"><span class="section">#### 四级标题，类似于HTML的h4</span></span><br><span class="line"><span class="section">##### 五级标题，类似于HTML的h5</span></span><br><span class="line"><span class="section">###### 六级标题，类似于HTML的h6</span></span><br></pre></td></tr></table></figure><p></p><p>下面是效果：</p><h1 id="一级标题，类似于HTML的h1"><a href="#一级标题，类似于HTML的h1" class="headerlink" title="一级标题，类似于HTML的h1"></a>一级标题，类似于HTML的h1</h1><h2 id="二级标题，类似于HTML的h2"><a href="#二级标题，类似于HTML的h2" class="headerlink" title="二级标题，类似于HTML的h2"></a>二级标题，类似于HTML的h2</h2><h3 id="一级标题，类似于HTML的h3"><a href="#一级标题，类似于HTML的h3" class="headerlink" title="一级标题，类似于HTML的h3"></a>一级标题，类似于HTML的h3</h3><h4 id="四级标题，类似于HTML的h4"><a href="#四级标题，类似于HTML的h4" class="headerlink" title="四级标题，类似于HTML的h4"></a>四级标题，类似于HTML的h4</h4><h5 id="五级标题，类似于HTML的h5"><a href="#五级标题，类似于HTML的h5" class="headerlink" title="五级标题，类似于HTML的h5"></a>五级标题，类似于HTML的h5</h5><h6 id="六级标题，类似于HTML的h6"><a href="#六级标题，类似于HTML的h6" class="headerlink" title="六级标题，类似于HTML的h6"></a>六级标题，类似于HTML的h6</h6><p>注意！#和内容之间有一个<strong>空格</strong>。</p><h2 id="分段"><a href="#分段" class="headerlink" title="分段"></a>分段</h2><p>Markdown的分段很简单，只需要用空行分隔，如果只是换行可以在行末尾插入两个空格。</p><h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><p>下面是无序列表的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">* </span>百度</span><br><span class="line"><span class="bullet">* </span>腾讯</span><br><span class="line"><span class="bullet">* </span>阿里巴巴</span><br></pre></td></tr></table></figure><p></p><p>也可以这样写：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">+ </span>微软</span><br><span class="line"><span class="bullet">+ </span>谷歌</span><br><span class="line"><span class="bullet">+ </span>苹果</span><br></pre></td></tr></table></figure><p></p><p>也可以这样写：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">- </span>中国工商银行</span><br><span class="line"><span class="bullet">- </span>中国农业银行</span><br><span class="line"><span class="bullet">- </span>中国建设银行</span><br></pre></td></tr></table></figure><p></p><p>无序列表有3种写法，无论是哪一种写法最终的效果都是一样的，下面是无序列表的效果：</p><ul><li>百度</li><li>腾讯</li><li>阿里巴巴</li></ul><p>下面是有序列表的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>兰博基尼</span><br><span class="line"><span class="bullet">2. </span>法拉利</span><br><span class="line"><span class="bullet">3. </span>保时捷</span><br></pre></td></tr></table></figure><p></p><p>注意 <strong>.和内容之间有空格</strong>，下面是有序列表的效果：</p><ol><li>兰博基尼</li><li>法拉利</li><li>保时捷</li></ol><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><p>下面是链接的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">百度</span>](<span class="link">https://www.baidu.com</span>)</span><br></pre></td></tr></table></figure><p></p><p>在方括号内写链接名称，在普通括号内写链接地址，下面是链接的效果：</p><p><a href="https://www.baidu.com" target="_blank" rel="noopener">百度</a></p><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><p>如果要在Markdown中插入图片需要先把图片上传到Web服务器或能直接使用公开地址访问的网络相册。<br>下面是插入图片的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">百度Logo</span>](<span class="link">https://www.baidu.com/img/bd_logo1.png?where=super</span>)</span><br></pre></td></tr></table></figure><p></p><p>以感叹号开头，<strong>注意！是英文模式的半角感叹号</strong>，在方括号内写图片描述，在正常情况下图片描述不会显示，只有在图片无法正常加载的情况下才会显示图片描述，在普通括号内写图片地址。<br>下面是图片效果：</p><p><img src="https://www.baidu.com/img/bd_logo1.png?where=super" alt="百度Logo"></p><h2 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h2><p>下面是分割线的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">***</span></span><br></pre></td></tr></table></figure><p></p><p>或者也可以这样写：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">---</span><br></pre></td></tr></table></figure><p></p><p>两种写法的效果是一样的，下面是分割线的效果：</p><hr><h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p>下面是引用的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; 道路千万条，安全第一条。行车不规范，亲人两行泪。</span></span><br></pre></td></tr></table></figure><p></p><p>主要就是在段落开头加入一个 <strong>&gt;</strong>，下面是引用的效果：</p><blockquote><p>道路千万条，安全第一条。行车不规范，亲人两行泪。</p></blockquote><h2 id="粗体和斜体"><a href="#粗体和斜体" class="headerlink" title="粗体和斜体"></a>粗体和斜体</h2><p>下面是粗体的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">**粗体**</span></span><br></pre></td></tr></table></figure><p></p><p>也可以这样写：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">__粗体__</span></span><br></pre></td></tr></table></figure><p></p><p>两种写法的效果都是一样的，下面是粗体的效果：</p><p><strong>粗体</strong></p><p>斜体的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*斜体*</span></span><br></pre></td></tr></table></figure><p></p><p>或者也可以这样写：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">_斜体_</span></span><br></pre></td></tr></table></figure><p></p><p>两种写法的效果也是一样的，下面是斜体的效果：</p><p><em>斜体</em></p><h2 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h2><p>感觉Markdown最不人性化的地方就是表格了，下面是表格的写法：<br></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> Computer | Operating system | aircraft</span><br><span class="line">--------- | ---------------- | ----------</span><br><span class="line"> Thinkpad | Windows          | Airbus A320</span><br><span class="line"> Apple    | Linux            | Boeing 737</span><br><span class="line"> HP       | Mac OS           | C919</span><br></pre></td></tr></table></figure><p></p><p>表头和主体之间用 <strong>-</strong> 分隔，列之间用 <strong>|</strong> 分隔，虽然看上去很直观，但是写起来也很麻烦，而且还不能合并单元格，感觉表格还不如HTML方便。<br>下面是表格效果：</p><table><thead><tr><th>Computer</th><th>Operating system</th><th>aircraft</th></tr></thead><tbody><tr><td>Thinkpad</td><td>Windows</td><td>Airbus A320</td></tr><tr><td>Apple</td><td>Linux</td><td>Boeing 737</td></tr><tr><td>HP</td><td>Mac OS</td><td>C919</td></tr></tbody></table><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>代码使用 <strong>3个反引号</strong>包裹，下面是插入一段HTML的写法：</p><p><img src="https://wsmcb.github.io/img/markdownhtml.png" alt="Markdown插入HTML"></p><p>在反引号的后面可以加入语言名称，方便一些解析器解析，下面是HTML代码效果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"表单"</span> <span class="attr">name</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意！不同的解析器和网站呈现出的效果也会不一样，下面在插入一段PHP代码：</p><p><img src="https://wsmcb.github.io/img/markdownphp.png" alt="Markdown插入PHP代码"></p><p>下面是效果：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hello Markdown"</span>;</span><br></pre></td></tr></table></figure><h2 id="转意符号"><a href="#转意符号" class="headerlink" title="转意符号"></a>转意符号</h2><p>在Markdown中如果要输入一些和Markdown标记符相关的符号就需要用到转意符号，Markdown的转意符是 <strong>\</strong> ，如果你想插入# 1，在不使用转意符的情况下会被识别未标题，如果在# 1的前面插入 \ 就不会被识别为标题。</p><p>下面是转意符的写法：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\# 1  </span><br><span class="line">\[这不是链接]（http://www.changbin.me）  </span><br><span class="line">\<span class="strong">__这里的文字不会加粗__</span></span><br></pre></td></tr></table></figure><p>下面是效果：</p><p># 1<br>[这不是链接]（<a href="http://www.changbin.me）" target="_blank" rel="noopener">http://www.changbin.me）</a><br>__这里的文字不会加粗__</p><p>以上就是常用的Markdown语法，一些流程图之类的语法很多解析器都不能识别，所以这里就没有写。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux压缩和解压7z</title>
      <link href="/2019/02/24/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8B7z/"/>
      <url>/2019/02/24/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8B7z/</url>
      
        <content type="html"><![CDATA[<p>在上一篇教程 <a href="http://www.changbin.me/index.php/2019/02/23/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e8%a7%a3%e5%8e%8brar/" target="_blank" rel="noopener">Linux压缩和解压rar</a> 中写了rar的压缩和解压，这里继续来写7z的压缩和解压。7z是现在主流的一种压缩格式，他拥有极高的压缩比，我做过一个测试，用rar和7z压缩同一个文件，都选择最高质量，最终经过7z压缩的文件体积确实要比rar小一些，而且7z是开源免费的，现在很多压缩工具也都能解压7z。</p><a id="more"></a><p>我用来演示的Linux版本是CentOS7，因为CentOS的yum没有p7zip，所以只能手动下载rpm安装。</p><p>下载p7zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.mirrorservice.org/sites/dl.fedoraproject.org/pub/epel/7/x86_64/Packages/p/p7zip-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>下载p7zip-plugins：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.mirrorservice.org/sites/dl.fedoraproject.org/pub/epel/7/x86_64/Packages/p/p7zip-plugins-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>如果要下载其他版本的p7zip rpm可以上 <a href="https://rpmfind.net/linux/rpm2html/search.php?query=p7zip" target="_blank" rel="noopener">https://rpmfind.net/linux/rpm2html/search.php?query=p7zip</a> ，p7zip-plugins rpm 可以上 <a href="https://rpmfind.net/linux/rpm2html/search.php?query=p7zip-plugins" target="_blank" rel="noopener">https://rpmfind.net/linux/rpm2html/search.php?query=p7zip-plugins</a>。</p><p>安装p7zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh p7zip-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>安装p7zip-plugins：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh p7zip-plugins-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>如果要更详细的了解rpm包管理可以看 <a href="http://www.changbin.me/index.php/2019/01/10/linux-rpm%e5%8c%85%e7%ae%a1%e7%90%86/" target="_blank" rel="noopener">Linux rpm包管理</a>，安装完成后输入7z，如果出现帮助信息说明安装成功。</p><p>如果是Ubuntu这一类系统的话，直接输入下面的两条命令自动下载安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install p7zip</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install p7zip-full</span><br></pre></td></tr></table></figure><p>关于使用方法 CentOS和Ubuntu都是一样的。</p><h2 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h2><p>压缩文件： <strong>7z a 压缩包名 要压缩的文件名</strong> ,下面把1.php压缩为1.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z a 1.7z 1.php</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive:</span><br><span class="line">1 file, 35 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Creating archive: 1.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Files read from disk: 1</span><br><span class="line">Archive size: 153 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>面把1.php和2.php压缩为file.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z a file.7z 1.php 2.php</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive:</span><br><span class="line">2 files, 224 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Creating archive: file.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 2</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Files read from disk: 2</span><br><span class="line">Archive size: 318 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>下面把dir目录压缩为dir.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z a dir.7z dir</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive:</span><br><span class="line">1 folder, 2 files, 224 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Creating archive: dir.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 3</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Files read from disk: 2</span><br><span class="line">Archive size: 338 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>给压缩包添加文件： <strong>7z u 压缩包名 要添加的文件名</strong> ，下面把2.php添加到1.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z u 1.7z 2.php</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Open archive: 1.7z</span><br><span class="line">--</span><br><span class="line">Path = 1.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 153</span><br><span class="line">Headers Size = 114</span><br><span class="line">Method = LZMA2:12</span><br><span class="line">Solid = -</span><br><span class="line">Blocks = 1</span><br><span class="line"></span><br><span class="line">Scanning the drive:</span><br><span class="line">1 file, 189 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Updating archive: 1.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Files read from disk: 1</span><br><span class="line">Archive size: 336 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>删除压缩包内的文件： <strong>7z d 压缩包名 要删除的文件名</strong> ，下面删除1.7z中的2.php：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z d 1.7z 2.php</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Open archive: 1.7z</span><br><span class="line">--</span><br><span class="line">Path = 1.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 336</span><br><span class="line">Headers Size = 161</span><br><span class="line">Method = LZMA2:12</span><br><span class="line">Solid = -</span><br><span class="line">Blocks = 2</span><br><span class="line"></span><br><span class="line">Updating archive: 1.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 0</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Files read from disk: 0</span><br><span class="line">Archive size: 153 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>加密压缩： <strong>7z a -p 压缩包名 要压缩的文件名</strong> ，执行命令后会提示输入密码，输入密码的时候终端不会显示任何内容，下面把1.php加密压缩为1.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z a -p 1.7z 1.php</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive:</span><br><span class="line">1 file, 35 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Creating archive: 1.7z</span><br><span class="line"></span><br><span class="line">Items to compress: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Enter password (will not be echoed):</span><br><span class="line">Verify password (will not be echoed) :</span><br><span class="line">    </span><br><span class="line">Files read from disk: 1</span><br><span class="line">Archive size: 178 bytes (1 KiB)</span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><h2 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h2><p>把文件解压到当前目录： <strong>7z e 压缩包名</strong> ，下面解压1.7z：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z e 1.7z</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive for archives:</span><br><span class="line">1 file, 153 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Extracting archive: 1.7z</span><br><span class="line">--</span><br><span class="line">Path = 1.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 153</span><br><span class="line">Headers Size = 114</span><br><span class="line">Method = LZMA2:12</span><br><span class="line">Solid = -</span><br><span class="line">Blocks = 1</span><br><span class="line"></span><br><span class="line">Everything is Ok</span><br><span class="line"></span><br><span class="line">Size:       35</span><br><span class="line">Compressed: 153</span><br></pre></td></tr></table></figure><p>查看压缩包内的文件信息： <strong>7z l 压缩包名</strong> ,下面查看1.7z中的文件信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# 7z l 1.7z</span><br><span class="line"></span><br><span class="line">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21</span><br><span class="line">p7zip Version 16.02 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,64 bits,1 CPU Intel(R) Core(TM) i7-6700HQ CPU @ 2.60GHz (506E3),ASM,AES-NI)</span><br><span class="line"></span><br><span class="line">Scanning the drive for archives:</span><br><span class="line">1 file, 240 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Listing archive: 1.7z</span><br><span class="line"></span><br><span class="line">--</span><br><span class="line">Path = 1.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 240</span><br><span class="line">Headers Size = 158</span><br><span class="line">Method = LZMA2:12</span><br><span class="line">Solid = -</span><br><span class="line">Blocks = 2</span><br><span class="line"></span><br><span class="line">   Date      Time    Attr         Size   Compressed  Name</span><br><span class="line">------------------- ----- ------------ ------------  ------------------------</span><br><span class="line">2019-02-24 10:41:29 ....A           35           39  1.php</span><br><span class="line">2019-02-24 12:25:13 ....A           41           43  2.php</span><br><span class="line">------------------- ----- ------------ ------------  ------------------------</span><br><span class="line">2019-02-24 12:25:13                 76           82  2 files</span><br></pre></td></tr></table></figure><p>下面是p7zip常用的一些参数：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>a</td><td>压缩文件</td></tr><tr><td>d</td><td>删除压缩包内的文件</td></tr><tr><td>e</td><td>把文件解压到当前目录</td></tr><tr><td>h</td><td>计算文件的哈希值</td></tr><tr><td>i</td><td>显示有关支持格式的信息</td></tr><tr><td>l</td><td>列出压缩包内的内容</td></tr><tr><td>m</td><td>重命名压缩包内的文件</td></tr><tr><td>t</td><td>测试压缩包的完整性</td></tr><tr><td>u</td><td>添加文件到压缩包</td></tr></tbody></table><p>p7zip除了上面列出的参数外还有很多可选的选项，下面是p7zip的帮助说明：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;Commands&gt;</span><br><span class="line">  a : Add files to archive</span><br><span class="line">  b : Benchmark</span><br><span class="line">  d : Delete files from archive</span><br><span class="line">  e : Extract files from archive (without using directory names)</span><br><span class="line">  h : Calculate hash values for files</span><br><span class="line">  i : Show information about supported formats</span><br><span class="line">  l : List contents of archive</span><br><span class="line">  rn : Rename files in archive</span><br><span class="line">  t : Test integrity of archive</span><br><span class="line">  u : Update files to archive</span><br><span class="line">  x : eXtract files with full paths</span><br><span class="line"></span><br><span class="line">&lt;Switches&gt;</span><br><span class="line">  -- : Stop switches parsing</span><br><span class="line">  -ai[r[-|0]]&#123;@listfile|!wildcard&#125; : Include archives</span><br><span class="line">  -ax[r[-|0]]&#123;@listfile|!wildcard&#125; : eXclude archives</span><br><span class="line">  -ao&#123;a|s|t|u&#125; : set Overwrite mode</span><br><span class="line">  -an : disable archive_name field</span><br><span class="line">  -bb[0-3] : set output log level</span><br><span class="line">  -bd : disable progress indicator</span><br><span class="line">  -bs&#123;o|e|p&#125;&#123;0|1|2&#125; : set output stream for output/error/progress line</span><br><span class="line">  -bt : show execution time statistics</span><br><span class="line">  -i[r[-|0]]&#123;@listfile|!wildcard&#125; : Include filenames</span><br><span class="line">  -m&#123;Parameters&#125; : set compression Method</span><br><span class="line">    -mmt[N] : set number of CPU threads</span><br><span class="line">  -o&#123;Directory&#125; : set Output directory</span><br><span class="line">  -p&#123;Password&#125; : set Password</span><br><span class="line">  -r[-|0] : Recurse subdirectories</span><br><span class="line">  -sa&#123;a|e|s&#125; : set Archive name mode</span><br><span class="line">  -scc&#123;UTF-8|WIN|DOS&#125; : set charset for for console input/output</span><br><span class="line">  -scs&#123;UTF-8|UTF-16LE|UTF-16BE|WIN|DOS|&#123;id&#125;&#125; : set charset for list files</span><br><span class="line">  -scrc[CRC32|CRC64|SHA1|SHA256|*] : set hash function for x, e, h commands</span><br><span class="line">  -sdel : delete files after compression</span><br><span class="line">  -seml[.] : send archive by email</span><br><span class="line">  -sfx[&#123;name&#125;] : Create SFX archive</span><br><span class="line">  -si[&#123;name&#125;] : read data from stdin</span><br><span class="line">  -slp : set Large Pages mode</span><br><span class="line">  -slt : show technical information for l (List) command</span><br><span class="line">  -snh : store hard links as links</span><br><span class="line">  -snl : store symbolic links as links</span><br><span class="line">  -sni : store NT security information</span><br><span class="line">  -sns[-] : store NTFS alternate streams</span><br><span class="line">  -so : write data to stdout</span><br><span class="line">  -spd : disable wildcard matching for file names</span><br><span class="line">  -spe : eliminate duplication of root folder for extract command</span><br><span class="line">  -spf : use fully qualified file paths</span><br><span class="line">  -ssc[-] : set sensitive case mode</span><br><span class="line">  -ssw : compress shared files</span><br><span class="line">  -stl : set archive timestamp from the most recently modified file</span><br><span class="line">  -stm&#123;HexMask&#125; : set CPU thread affinity mask (hexadecimal number)</span><br><span class="line">  -stx&#123;Type&#125; : exclude archive type</span><br><span class="line">  -t&#123;Type&#125; : Set type of archive</span><br><span class="line"><span class="meta">  -u[-][p#</span>][q#][r#][x#][y#][z#][!newArchiveName] : Update options</span><br><span class="line">  -v&#123;Size&#125;[b|k|m|g] : Create volumes</span><br><span class="line">  -w[&#123;path&#125;] : assign Work directory. Empty path means a temporary directory</span><br><span class="line">  -x[r[-|0]]&#123;@listfile|!wildcard&#125; : eXclude filenames</span><br><span class="line">  -y : assume Yes on all queries</span><br></pre></td></tr></table></figure><p>到这里关于Linux的压缩基本上就已经写完了。</p><ul><li><a href="http://www.changbin.me/index.php/2018/12/28/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e6%89%93%e5%8c%85%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">Linux压缩和打包文件</a></li><li><a href="http://www.changbin.me/index.php/2019/02/22/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e8%a7%a3%e5%8e%8bzip/" target="_blank" rel="noopener">Linux压缩和解压zip</a></li><li><a href="http://www.changbin.me/index.php/2019/02/23/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e8%a7%a3%e5%8e%8brar/" target="_blank" rel="noopener">Linux压缩和解压rar</a></li></ul><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux压缩和解压rar</title>
      <link href="/2019/02/23/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8Brar/"/>
      <url>/2019/02/23/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8Brar/</url>
      
        <content type="html"><![CDATA[<p>上一篇教程写了 <a href="http://www.changbin.me/index.php/2019/02/22/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e8%a7%a3%e5%8e%8bzip/" target="_blank" rel="noopener">Linux压缩和解压zip</a> ，因为内容太多，所以把zip和rar分开写，这里就来写rar，rar格式在Windows平台应该是用的最多的压缩格式了，国内的Windows电脑很多都在用WinRAR。</p><a id="more"></a><blockquote><p>RAR是一种专利文件格式，用于数据压缩与归档打包，开发者为尤金·罗谢尔（俄语：Евгений Лазаревич Рошал，拉丁转写：Yevgeny Lazarevich Roshal），RAR的全名是“Roshal ARchive”，即“罗谢尔的归档”之意。首个公开版本RAR 1.3发布于1993年。</p></blockquote><p>我用来演示的系统版本是CentOS7 64位，因为rar是收费软件，且不开源，所以一般操作系统都不会内置rar功能，目前Linux平台的rar分为32位和64位版本，我用的是64位的，所以只能下载64位版，而且CentOS的yum也没有rar，所以只能手动下载安装。</p><p>下载CentOS 64位rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://rpmfind.net/linux/atrpms/f20-x86_64/atrpms/stable/rar-4.2.0-4.fc20.x86_64.rpm</span><br></pre></td></tr></table></figure><p>如果要下载其他版本的rpm可以上 <a href="http://rpmfind.net/linux/rpm2html/search.php?query=rar" target="_blank" rel="noopener">http://rpmfind.net/linux/rpm2html/search.php?query=rar</a> ，选择对应的版本下载，</p><p>安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh rar-4.2.0-4.fc20.x86_64.rpm</span><br></pre></td></tr></table></figure><p>如果要更详细的了解rpm的安装和管理可以看 <a href="http://www.changbin.me/index.php/2019/01/10/linux-rpm%e5%8c%85%e7%ae%a1%e7%90%86/" target="_blank" rel="noopener">Linux rpm包管理</a> ，下面是安装信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rpm -ivh rar-4.2.0-4.fc20.x86_64.rpm</span><br><span class="line">警告：rar-4.2.0-4.fc20.x86_64.rpm: 头V4 DSA/SHA1 Signature, 密钥 ID 66534c2b: NOKEY</span><br><span class="line">准备中...                          ################################# [100%]</span><br><span class="line">正在升级/安装...</span><br><span class="line">   1:rar-4.2.0-4.fc20                 ################################# [100%]</span><br></pre></td></tr></table></figure><p>安装完成后可以输入rar，如果出现rar相关的帮助信息说明安装成功。</p><p>如果是Ubuntu这一类系统的话直接输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install rar</span><br></pre></td></tr></table></figure><p>可以自动下载安装适合的版本。</p><p>无论是CentOS还是Ubuntu的rar使用命令都是一样的。</p><h2 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h2><p>创建rar压缩： <strong>rar a 新文件名 要压缩的文件名</strong> ，注意！这里的a前面<strong>没有-</strong>，下面把home目录下的1.txt压缩位1.rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar a 1.rar 1.txt</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Evaluation copy. Please register.</span><br><span class="line"></span><br><span class="line">Creating archive 1.rar</span><br><span class="line"></span><br><span class="line">Adding    1.txt                                                       OK </span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>因为rar是收费软件，我这里使用的是试用版，所以会提示注册，但是是可以正常压缩的，所以在Linux平台如果有其他选择的话还是不推荐用rar。</p><p>下面把1.txt和rar-4.2.0-4.fc20.x86_64.rpm两个文件压缩为1.rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar a 1.rar 1.txt rar-4.2.0-4.fc20.x86_64.rpm</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Evaluation copy. Please register.</span><br><span class="line"></span><br><span class="line">Creating archive 1.rar</span><br><span class="line"></span><br><span class="line">Adding    1.txt                                                       OK </span><br><span class="line">Adding    rar-4.2.0-4.fc20.x86_64.rpm                                 OK </span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>下面把dir目录压缩为dir.rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar a dir.rar dir</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Evaluation copy. Please register.</span><br><span class="line"></span><br><span class="line">Creating archive dir.rar</span><br><span class="line"></span><br><span class="line">Adding    dir/1.js                                                    OK </span><br><span class="line">Adding    dir/2.js                                                    OK </span><br><span class="line">Adding    dir                                                         OK </span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>给rar包添加文件： <strong>rar u rar包文件名 要添加的文件名</strong> ，下面把2.js添加到1.rar中：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar u 1.rar 2.js</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Evaluation copy. Please register.</span><br><span class="line"></span><br><span class="line">Updating archive 1.rar</span><br><span class="line"></span><br><span class="line">Adding    2.js                                                        OK </span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>加密压缩： <strong>rar a -p 新文件名 要压缩的文件名</strong> ，执行命令后会提示输入密码，注意！输入密码的时候是看不到密码的，也看不到*，下面把1.js加密压缩为1.rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar a -p 1.rar 1.js</span><br><span class="line"></span><br><span class="line">Enter password (will not be echoed): </span><br><span class="line"></span><br><span class="line">Reenter password: </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Evaluation copy. Please register.</span><br><span class="line"></span><br><span class="line">Creating archive 1.rar</span><br><span class="line"></span><br><span class="line">Adding    1.js                                                        OK </span><br><span class="line">Done</span><br></pre></td></tr></table></figure><p>删除rar包内的文件： <strong>rar d rar包文件名 要删除的文件名</strong> ，下面删除1.rar中的1.js文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar d 1.rar 1.js</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Deleting from 1.rar</span><br><span class="line">Deleting 1.js</span><br><span class="line">Done</span><br></pre></td></tr></table></figure><h2 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h2><p>把文件解压到当前目录： <strong>rar e rar包文件名</strong> ，下面解压1.rar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar e 1.rar</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Extracting from 1.rar</span><br><span class="line"></span><br><span class="line">Extracting  2.js                                                      OK </span><br><span class="line">All OK</span><br></pre></td></tr></table></figure><p>查看rar包内的文件信息： <strong>rar l rar包文件名</strong> ，下面查看1.rar中的文件信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar l 1.rar</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line">Archive 1.rar</span><br><span class="line"></span><br><span class="line"> Name             Size   Packed Ratio  Date   Time     Attr      CRC   Meth Ver</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line"> 2.js               58       67 115% 23-02-19 16:59 -rw-r--r-- F74C51F6 m3b 2.9</span><br><span class="line"> 1.js               91       14  15% 23-02-19 17:39 -rw-r--r-- 3C4274E3 m3b 2.9</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">    2              149       81  54%</span><br></pre></td></tr></table></figure><p>把文件解压到指定目录： <strong>rar x rar包文件名 目录名</strong> ，下面解压1.rar到root目录：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# rar x 1.rar /root</span><br><span class="line"></span><br><span class="line">RAR 4.20   Copyright (c) 1993-2012 Alexander Roshal   9 Jun 2012</span><br><span class="line">Trial version             Type RAR -? for help</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Extracting from 1.rar</span><br><span class="line"></span><br><span class="line">Extracting  /root/2.js                                                OK </span><br><span class="line">Extracting  /root/1.js                                                OK </span><br><span class="line">All OK</span><br></pre></td></tr></table></figure><p>下面是rar常用的一些参数：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>a</td><td>压缩文件</td></tr><tr><td>c</td><td>添加注释</td></tr><tr><td>d</td><td>删除压缩包内的文件</td></tr><tr><td>e</td><td>把文件解压到当前目录</td></tr><tr><td>k</td><td>锁定压缩包</td></tr><tr><td>l</td><td>查看压缩包内的文件信息</td></tr><tr><td>r</td><td>修复压缩包</td></tr><tr><td>t</td><td>测试压缩包</td></tr><tr><td>u</td><td>更新压缩包内的文件</td></tr><tr><td>x</td><td>把文件解压到指定目录</td></tr></tbody></table><p>上面表格中只列出了一部分参数，rar还有很多参数，因为rar是付费软件，所以有的功能需要付费才能使用，下面是完整的rar帮助说明：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">&lt;Commands&gt;</span><br><span class="line">  a             Add files to archive</span><br><span class="line">  c             Add archive comment</span><br><span class="line">  cf            Add files comment</span><br><span class="line">  ch            Change archive parameters</span><br><span class="line">  cw            Write archive comment to file</span><br><span class="line">  d             Delete files from archive</span><br><span class="line">  e             Extract files to current directory</span><br><span class="line">  f             Freshen files in archive</span><br><span class="line">  i[par]=&lt;str&gt;  Find string in archives</span><br><span class="line">  k             Lock archive</span><br><span class="line">  l[t,b]        List archive [technical, bare]</span><br><span class="line">  m[f]          Move to archive [files only]</span><br><span class="line">  p             Print file to stdout</span><br><span class="line">  r             Repair archive</span><br><span class="line">  rc            Reconstruct missing volumes</span><br><span class="line">  rn            Rename archived files</span><br><span class="line">  rr[N]         Add data recovery record</span><br><span class="line">  rv[N]         Create recovery volumes</span><br><span class="line">  s[name|-]     Convert archive to or from SFX</span><br><span class="line">  t             Test archive files</span><br><span class="line">  u             Update files in archive</span><br><span class="line">  v[t,b]        Verbosely list archive [technical,bare]</span><br><span class="line">  x             Extract files with full path</span><br><span class="line"></span><br><span class="line">&lt;Switches&gt;</span><br><span class="line">  -             Stop switches scanning</span><br><span class="line">  @[+]          Disable [enable] file lists</span><br><span class="line">  ad            Append archive name to destination path</span><br><span class="line">  ag[format]    Generate archive name using the current date</span><br><span class="line">  ai            Ignore file attributes</span><br><span class="line">  ap&lt;path&gt;      Set path inside archive</span><br><span class="line">  as            Synchronize archive contents</span><br><span class="line">  av            Put authenticity verification (registered versions only)</span><br><span class="line">  av-           Disable authenticity verification check</span><br><span class="line">  c-            Disable comments show</span><br><span class="line">  cfg-          Disable read configuration</span><br><span class="line">  cl            Convert names to lower case</span><br><span class="line">  cu            Convert names to upper case</span><br><span class="line">  df            Delete files after archiving</span><br><span class="line">  dh            Open shared files</span><br><span class="line">  ds            Disable name sort for solid archive</span><br><span class="line">  dw            Wipe files after archiving</span><br><span class="line">  e[+]&lt;attr&gt;    Set file exclude and include attributes</span><br><span class="line">  ed            Do not add empty directories</span><br><span class="line">  en            Do not put 'end of archive' block</span><br><span class="line">  ep            Exclude paths from names</span><br><span class="line">  ep1           Exclude base directory from names</span><br><span class="line">  ep3           Expand paths to full including the drive letter</span><br><span class="line">  f             Freshen files</span><br><span class="line">  hp[password]  Encrypt both file data and headers</span><br><span class="line">  id[c,d,p,q]   Disable messages</span><br><span class="line">  ierr          Send all messages to stderr</span><br><span class="line">  ilog[name]    Log errors to file (registered versions only)</span><br><span class="line">  inul          Disable all messages</span><br><span class="line">  isnd          Enable sound</span><br><span class="line">  k             Lock archive</span><br><span class="line">  kb            Keep broken extracted files</span><br><span class="line">  log[f][=name] Write names to log file</span><br><span class="line">  m&lt;0..5&gt;       Set compression level (0-store...3-default...5-maximal)</span><br><span class="line">  mc&lt;par&gt;       Set advanced compression parameters</span><br><span class="line">  md&lt;size&gt;      Dictionary size in KB (64,128,256,512,1024,2048,4096 or A-G)</span><br><span class="line">  ms[ext;ext]   Specify file types to store</span><br><span class="line">  mt&lt;threads&gt;   Set the number of threads</span><br><span class="line">  n&lt;file&gt;       Include only specified file</span><br><span class="line">  n@            Read file names to include from stdin</span><br><span class="line">  n@&lt;list&gt;      Include files listed in specified list file</span><br><span class="line">  o[+|-]        Set the overwrite mode</span><br><span class="line">  ol            Save symbolic links as the link instead of the file</span><br><span class="line">  or            Rename files automatically</span><br><span class="line">  ow            Save or restore file owner and group</span><br><span class="line">  p[password]   Set password</span><br><span class="line">  p-            Do not query password</span><br><span class="line">  r             Recurse subdirectories</span><br><span class="line">  r-            Disable recursion</span><br><span class="line">  r0            Recurse subdirectories for wildcard names only</span><br><span class="line">  rr[N]         Add data recovery record</span><br><span class="line">  rv[N]         Create recovery volumes</span><br><span class="line">  s[&lt;N&gt;,v[-],e] Create solid archive</span><br><span class="line">  s-            Disable solid archiving</span><br><span class="line">  sc&lt;chr&gt;[obj]  Specify the character set</span><br><span class="line">  sfx[name]     Create SFX archive</span><br><span class="line">  si[name]      Read data from standard input (stdin)</span><br><span class="line">  sl&lt;size&gt;      Process files with size less than specified</span><br><span class="line">  sm&lt;size&gt;      Process files with size more than specified</span><br><span class="line">  t             Test files after archiving</span><br><span class="line">  ta&lt;date&gt;      Process files modified after &lt;date&gt; in YYYYMMDDHHMMSS format</span><br><span class="line">  tb&lt;date&gt;      Process files modified before &lt;date&gt; in YYYYMMDDHHMMSS format</span><br><span class="line">  tk            Keep original archive time</span><br><span class="line">  tl            Set archive time to latest file</span><br><span class="line">  tn&lt;time&gt;      Process files newer than &lt;time&gt;</span><br><span class="line">  to&lt;time&gt;      Process files older than &lt;time&gt;</span><br><span class="line">  ts&lt;m,c,a&gt;[N]  Save or restore file time (modification, creation, access)</span><br><span class="line">  u             Update files</span><br><span class="line">  v             Create volumes with size autodetection or list all volumes</span><br><span class="line">  v&lt;size&gt;[k,b]  Create volumes with size=&lt;size&gt;*1000 [*1024, *1]</span><br><span class="line">  ver[n]        File version control</span><br><span class="line">  vn            Use the old style volume naming scheme</span><br><span class="line">  vp            Pause before each volume</span><br><span class="line">  w&lt;path&gt;       Assign work directory</span><br><span class="line">  x&lt;file&gt;       Exclude specified file</span><br><span class="line">  x@            Read file names to exclude from stdin</span><br><span class="line">  x@&lt;list&gt;      Exclude files listed in specified list file</span><br><span class="line">  y             Assume Yes on all queries</span><br><span class="line">  z[file]       Read archive comment from file</span><br></pre></td></tr></table></figure><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux压缩和解压zip</title>
      <link href="/2019/02/22/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8Bzip/"/>
      <url>/2019/02/22/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8Bzip/</url>
      
        <content type="html"><![CDATA[<p>zip是目前使用最多的压缩文件格式，哪怕是Linux服务器也经常需要和zip文件打交道。之前我写过一篇教程 <a href="http://www.changbin.me/index.php/2018/12/28/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e6%89%93%e5%8c%85%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">Linux压缩和打包文件</a>，只说到了tar、tar.gz、tar.bz2，这里就继续来写zip，本来是要把zip和rar写在一起的，但是因为太长，所以准备分开写。</p><a id="more"></a><blockquote><p>ZIP文件格式是一种数据压缩和文档储存的文件格式，原名Deflate，发明者为菲尔·卡茨，他于1989年1月公布了该格式的资料。ZIP通常使用后缀名“.zip”，它的MIME格式为application/zip。目前，ZIP格式属于几种主流的压缩格式之一，其竞争者包括RAR格式以及开放源码的7z格式。</p></blockquote><p>我这里使用的Linux版本是CentOS7，一般大多数系统都会内置有zip工具，不过一些最小安装的Linux可能没有zip工具，如果压缩时出现 <strong>-bash: zip: 未找到命令</strong> 说明没有内置zip工具，只需要下载zip工具即可。</p><p>下载unzip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install unzip</span><br></pre></td></tr></table></figure><p>下载zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install zip</span><br></pre></td></tr></table></figure><p>如果要更详细的了解yum的使用可以看 <a href="http://www.changbin.me/index.php/2019/01/07/linux-yum%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8%e6%95%99%e7%a8%8b/" target="_blank" rel="noopener">Linux Yum简单使用教程</a> 。</p><p>如果是Ubuntu这一类系统的话使用：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install zip</span><br></pre></td></tr></table></figure><p>在询问是否安装的时候输入 <strong>y</strong> 回车，Ubuntu在安装zip的时候也会自动安装unzip。</p><h2 id="zip压缩"><a href="#zip压缩" class="headerlink" title="zip压缩"></a>zip压缩</h2><p>压缩的命令为： <strong>zip 新 文件名 要压缩的文件名</strong> ，下面把home目录下的1.txt和2.txt压缩为1.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip 1.zip 1.txt 2.txt</span><br><span class="line">  adding: 1.txt (stored 0%)</span><br><span class="line">  adding: 2.txt (deflated 34%)</span><br></pre></td></tr></table></figure><p>查看一下文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# ls</span><br><span class="line">1.txt  1.zip  2.txt</span><br></pre></td></tr></table></figure><p>压缩当前目录下的所有文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip all.zip *</span><br><span class="line">  adding: 1.txt (stored 0%)</span><br><span class="line">  adding: 1.zip (stored 0%)</span><br><span class="line">  adding: 2.txt (deflated 34%)</span><br></pre></td></tr></table></figure><p>把当前目录下的newdir目录和里面所有的文件都压缩到newdir.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip newdir.zip newdir</span><br><span class="line">  adding: newdir/ (stored 0%)</span><br></pre></td></tr></table></figure><p>给zip包添加文件： <strong>zip -g zip包文件名 要添加的文件名</strong> ，下面给1.zip中添加一个3.txt：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -g 1.zip 3.txt</span><br><span class="line">  adding: 3.txt (stored 0%)</span><br></pre></td></tr></table></figure><p>直接打包不压缩： <strong>zip -0 zip包名 要打包的文件名</strong> ，下面把1.txt打包为file.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -0 file.zip 1.txt</span><br><span class="line">  adding: 1.txt (stored 0%)</span><br></pre></td></tr></table></figure><p>高质量压缩： <strong>zip -9 新文件名 要压缩的文件名</strong> ，下面把3个txt文件压缩为file.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -9 file.zip 1.txt 2.txt 3.txt</span><br><span class="line">updating: 1.txt (stored 0%)</span><br><span class="line">  adding: 2.txt (deflated 34%)</span><br><span class="line">  adding: 3.txt (stored 0%)</span><br></pre></td></tr></table></figure><p>对比一下直接打包的文件体积确实小了一点点：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# ls -l</span><br><span class="line">总用量 20</span><br><span class="line">-rw-r--r--. 1 root root  23 2月  22 15:04 1.txt</span><br><span class="line">-rw-r--r--. 1 root root 668 2月  22 16:38 1.zip</span><br><span class="line">-rw-r--r--. 1 root root 145 2月  22 15:07 2.txt</span><br><span class="line">-rw-r--r--. 1 root root  64 2月  22 16:22 3.txt</span><br><span class="line">-rw-r--r--. 1 root root 618 2月  22 16:37 file.zip</span><br></pre></td></tr></table></figure><p>排除文件： <strong>zip -X 新文件名 要排除的文件名</strong> ，下面把除2.txt外的所有文件都压缩到1.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -X 1.zip 2.txt</span><br><span class="line">  adding: 2.txt (deflated 34%)</span><br></pre></td></tr></table></figure><p>加密压缩： <strong>zip -e 新文件名 要压缩的文件名</strong> ，按下回车后会提示输入密码，下面把1.txt加密压缩为1.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -e 1.zip 1.txt</span><br><span class="line">Enter password: </span><br><span class="line">Verify password: </span><br><span class="line">  adding: 1.txt (stored 0%)</span><br></pre></td></tr></table></figure><p>删除zip包中的文件： <strong>zip -d zip包名 要删除的文件名</strong> ，下面删除1.zip中的1.txt文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# zip -d 1.zip 1.txt</span><br><span class="line">deleting: 1.txt</span><br></pre></td></tr></table></figure><p>下面是zip的一些参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-d</td><td>删除zip包中的文件</td></tr><tr><td>-e</td><td>加密压缩</td></tr><tr><td>-F</td><td>修复zip文件</td></tr><tr><td>-g</td><td>向zip包中添加文件</td></tr><tr><td>-h</td><td>显示zip帮助</td></tr><tr><td>-h2</td><td>显示更多的zip帮助</td></tr><tr><td>-j</td><td>只压缩文件，不处理目录，压缩一个目录只会包含文件，不包含目录</td></tr><tr><td>-L</td><td>显示zip许可证</td></tr><tr><td>-m</td><td>压缩完成后删除原文件</td></tr><tr><td>-o</td><td>把zip包的修改时间改为zip包中文件的最新时间</td></tr><tr><td>-p</td><td>加密压缩，明文存储密码，安全性不如 -e</td></tr><tr><td>-q</td><td>压缩文件时不输出任何信息</td></tr><tr><td>-T</td><td>测试zip文件的完整性</td></tr><tr><td>-u</td><td>更新文件</td></tr><tr><td>-X</td><td>排除文件</td></tr><tr><td>-z</td><td>给zip包添加注释信息</td></tr><tr><td>-0 or -1 or -2 or -3 or -4 or -5 or -6 or -7 or -8 or -9</td><td>控制压缩的质量，质量越好压缩速度越慢，-0不压缩，-9质量最好，默认为-6</td></tr></tbody></table><p>上面只是写了一部分参数，更多的参数可以看 <a href="https://linux.die.net/man/1/zip" target="_blank" rel="noopener">https://linux.die.net/man/1/zip</a>和 <a href="http://www.linuxguide.it/command_line/linux-manpage/do.php?file=zip" target="_blank" rel="noopener">http://www.linuxguide.it/command_line/linux-manpage/do.php?file=zip</a> 。</p><h2 id="unzip解压"><a href="#unzip解压" class="headerlink" title="unzip解压"></a>unzip解压</h2><p>解压zip包到当前目录： <strong>unzip zip包文件名</strong> ，下面解压1.zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# unzip 1.zip</span><br><span class="line">Archive:  1.zip</span><br><span class="line"> extracting: 1.txt                   </span><br><span class="line">  inflating: 2.txt                   </span><br><span class="line"> extracting: 3.txt</span><br></pre></td></tr></table></figure><p>把文件解压到其他目录： <strong>unzip -d 目录名 zip包文件名</strong> ，下面把home目录下的1.zip解压到root目录：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# unzip -d /root 1.zip</span><br><span class="line">Archive:  1.zip</span><br><span class="line"> extracting: /root/1.txt             </span><br><span class="line">  inflating: /root/2.txt             </span><br><span class="line"> extracting: /root/3.txt</span><br></pre></td></tr></table></figure><p>查看zip包内有哪些文件： <strong>unzip -l zip包文件名</strong> ，下面查看1.zip内有哪些文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# unzip -l 1.zip</span><br><span class="line">Archive:  1.zip</span><br><span class="line">  Length      Date    Time    Name</span><br><span class="line">---------  ---------- -----   ----</span><br><span class="line">       23  02-22-2019 15:04   1.txt</span><br><span class="line">      145  02-22-2019 15:07   2.txt</span><br><span class="line">       64  02-22-2019 16:22   3.txt</span><br><span class="line">---------                     -------</span><br><span class="line">      232                     3 files</span><br></pre></td></tr></table></figure><p>查看zip包内文件的压缩率： <strong>unzip -v zip包文件名</strong> ，下面查看1.zip内文件的压缩率：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# unzip -v 1.zip</span><br><span class="line">Archive:  1.zip</span><br><span class="line"> Length   Method    Size  Cmpr    Date    Time   CRC-32   Name</span><br><span class="line">--------  ------  ------- ---- ---------- ----- --------  ----</span><br><span class="line">      23  Stored       23   0% 02-22-2019 15:04 d7df0560  1.txt</span><br><span class="line">     145  Defl:N       95  35% 02-22-2019 15:07 ad661f88  2.txt</span><br><span class="line">      64  Stored       64   0% 02-22-2019 16:22 bc70d4fa  3.txt</span><br><span class="line">--------          -------  ---                            -------</span><br><span class="line">     232              182  22%</span><br></pre></td></tr></table></figure><p>查看文件是否有损坏： <strong>unzip -t zip包文件名</strong> ，下面查看1.zip是否有文件损坏：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost home]# unzip -t 1.zip</span><br><span class="line">Archive:  1.zip</span><br><span class="line">    testing: 1.txt                    OK</span><br><span class="line">    testing: 2.txt                    OK</span><br><span class="line">    testing: 3.txt                    OK</span><br><span class="line">No errors detected in compressed data of 1.zip.</span><br></pre></td></tr></table></figure><p>下面是unzip的参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-c</td><td>将解压缩的结果显示到屏幕上，并对字符做适当的转换。</td></tr><tr><td>-f</td><td>更新现有的文件。</td></tr><tr><td>-l</td><td>显示压缩文件内所包含的文件。</td></tr><tr><td>-p</td><td>与-c参数类似，会将解压缩的结果显示到屏幕上，但不会执行任何的转换。</td></tr><tr><td>-t</td><td>检查压缩文件是否正确。</td></tr><tr><td>-u</td><td>与-f参数类似，但是除了更新现有的文件外，也会将压缩文件中的其他文件解压缩到目录中。</td></tr><tr><td>-v</td><td>查看压缩包内文件的详细信息。</td></tr><tr><td>-z</td><td>查看压缩包注释。</td></tr><tr><td>-j</td><td>不处理压缩文件中原有的目录路径。</td></tr><tr><td>-L</td><td>将压缩文件中的全部文件名改为小写。</td></tr><tr><td>-n</td><td>解压缩时不要覆盖原有的文件。</td></tr><tr><td>-o</td><td>不必先询问用户，unzip执行后覆盖原有文件。</td></tr><tr><td>-q</td><td>执行时不显示任何信息。</td></tr><tr><td>-d</td><td>解压到指定目录。</td></tr></tbody></table><p>以上就是Linux zip和unzip的使用教程，一个是压缩，一个是解压，两个缺一不可，无论是CentOS还是Ubuntu命令都是一样的。</p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP发送GET和POST请求</title>
      <link href="/2019/02/19/PHP%E5%8F%91%E9%80%81GET%E5%92%8CPOST%E8%AF%B7%E6%B1%82/"/>
      <url>/2019/02/19/PHP%E5%8F%91%E9%80%81GET%E5%92%8CPOST%E8%AF%B7%E6%B1%82/</url>
      
        <content type="html"><![CDATA[<p>在使用PHP抓取网页或调用一些第三方的API的时候可能会遇到需要发送GET或者POST请求，例如Google的reCAPTCHA验证就需要发送POST请求，百度翻译的API也需要发送GET或POST请求，这里就来简单写一下PHP发送GET和POST。<br><a id="more"></a></p><h2 id="GET请求"><a href="#GET请求" class="headerlink" title="GET请求"></a>GET请求</h2><p>发送GET请求很简单，使用的函数是 <strong>file_get_contents()</strong> ，下面给名为server.php的文件发送get请求：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://localhost/php/test/server.php?data=hello'</span>;  <span class="comment">//  url和参数</span></span><br><span class="line">$result = file_get_contents($url);  <span class="comment">//  发送get请求</span></span><br></pre></td></tr></table></figure><p><strong>file_get_contents()</strong> 函数的功能是把文件读入一个字符串，可以用来读取文件，也可以用来发送GET请求，参数为url或文件名，如果需要发送内容可以在url后面加参数名和参数值，下面演示给server.php文件发送user和password：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://localhost/php/test/server.php?user=123&amp;password=123'</span>;</span><br><span class="line">file_get_contents($url);</span><br></pre></td></tr></table></figure><p>url参数的拼接和jQuery发送get或post请求是一样的，请求成功会返回请求到的字符串，请求失败会返回false。</p><h2 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h2><p>发送post请求会稍微麻烦一些，需要用到 Client URL 库，关于Client URL的介绍可以看 <a href="http://php.net/manual/zh/intro.curl.php" target="_blank" rel="noopener">http://php.net/manual/zh/intro.curl.php</a> ，关于安装/配置可以看 <a href="http://php.net/manual/zh/curl.setup.php" target="_blank" rel="noopener">http://php.net/manual/zh/curl.setup.php</a> ，下面给server.php发送一个简单的POST请求：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$url = <span class="string">'http://localhost/php/test/server.php'</span>;  <span class="comment">//  url</span></span><br><span class="line"></span><br><span class="line">$data = <span class="keyword">array</span>(<span class="string">'data'</span> =&gt; <span class="string">'hello'</span>);  <span class="comment">//  要发送的数据</span></span><br><span class="line"></span><br><span class="line">$ch = curl_init();  <span class="comment">//  初始化Client URL</span></span><br><span class="line"></span><br><span class="line">curl_setopt($ch, CURLOPT_URL, $url);  <span class="comment">//  设置url</span></span><br><span class="line"></span><br><span class="line">curl_setopt($ch, CURLOPT_POST, <span class="keyword">true</span>);  <span class="comment">//  设置请求方式为post</span></span><br><span class="line"></span><br><span class="line">curl_setopt($ch, CURLOPT_POSTFIELDS, $data);  <span class="comment">//  设置要发送的数据</span></span><br><span class="line"></span><br><span class="line">curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="keyword">true</span>);  <span class="comment">//  设置以字符串方式返回</span></span><br><span class="line"></span><br><span class="line">$result = curl_exec($ch);  <span class="comment">//  执行curl绘画</span></span><br><span class="line"></span><br><span class="line">curl_close($ch);  <span class="comment">//  关闭curl会话</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> $result;  <span class="comment">//  输出返回的内容</span></span><br></pre></td></tr></table></figure><p>下面是用到的函数说明：</p><h3 id="curl-init-url"><a href="#curl-init-url" class="headerlink" title="curl_init(url)"></a>curl_init(url)</h3><p>初始化Client URL会话，接收一个string类型的URL，也可以为空，如果成功，返回 cURL 句柄，出错返回 FALSE。</p><h3 id="curl-setopt-ch-option-value"><a href="#curl-setopt-ch-option-value" class="headerlink" title="curl_setopt(ch, option, value)"></a>curl_setopt(ch, option, value)</h3><p>设置curl参数，下面是参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>ch</td><td>初始化Client URL时的句柄</td></tr><tr><td>option</td><td>选项，接收一个预定义常量</td></tr><tr><td>value</td><td>选项值，类型可能是bool or integer or string or array or 资源</td></tr></tbody></table><p>下面是用到的预定义常量的说明：</p><table><thead><tr><th>预定义常量</th><th>说明</th></tr></thead><tbody><tr><td>CURLOPT_URL</td><td>string类型的URL</td></tr><tr><td>CURLOPT_POST</td><td>TRUE 时会发送 POST 请求，类型为：application/x-www-form-urlencoded，是 HTML 表单提交时最常见的一种。</td></tr><tr><td>CURLOPT_POSTFIELDS</td><td>全部数据使用HTTP协议中的 “POST” 操作来发送。 要发送文件，在文件名前面加上@前缀并使用完整路径。 文件类型可在文件名后以 ‘;type=mimetype’ 的格式指定。 这个参数可以是 urlencoded 后的字符串，类似’para1=val1&amp;para2=val2&amp;…’，也可以使用一个以字段名为键值，字段数据为值的数组。 如果value是一个数组，Content-Type头将会被设置成multipart/form-data。</td></tr><tr><td>CURLOPT_RETURNTRANSFER</td><td>TRUE 将curl_exec()获取的信息以字符串返回，而不是直接输出。</td></tr></tbody></table><p>curl的功能很强大，不只能发送POST，这里没有写到的预定义常量可以看 <a href="http://php.net/manual/zh/function.curl-setopt.php" target="_blank" rel="noopener">http://php.net/manual/zh/function.curl-setopt.php</a> 。</p><h3 id="curl-exec-ch"><a href="#curl-exec-ch" class="headerlink" title="curl_exec(ch)"></a>curl_exec(ch)</h3><p>执行curl会话，接收一个curl句柄，成功时返回请求到的相关内容，失败时返回false。</p><h3 id="curl-close-ch"><a href="#curl-close-ch" class="headerlink" title="curl_close(ch)"></a>curl_close(ch)</h3><p>关闭curl会话，释放资源，接收一个curl句柄，无返回值。</p><p>以上就是比较简单的PHP发送get和post，方法有很多种，我只是写了其中的两种，关于更复杂的带COOKIE发送以后在写。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Xshell远程登录Linux服务器</title>
      <link href="/2019/01/28/%E4%BD%BF%E7%94%A8Xshell%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95Linux%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2019/01/28/%E4%BD%BF%E7%94%A8Xshell%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95Linux%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>Xshell是一个功能强大的终端模拟器，支持SSH、SFTP、telnet，rlogin和串行。人们可以使用它在Windows界面下用来访问远端不同系统下的服务器，从而达到远程控制终端的目的。<br><a id="more"></a></p><p>在 <a href="http://www.changbin.me/index.php/2018/11/25/%e5%9c%a8linux-vps-%e6%90%ad%e5%bb%bass%e6%9c%8d%e5%8a%a1%e5%99%a8-%e5%ae%9e%e7%8e%b0%e7%a7%91%e5%ad%a6%e4%b8%8a%e7%bd%91/" target="_blank" rel="noopener">在Linux VPS 搭建SS服务器 实现科学上网</a> 这篇教程中说到了需要使用远程工具连接Linux，这里就来简单的写一下远程工具的使用。我个人经常使用的远程工具是Xshell ，这是一款不错的SSH工具，软件对于个人和家庭使用是免费的，但是Xshell 6的免费版有一些限制，同时打开的标签页数量不能超过4个，对于服务器少的个人用户来说也基本够用。</p><p>首先打开Xshell的官网：<a href="https://www.netsarang.com/en/xshell/" target="_blank" rel="noopener">https://www.netsarang.com/en/xshell/</a> ，注意！官网是英文的，不要在中文的网站下载，不要直接在百度上搜索Xshell，也不要在其他的软件站下载，防止修改版的Xshell上传服务器IP和密码。目前最新的版本是Xshell 6，进入后点击 <strong>Download</strong> ，然后在Xshell 6下方点击 <strong>Download ，</strong></p><p><img src="https://wsmcb.github.io/img/xshell官网.jpg" alt="xshell官网"></p><p>然后在点击 <a href="https://www.netsarang.com/en/free-for-home-school/" target="_blank" rel="noopener">Free Licensing Page</a> 进入免费许可申请，根据提示输入姓名和邮箱，姓名可以随便输入，输入完成后选中Xshell Only，点击 <strong>Download</strong> ，</p><p><img src="https://wsmcb.github.io/img/xshell获取.jpg" alt="xshell获取"></p><p>官方会发送一封邮件到你填写的邮箱，其中邮件中就包含下载地址，根据提示点击进入下载，下载完成后和其他软件一样的安装，Xshell 6有中文，安装很简单。</p><p>打开软件会弹出会话窗口，点击 <strong>新建</strong> ，</p><p><img src="https://wsmcb.github.io/img/xshell面板.jpg" alt="xshell面板"></p><p>名称：可以输入一个备注名称，例如 服务器1。协议：可以使用默认的SSH。主机：输入服务器IP，例如172.93.47.76。端口：输入SSH的端口号，一般默认是22，如果有不一样的会在官网的控制面板有说明。说明：可以不用填，如果有多个服务器可以填。输入完成后点击 <strong>确定</strong> 保存服务器。</p><p><img src="https://wsmcb.github.io/img/xshell登录.jpg" alt="xshell登录"></p><p>选中保存的服务器，点击 <strong>连接</strong> ，如果服务器网络正常的话会弹出用户名对话框，输入用户名，如果是个人电脑的话可以选中保存用户名，然后 <strong>确定</strong> 。</p><p><img src="https://wsmcb.github.io/img/xshell输入用户名.jpg" alt="xshell输入用户名"></p><p>如果用户名正确的话会弹出密码对话框，在password后面输入密码，如果以后需要自动登录的话可以选中保存密码，输入完成后 <strong>确定</strong> 。</p><p><img src="https://wsmcb.github.io/img/xshell输入密码.jpg" alt="xshell输入密码"></p><p>如果看到类似于下面的提示，说明连接成功：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Connecting to 172.93.47.76:22...</span><br><span class="line">Connection established.</span><br><span class="line">To escape to local shell, press 'Ctrl+Alt+]'.</span><br><span class="line"></span><br><span class="line">WARNING! The remote SSH server rejected X11 forwarding request.</span><br><span class="line">Last login: Fri Jan 11 00:59:14 2019 from 75.128.114.33</span><br><span class="line">[root@host ~]#</span><br></pre></td></tr></table></figure><p>显示的IP会不一样，更多的功能和设置可以自己摸索。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux rpm包管理</title>
      <link href="/2019/01/10/Linux-rpm%E5%8C%85%E7%AE%A1%E7%90%86/"/>
      <url>/2019/01/10/Linux-rpm%E5%8C%85%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>RPM包管理员是在Linux下广泛使用的软件包管理器。RPM此名词可能是指.rpm的文件格式的软件包，也可能是指其本身的软件包管理器。最早由Red Hat研制，现在也由开源社区开发。RPM通常随附于Linux发行版，但也有单独将RPM作为应用软件发行的发行版。</p><a id="more"></a><p>目前常见的使用RPM包的Linux版本有 Redhat、<a href="https://www.centos.org/" target="_blank" rel="noopener">CentOS</a>、<a href="https://getfedora.org/zh_CN/" target="_blank" rel="noopener">Fedora</a> 。如果说Yum是应用商店的话，那RPM就是安装包，Yum安装软件需要有网络或光盘，而RPM只要有安装包和依赖的程序就能安装，无需网络。不过因为Linux的软件之间的依赖性较强，所以在安装RPM包的时候除了要准备要安装的RPM包外还需要准备一堆依赖的安装包。这里的依赖就类似于Windows上的各种运行库，例如C#开发的软件就依赖.net framework，java开发的软件例如Minecraft就依赖java运行环境。</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>我这里使用的Linux版本是CentOS7，因为演示使用的是云服务器，所以就直接在网上下载RPM包了。这里用来演示安装的RPM包是P7z，这是一个用来压缩或解压7z文件的软件，首先下载RPM包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.mirrorservice.org/sites/dl.fedoraproject.org/pub/epel/7/x86_64/Packages/p/p7zip-16.02-10.el7.x86_64.rpm</span><br><span class="line">wget https://www.mirrorservice.org/sites/dl.fedoraproject.org/pub/epel/7/x86_64/Packages/p/p7zip-plugins-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>p7z需要下载两个文件，下载的两个RPM包的文件名分别是：</p><ul><li>p7zip-16.02-10.el7.x86_64.rpm</li><li>p7zip-plugins-16.02-10.el7.x86_64.rpm</li></ul><p>安装RPM包的命令是：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh 包文件名</span><br></pre></td></tr></table></figure><p>其中RPM后面的 <strong>-ivh</strong> 是参数，下面是参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-i</td><td>安装，安装RPM必须的</td></tr><tr><td>-v</td><td>显示详细信息</td></tr><tr><td>-h</td><td>显示安装进度</td></tr></tbody></table><p>这里就安装之前下载的两个RPM包，因为我所在的位置和存放RPM包的位置是同一个目录，所以安装的时候RPM包的文件名可以不用写完整路径，下面先安装 <strong>p7zip-16.02-10.el7.x86_64.rpm</strong>，下面是安装演示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh p7zip-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>完整过程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -ivh p7zip-16.02-10.el7.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:p7zip-16.02-10.el7               ################################# [100%]</span><br></pre></td></tr></table></figure><p>安装第一个的时候没遇到依赖问题，下面安装第二个，也就是 <strong>p7zip-plugins-16.02-10.el7.x86_64.rpm</strong>，下面演示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh p7zip-plugins-16.02-10.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>完整过程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -ivh p7zip-plugins-16.02-10.el7.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:p7zip-plugins-16.02-10.el7       ################################# [100%]</span><br></pre></td></tr></table></figure><p>这次竟然破天荒的没遇到依赖的问题？也可能是因为我的服务器安装了很多运行库的原因吧！一般情况下如果没有安装所需依赖的软件的话，安装的时候会提示，解决方法就是根据提示的软件名称到 <a href="https://www.google.com/" target="_blank" rel="noopener">Google</a> 上搜索RPM包下载安装，或者到 <a href="https://rpm.pbone.net/" target="_blank" rel="noopener">https://rpm.pbone.net/</a> 搜索下载安装，安装的时候先安装依赖程序，在安装主RPM包。</p><h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>更新的命令为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh 包文件名</span><br></pre></td></tr></table></figure><p>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-U</td><td>更新，更新必须的，注意！是大写U</td></tr></tbody></table><p><strong>-v</strong> 和 <strong>-h</strong> 和安装时的参数是一样的，不过这里的更新需要有更高版本的RPM包才行，例如我之前安装的软件版本是1.0，我需要有比1.0高的版本的RPM包才能更新，</p><h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><p>卸载的命令为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e 包名</span><br></pre></td></tr></table></figure><p>参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-e</td><td>卸载，卸载必须的</td></tr></tbody></table><p><strong>注意！卸载的时候包名不需要输入完整的文件名，例如我要卸载p7zip，只需要输入 rpm -e p7zip，而不是输入 rpm -e p7zip-16.02-10.el7.x86_64.rpm。</strong>如果安装的RPM包还依赖其他程序的话，先卸载主程序、在卸载依赖的程序。还有 卸载的时候不需要切换到RPM安装包所在的目录，也不需要输入任何路径，甚至安装完成后都可以删除RPM安装包。</p><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>查询某个软件是否安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q 包名</span><br></pre></td></tr></table></figure><p>查询p7zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -q p7zip</span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# rpm -q p7zip</span><br><span class="line">p7zip-16.02-10.el7.x86_64</span><br></pre></td></tr></table></figure><p>如果查询的软件未安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# rpm -q eclipse</span><br><span class="line">package eclipse is not installed</span><br></pre></td></tr></table></figure><p>查询的时候只需要输入包名，不需要输入版本和后缀名。</p><p>显示所有已安装的包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa</span><br></pre></td></tr></table></figure><p>简单演示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# rpm -qa</span><br><span class="line">libXfixes-5.0.3-1.el7.x86_64</span><br><span class="line">openssh-server-6.6.1p1-31.el7.x86_64</span><br><span class="line">filesystem-3.2-21.el7.x86_64</span><br><span class="line">libdrm-devel-2.4.91-3.el7.x86_64</span><br><span class="line">audit-2.6.5-3.el7.x86_64</span><br><span class="line">bind-license-9.9.4-37.el7.noarch</span><br><span class="line">libXxf86vm-1.1.4-1.el7.x86_64</span><br><span class="line">chrony-2.1.1-3.el7.centos.x86_64</span><br><span class="line">libXrender-0.9.10-1.el7.x86_64</span><br></pre></td></tr></table></figure><p>查询已安装软件的详细信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qi 包名</span><br></pre></td></tr></table></figure><p>下面查询p7zip：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# rpm -qi p7zip</span><br><span class="line">Name        : p7zip</span><br><span class="line">Version     : 16.02</span><br><span class="line">Release     : 10.el7</span><br><span class="line">Architecture: x86_64</span><br><span class="line">Install Date: Wed 09 Jan 2019 11:52:19 PM CST</span><br><span class="line">Group       : Unspecified</span><br><span class="line">Size        : 1771534</span><br><span class="line">License     : LGPLv2 and (LGPLv2+ or CPL)</span><br><span class="line">Signature   : RSA/SHA256, Tue 06 Feb 2018 08:32:42 PM CST, Key ID 6a2faea2352c64e5</span><br><span class="line">Source RPM  : p7zip-16.02-10.el7.src.rpm</span><br><span class="line">Build Date  : Tue 06 Feb 2018 08:24:51 PM CST</span><br><span class="line">Build Host  : buildhw-09.phx2.fedoraproject.org</span><br><span class="line">Relocations : (not relocatable)</span><br><span class="line">Packager    : Fedora Project</span><br><span class="line">Vendor      : Fedora Project</span><br><span class="line">URL         : http://p7zip.sourceforge.net/</span><br><span class="line">Summary     : Very high compression ratio file archiver</span><br><span class="line">Description :</span><br><span class="line">p7zip is a port of 7za.exe for Unix. 7-Zip is a file archiver with a very high</span><br><span class="line">compression ratio. The original version can be found at http://www.7-zip.org/.</span><br></pre></td></tr></table></figure><p>查询的时候只需要输入包名，不需要输入完整的版本和后缀。</p><p>查询未安装RPM包的详细信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qip 包文件名</span><br></pre></td></tr></table></figure><p>因为是查询未安装的RPM包的信息，所以需要输入安装包的完整文件名，下面查询p7zip的安装包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -qip p7zip-16.02-10.el7.x86_64.rpm</span><br><span class="line">Name        : p7zip</span><br><span class="line">Version     : 16.02</span><br><span class="line">Release     : 10.el7</span><br><span class="line">Architecture: x86_64</span><br><span class="line">Install Date: (not installed)</span><br><span class="line">Group       : Unspecified</span><br><span class="line">Size        : 1771534</span><br><span class="line">License     : LGPLv2 and (LGPLv2+ or CPL)</span><br><span class="line">Signature   : RSA/SHA256, Tue 06 Feb 2018 08:32:42 PM CST, Key ID 6a2faea2352c64e5</span><br><span class="line">Source RPM  : p7zip-16.02-10.el7.src.rpm</span><br><span class="line">Build Date  : Tue 06 Feb 2018 08:24:51 PM CST</span><br><span class="line">Build Host  : buildhw-09.phx2.fedoraproject.org</span><br><span class="line">Relocations : (not relocatable)</span><br><span class="line">Packager    : Fedora Project</span><br><span class="line">Vendor      : Fedora Project</span><br><span class="line">URL         : http://p7zip.sourceforge.net/</span><br><span class="line">Summary     : Very high compression ratio file archiver</span><br><span class="line">Description :</span><br><span class="line">p7zip is a port of 7za.exe for Unix. 7-Zip is a file archiver with a very high</span><br><span class="line">compression ratio. The original version can be found at http://www.7-zip.org/.</span><br></pre></td></tr></table></figure><p>查询已安装RPM包的安装位置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ql 包名</span><br></pre></td></tr></table></figure><p>只需要输入包名，不需要输入版本和后缀，下面查询p7zip的安装位置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -ql p7zip</span><br><span class="line">/usr/bin/7za</span><br><span class="line">/usr/libexec/p7zip</span><br><span class="line">/usr/libexec/p7zip/7zCon.sfx</span><br><span class="line">/usr/libexec/p7zip/7za</span><br><span class="line">/usr/share/doc/p7zip</span><br><span class="line">/usr/share/doc/p7zip/7zC.txt</span><br><span class="line">/usr/share/doc/p7zip/7zFormat.txt</span><br><span class="line">/usr/share/doc/p7zip/ChangeLog</span><br><span class="line">/usr/share/doc/p7zip/Methods.txt</span><br><span class="line">/usr/share/doc/p7zip/README</span><br><span class="line">/usr/share/doc/p7zip/lzma.txt</span><br><span class="line">/usr/share/doc/p7zip/readme.txt</span><br><span class="line">/usr/share/doc/p7zip/src-history.txt</span><br><span class="line">/usr/share/licenses/p7zip-16.02</span><br><span class="line">/usr/share/licenses/p7zip-16.02/License.txt</span><br><span class="line">/usr/share/licenses/p7zip-16.02/copying.txt</span><br><span class="line">/usr/share/man/man1/7za.1.gz</span><br></pre></td></tr></table></figure><p>查询未安装RPM包的默认安装位置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qlp 包文件名</span><br></pre></td></tr></table></figure><p>下面查询p7zip安装包的默认安装位置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -qlp p7zip-16.02-10.el7.x86_64.rpm</span><br><span class="line">/usr/bin/7za</span><br><span class="line">/usr/libexec/p7zip</span><br><span class="line">/usr/libexec/p7zip/7zCon.sfx</span><br><span class="line">/usr/libexec/p7zip/7za</span><br><span class="line">/usr/share/doc/p7zip</span><br><span class="line">/usr/share/doc/p7zip/7zC.txt</span><br><span class="line">/usr/share/doc/p7zip/7zFormat.txt</span><br><span class="line">/usr/share/doc/p7zip/ChangeLog</span><br><span class="line">/usr/share/doc/p7zip/Methods.txt</span><br><span class="line">/usr/share/doc/p7zip/README</span><br><span class="line">/usr/share/doc/p7zip/lzma.txt</span><br><span class="line">/usr/share/doc/p7zip/readme.txt</span><br><span class="line">/usr/share/doc/p7zip/src-history.txt</span><br><span class="line">/usr/share/licenses/p7zip-16.02</span><br><span class="line">/usr/share/licenses/p7zip-16.02/License.txt</span><br><span class="line">/usr/share/licenses/p7zip-16.02/copying.txt</span><br><span class="line">/usr/share/man/man1/7za.1.gz</span><br></pre></td></tr></table></figure><p>查询已安装的软件包依赖的软件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qR 包名</span><br></pre></td></tr></table></figure><p>下面查询p7zip依赖的软件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -qR p7zip</span><br><span class="line">/bin/sh</span><br><span class="line">libc.so.6()(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.14)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.2.5)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3.4)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.4)(64bit)</span><br><span class="line">libgcc_s.so.1()(64bit)</span><br><span class="line">libgcc_s.so.1(GCC_3.0)(64bit)</span><br><span class="line">libm.so.6()(64bit)</span><br><span class="line">libpthread.so.0()(64bit)</span><br><span class="line">libpthread.so.0(GLIBC_2.2.5)(64bit)</span><br><span class="line">libpthread.so.0(GLIBC_2.3.2)(64bit)</span><br><span class="line">libstdc++.so.6()(64bit)</span><br><span class="line">libstdc++.so.6(CXXABI_1.3)(64bit)</span><br><span class="line">libstdc++.so.6(GLIBCXX_3.4)(64bit)</span><br><span class="line">rpmlib(CompressedFileNames) &lt;= 3.0.4-1</span><br><span class="line">rpmlib(FileDigests) &lt;= 4.6.0-1</span><br><span class="line">rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1</span><br><span class="line">rtld(GNU_HASH)</span><br><span class="line">rpmlib(PayloadIsXz) &lt;= 5.2-1</span><br></pre></td></tr></table></figure><p>可以看到p7zip依赖的软件还是很多的。</p><p>查询未安装的RPM安装包依赖的软件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qRp 包文件名</span><br></pre></td></tr></table></figure><p>下面查询p7zip安装包依赖的软件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@host downloads]# rpm -qRp p7zip-16.02-10.el7.x86_64.rpm</span><br><span class="line">/bin/sh</span><br><span class="line">libc.so.6()(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.14)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.2.5)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.3.4)(64bit)</span><br><span class="line">libc.so.6(GLIBC_2.4)(64bit)</span><br><span class="line">libgcc_s.so.1()(64bit)</span><br><span class="line">libgcc_s.so.1(GCC_3.0)(64bit)</span><br><span class="line">libm.so.6()(64bit)</span><br><span class="line">libpthread.so.0()(64bit)</span><br><span class="line">libpthread.so.0(GLIBC_2.2.5)(64bit)</span><br><span class="line">libpthread.so.0(GLIBC_2.3.2)(64bit)</span><br><span class="line">libstdc++.so.6()(64bit)</span><br><span class="line">libstdc++.so.6(CXXABI_1.3)(64bit)</span><br><span class="line">libstdc++.so.6(GLIBCXX_3.4)(64bit)</span><br><span class="line">rpmlib(CompressedFileNames) &lt;= 3.0.4-1</span><br><span class="line">rpmlib(FileDigests) &lt;= 4.6.0-1</span><br><span class="line">rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1</span><br><span class="line">rtld(GNU_HASH)</span><br><span class="line">rpmlib(PayloadIsXz) &lt;= 5.2-1</span><br></pre></td></tr></table></figure><p>不过在需要安装RPM包的时候可以直接安装，如果遇到需要安装依赖软件的话，会有提示。</p><p>下面简单整理一下查询的参数：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>-q</td><td>查询必须的</td></tr><tr><td>-a</td><td>显示所有已安装软件</td></tr><tr><td>-i</td><td>查询RPM包的详细信息</td></tr><tr><td>-p</td><td>查询未安装的RPM包，需配合其他参数使用</td></tr><tr><td>-l</td><td>查询RPM包的安装位置</td></tr><tr><td>-R</td><td>查询RPM包依赖的软件</td></tr></tbody></table><p>以上就是管理RPM包的常用命令，不过一般最常用的还是安装和卸载。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux Yum简单使用教程</title>
      <link href="/2019/01/07/Linux-Yum%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2019/01/07/Linux-Yum%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>Yum是由Duke University团队修改Yellow Dog Linux的Yellow Dog Updater开发而成，是一个基于RPM包管理的字符前端软件包管理器。能够从指定的服务器自动下载RPM包并且安装，可以处理依赖性关系，并且一次安装所有依赖的软件包，无须繁琐地一次次下载、安装。<br><a id="more"></a></p><p>简单的说Yum就类似于一个应用商店，可以方便的安装和更新软件，不过Yum的软件源除了网上的软件仓库外还可以是本地光盘。目前常见的可以使用Yum的Linux包括Redhat、<a href="https://getfedora.org/zh_CN/" target="_blank" rel="noopener">Fedora</a>、<a href="https://www.centos.org/" target="_blank" rel="noopener">CentOS</a>，但常用的<a href="https://www.ubuntu.com/index_kylin" target="_blank" rel="noopener">Ubuntu</a> 和<a href="https://www.debian.org/index.zh-cn.html" target="_blank" rel="noopener">Debian</a> 是不能使用Yum的，这两种版本使用的是apt，关于apt的使用后面会在写一篇。</p><p><strong>yum list</strong> 通过yum list可以查看可用的软件包，不过此命令显示的软件包过多，所以可能很难找到需要的软件。</p><p><strong>yum search 软件名称</strong> 通过yum search 软件名称 可以直接通过软件名称来搜索软件，下面搜索一个vim：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# yum search vim</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: repos.lax.quadranet.com</span><br><span class="line"> * elrepo-kernel: repos.lax-noc.com</span><br><span class="line"> * extras: repos.lax.quadranet.com</span><br><span class="line"> * updates: mirror.fileplanet.com</span><br><span class="line">============================================= N/S matched: vim ==============================================</span><br><span class="line">protobuf-vim.x86_64 : Vim syntax highlighting for Google Protocol Buffers descriptions</span><br><span class="line">vim-X11.x86_64 : The VIM version of the vi editor for the X Window System</span><br><span class="line">vim-common.x86_64 : The common files needed by any version of the VIM editor</span><br><span class="line">vim-enhanced.x86_64 : A version of the VIM editor which includes recent enhancements</span><br><span class="line">vim-filesystem.x86_64 : VIM filesystem layout</span><br><span class="line">vim-minimal.x86_64 : A minimal version of the VIM editor</span><br><span class="line"></span><br><span class="line">  Name and summary matches only, use "search all" for everything.</span><br></pre></td></tr></table></figure><p>可以看到如果要安装vim的话，除了安装vim自身还需要安装：</p><ul><li>vim-X11.x86_64</li><li>vim-common.x86_64</li><li>vim-enhanced.x86_64</li><li>vim-filesystem.x86_64</li><li>vim-minimal.x86_64</li></ul><p>这些程序如果要一个个的单独下载安装的话是比较麻烦的，如果通过yum安装的话可以自动安装依赖的程序。</p><p><strong>yum -y install 软件名称</strong> 通过yum -y install 软件名称 可以安装软件，这里的 <strong>-y</strong> 是无需手动确认安装，如果没有-y的话每安装一个程序都需要手动确认，下面演示安装vim：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install vim</span><br></pre></td></tr></table></figure><p>因为输出的内容太多，所以就不贴上来了，当看到 <strong>Complete</strong> 就说明安装完成了。</p><p><strong>yum -y update 软件名称</strong> 通过yum -y update可以更新软件，这里的-y还是无需手动确认，下面演示更新vim：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# yum -y update vim</span><br><span class="line">Loaded plugins: fastestmirror</span><br><span class="line">Loading mirror speeds from cached hostfile</span><br><span class="line"> * base: repos.lax.quadranet.com</span><br><span class="line"> * elrepo-kernel: repos.lax-noc.com</span><br><span class="line"> * extras: repos.lax.quadranet.com</span><br><span class="line"> * updates: mirror.fileplanet.com</span><br><span class="line">No packages marked for update</span><br></pre></td></tr></table></figure><p>因为这个vim是刚安装的，所以没有可以更新的。注意！在使用更新时别忘了加软件名称，如果不加软件名称的话yum会更新所有软件，包括系统内阁，可能会导致系统出现一些问题。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y remove vim</span><br></pre></td></tr></table></figure><p>注意！使用yum卸载软件会同时卸载相关的依赖程序，如果多个软件都依赖同一个程序的话可能会导致一部分软件无法使用，所以谨慎使用yum卸载。</p><p>下面简单写一下CentOS切换yum源，如果发现国内的Linux通过yum下载很慢的话可以考虑切换到国内的yum源，目前阿里云有提供yum源。</p><p>CentOS yum的配置文件在 <strong>/etc/yum.repos.d/CentOS-Base.repo</strong> 在切换之前可以备份一下CentOS默认的配置文件，</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br></pre></td></tr></table></figure><p>主要就是修改一下配置文件的名称，把CentOS-Base.repo修改为CentOS-Base.repo.backup，如果要还原的话把名称改回来就可以了。</p><p>下载和系统对应的yum配置文件，地址：<a href="http://mirrors.aliyun.com/repo/" target="_blank" rel="noopener">http://mirrors.aliyun.com/repo/</a> ，例如我的系统版本是CentOS7，那就要下载Centos7的，下载的时候先进入 <strong>/etc/yum.repos.d</strong> ，主要就是要把文件下载到/etc/yum.repos.d：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.aliyun.com/repo/Centos-7.repo</span><br></pre></td></tr></table></figure><p>下载完成后重命名为CentOS默认的名称：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv Centos-7.repo CentOS-Base.repo</span><br></pre></td></tr></table></figure><p>因为我的位置在/etc/yum.repos.d目录，所以重命名的时候不需要输入完整的目录。</p><p>清除缓存：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum clean all</span><br></pre></td></tr></table></figure><p>重新生成缓存：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></table></figure><p>完成后可以用vi或vim查看一下配置文件里的地址是否包含 <strong>aliyun</strong> ：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim CentOS-Base.repo</span><br></pre></td></tr></table></figure><p>到这里就已经设置完成了，主要就是替换一下配置文件，在清除缓存和生成缓存。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win10远程连接Windows Server服务器</title>
      <link href="/2019/01/06/Win10%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5Windows-Server%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2019/01/06/Win10%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5Windows-Server%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>最近我除了要把百度网盘的内容搬运到OneDrive外，还需要把天意云网盘的内容也搬运到OneDrive，因为我自己家用的宽带只有50M，不想影响到上网，但又没有Linux版的天意云客户端，所以只能在Vultr上开了一台Windows Server的服务器。<br><a id="more"></a><br>不过这个Windows Server的服务器是真不便宜，一个月的价格就要26美元，和他差不多的Linux服务器也只要10美元。这里就来简单的写一下Win10连接Windows Server服务器的过程。</p><p>Windows连接Windows Server其实很简单，不需要任何第三方工具，而且延迟也很小，如果网络不差的话，体验和操作自己的计算机差不多。</p><p>首先打开 <strong>运行</strong>，输入 <strong>mstsc</strong> ，回车</p><p><img src="https://wsmcb.github.io/img/连接WinServer1.jpg" alt="运行"></p><p>打开远程桌面连接，计算机：输入服务器的IP，用户名：输入服务器的用户名，</p><p><img src="https://wsmcb.github.io/img/连接WinServer2.jpg" alt="输入IP和用户名"></p><p>输入完成后点击 <strong>连接</strong>，如果IP和用户名没问题的话会提示输入密码，输入用户名对应的密码，如果不需要设置其他的可以直接 <strong>确定</strong>，</p><p><img src="https://wsmcb.github.io/img/连接WinServer3.jpg" alt="输入密码"></p><p>如果还需要设置显示或者声音的话可以先设置在确定，建议把分辨率设置为和自己电脑一样的分辨率，这样体验会比较好，声音的话如果不需要在远程服务器上播放音乐或视频的话可以不用设置，</p><p><img src="https://wsmcb.github.io/img/WinServer连接设置.jpg" alt="WinServer连接设置"></p><p>连接成功后就可以向日常使用电脑一样使用了，这个Windows Server2016界面和Windows10的差不多，</p><p><img src="https://wsmcb.github.io/img/连接WinServer4.jpg" alt="windows server桌面"></p><p>因为是Windows系统，所以一般Windows电脑能用的软件Windows Server都能用，不过Windows Server对配置的要求还是比较高的，可能是因为图形界面的原因，装完系统没有安装其他软件的情况下，硬盘占用就已经达到了10多G，不过Windows Server系统是真的方便，能运行的软件也比较多，只是价格比较贵。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Win10 </tag>
            
            <tag> Windows Server </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Baidupcs-web下载百度网盘的文件到Linux服务器</title>
      <link href="/2019/01/03/%E4%BD%BF%E7%94%A8Baidupcs-web%E4%B8%8B%E8%BD%BD%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%B0Linux%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2019/01/03/%E4%BD%BF%E7%94%A8Baidupcs-web%E4%B8%8B%E8%BD%BD%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%9A%84%E6%96%87%E4%BB%B6%E5%88%B0Linux%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>最近我需要把百度网盘上的一些文件搬运到OneDrive网盘，但是由于文件太多，差不多有1T多，如果要一个个的下载上传的话对于我这种50M的宽带来说不知道要到什么时候，而且OneDrive感觉在国内也不是太稳定。<br><a id="more"></a></p><p>在逛Github的时候发现了一款能在Linux使用的百度网盘工具，不过这个工具不是百度官方出的，这是软件在Github的地址：<a href="https://github.com/liuzhuoling2011/baidupcs-web" target="_blank" rel="noopener">https://github.com/liuzhuoling2011/baidupcs-web</a>，有了这个 软件我就可以把百度网盘的文件直接下载到服务器，在通过服务器上的OneDrive把文件远程同步到OneDrive网盘，对于有千兆带宽的服务器来说速度就要快的多，而且因为是在远程服务器上进行的，所以不会影响到我的上网。</p><p>首先下载软件到服务器：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/liuzhuoling2011/baidupcs-web/releases/download/3.6.1/BaiduPCS-Go-3.6.1-linux-86.zip</span><br></pre></td></tr></table></figure><p>下载的时候可以根据服务器的情况选择版本，或者也可以直接进入 <a href="https://github.com/liuzhuoling2011/baidupcs-web/releases" target="_blank" rel="noopener">这里下载</a>，下载完成后解压：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip BaiduPCS-Go-3.6.1-linux-86.zip</span><br></pre></td></tr></table></figure><p>解压完成后是一个文件夹，所以还需要进入文件夹：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd BaiduPCS-Go-3.6.1-linux-86</span><br></pre></td></tr></table></figure><p>增加执行权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x BaiduPCS-Go</span><br></pre></td></tr></table></figure><p>运行：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./BaiduPCS-Go</span><br></pre></td></tr></table></figure><p>运行后可以看到如下界面：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@host BaiduPCS-Go-3.6.1-linux-86]# ./BaiduPCS-Go</span><br><span class="line">打开浏览器, 输入 http://localhost:5299 查看效果</span><br></pre></td></tr></table></figure><p>在浏览器中输入ip:5299就可以进入百度网盘了，别忘了打开5299端口，输入账号和密码登录百度网盘，</p><p><img src="https://wsmcb.github.io/img/baidupcsweb登录.jpg" alt="baidupcsweb登录"></p><p>如果百度账号绑定了手机号的话，登录是需要手机验证的，所以也不用担心软件作者会获取账号密码登录，界面如下：</p><p><img src="https://wsmcb.github.io/img/baidupcsweb界面.jpg" alt="baidupcsweb界面"></p><p>在网页上的操作也会实时的在终端输出：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[1] 准备下载: /视频/HTML5教程.rar</span><br><span class="line">[1] 将会下载到路径: /root/Downloads/675868370_userName/视频/HTML5教程.rar</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[1] 下载文件错误, 下载单个文件: 遇到错误, 远端服务器返回错误, 代码: 31326, 消息: user is not authorized, hitcode:123</span><br><span class="line"></span><br><span class="line">任务结束, 时间: 1s, 数据总量: 0B</span><br><span class="line">以下文件下载失败: </span><br><span class="line">  0  /视频/HTML5教程.rar</span><br></pre></td></tr></table></figure><p>不过用一段时间可能会被封IP，如果发现一直下载失败的话，可以等一段时间在用，文件下载位置在下载文件的时候终端会有显示。</p><p><img src="https://wsmcb.github.io/img/baidupcsweb下载.jpg" alt="baidupcsweb下载"></p><p>感觉开了超级会员后出现下载失败的概率都变小了!</p><p>注意！因为这是第三方的百度网盘工具，所以可能会有被封号的风险，如果担心被封号的话，可以注册一个小号，大号分享文件给小号下载。这个软件也有windows版的，使用很简单，直接打开软件，按照提示打开浏览器进入网页即可，用这个软件基本可以解决一部分百度网盘限速的问题，不过用一段时间后还是会经常下载失败。看来我搬运文件到OneDrive还得在服务器和日常用的电脑上同时进行。</p><p>我的博客：<a href="http://www.changbin.me](http://www.changbin.me)" target="_blank" rel="noopener">www.changbin.me](http://www.changbin.me)</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 下载 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用WordPress快速搭建个人博客</title>
      <link href="/2019/01/01/%E4%BD%BF%E7%94%A8WordPress%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2019/01/01/%E4%BD%BF%E7%94%A8WordPress%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>作为一个程序员，每天都会遇到各种各样的问题需要解决，有的问题解决起来比较简单，有的问题解决起来可能比较难，而通过笔记或博客记录下解决问题的过程有助于加深对问题的理解，顺便也能帮助到别人。<br><a id="more"></a></p><p>关于写博客的平台，国内有很多，例如 <a href="http://blog.sina.com.cn/" target="_blank" rel="noopener">新浪博客</a>、<a href="http://blog.163.com/" target="_blank" rel="noopener">网易博客</a>、<a href="https://blog.csdn.net/" target="_blank" rel="noopener">CSDN博客</a>、<a href="https://www.cnblogs.com/" target="_blank" rel="noopener">博客园</a> 等……但是这些博客都有着各种各样的问题，有的不方便插入代码、有的有很多广告，而且对博客内容的控制权也掌握在平台手中。当然 如果上面说的你都不在乎的话，那随便一个平台都可以写博客，而且事儿还少。但如果你对上面的几个平台都不满意，但又不想花钱买服务器的话，<a href="https://pages.github.com/" target="_blank" rel="noopener">GithubPages</a> 是一个不错的选择，可以免费托管静态网站，只是可能稍微有点麻烦。还有一种方式可以解决上面说的那些问题，就是自己搭建博客，可以选择自己开发，也可以使用现成的开源博客，这里要写的也是使用<a href="https://wordpress.org/" target="_blank" rel="noopener">WordPress</a> 来搭建博客。</p><p>WordPress是一个以PHP和MySQL为平台的自由开源的博客软件和内容管理系统。WordPress具有插件架构和模板系统。截至2018年4月，排名前1000万的网站超过30.6%使用WordPress。WordPress是最受欢迎的网站内容管理系统。WordPress是目前因特网上最流行的博客系统。</p><p>如果要自己搭建博客就需要有服务器或虚拟主机，每年服务器加域名的价格可能至少需要200多。目前国内的 <a href="https://www.aliyun.com/" target="_blank" rel="noopener">阿里云</a>、<a href="https://cloud.tencent.com/" target="_blank" rel="noopener">腾讯云</a>、<a href="https://cloud.baidu.com/" target="_blank" rel="noopener">百度云</a> 等都有提供云服务器和虚拟主机，如果你只是建一个网站的话，虚拟主机也基本够用，但如果要建多个网站或对运行环境和语言有要求的话，建议还是购买云服务器，而且云服务器除了能建站外还能做其他的。目前在国内建站是需要备案的，如果你只是搭建一个博客，并且准备长期使用的话，可以在国内备案，而且在国内访问的话，速度也比较快，注意！申请备案的域名如果哪天不用了是需要申请取消备案的。如果你嫌麻烦不想备案的话，可以选择香港或国外的服务器，不过在国内的访问速度可能会慢一些，香港的还好，如果是欧洲的就比较慢了。如果要购买国外服务器的话，阿里云、百度云、腾讯云 都有，不过价格可能会比较贵，这里也推荐几个国外的 <a href="https://bandwagonhost.com/" target="_blank" rel="noopener">BandwagonHost</a>、<a href="https://www.digitalocean.com/" target="_blank" rel="noopener">DigitalOcean</a>、<a href="https://www.vultr.com/" target="_blank" rel="noopener">Vultr</a>-，购买的时候建议先测试一下延迟。</p><p>有了服务器后还需要域名，国内的 万网、腾讯云、百度云等都卖域名，国外的 <a href="https://sg.godaddy.com/zh" target="_blank" rel="noopener">GoDaddy</a>、<a href="https://www.namesilo.com/" target="_blank" rel="noopener">namesilo</a> 也可以，如果在国外购买域名的话不用实名认证，不过cn域名只能在国内使用，购买的时候要注意，关于购买域名也可以看 <a href="http://www.changbin.me/index.php/2018/11/17/%e5%9c%a8namesilo%e8%b4%ad%e4%b9%b0%e5%9f%9f%e5%90%8d/" target="_blank" rel="noopener">在namesilo购买域名</a>。</p><p>如果你买的是云服务器的话，就需要安装相应的运行环境，WordPress使用的是PHP开发，所以需要有PHP和Mysql才可以，关于安装运行环境可以看 <a href="http://www.changbin.me/index.php/2018/09/11/%e4%bd%bf%e7%94%a8linux-vps-%e5%ae%9d%e5%a1%94linux%e9%9d%a2%e6%9d%bf%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e7%bd%91%e7%ab%99/" target="_blank" rel="noopener">使用Linux VPS + 宝塔Linux面板快速搭建网站</a> ，安装完运行环境后可以到 <a href="https://wordpress.org/" target="_blank" rel="noopener">WordPress官网</a> 下载，直接点击 <a href="https://wordpress.org/download/" target="_blank" rel="noopener">Get WordPress</a>，然后 Download WordPress，下载完成后是zip的压缩包，也可以下载tar.gz的，可以用FTP或宝塔面板把压缩包上传到网站空间解压，关于压缩或解压文件可以看 <a href="http://www.changbin.me/index.php/2018/12/28/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e6%89%93%e5%8c%85%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">Linux压缩和打包文件</a>，如果安装了宝塔面板的话也可以通过宝塔面板来解压，如果是虚拟主机的话可以在本地解压，然后通过FTP工具全选上传。然后把域名解析到你的服务器，不出意外的话输入域名就可以看到WordPress的初始化界面了，不过设置完域名解析后需要一段时间才能生效。</p><p>如果要初始化WordPress你还需要建立一个数据库，如果安装了宝塔面板的话，可以打开phpmyadmin，点击SQL，输入SQL语句建立数据库，如果是虚拟主机的话一般数据库都是建立好的，你只需要打开phpmyadmin看一下数据库名，如果Linux的服务器没有安装phpmyadmin的话可以直接在终端连接数据库，连接数据库的语句是：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u用户名 -p密码</span><br></pre></td></tr></table></figure><p>连接Mysql后就可以建立数据库了，新建数据库的语句是：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> 数据库名 <span class="keyword">CHARSET</span> utf8</span><br></pre></td></tr></table></figure><p>数据库名不能包含中文，建立完数据库就可以初始化WordPress了。</p><p>首先是选择语言</p><p><img src="https://wsmcb.github.io/img/wp选择语言.jpg" alt="wp选择语言"></p><p>选择完成后点击 <strong>继续</strong> ，在点击 <strong>现在开始</strong>，按提示输入相关信息，</p><p><img src="https://wsmcb.github.io/img/wp输入数据库信息.jpg" alt="wp输入数据库信息"></p><p>数据库名：输入你建立的数据库的名称，如果是虚拟主机的话 查看默认的数据库名，例如我建立的数据库名是wordpress，数据库名就输入wordpress。用户名：输入数据库的用户名，如果是服务器的话可以用root，如果是虚拟主机的话可以登录相关的控制面板查看。密码：输入数据库用户名对应的密码，虚拟主机可以在相关的控制面板查看。数据库主机：使用默认的localhost就可以，如果是单独买了云数据库的话就输入数据库的IP。表前缀：默认的wp-就可以，输入完成后点击 <strong>提交</strong>。如果看到 <strong>不错。您完成了安装过程中重要的一步，WordPress现在已经可以连接数据库了。如果您准备好了的话，现在就…</strong>的话，说明数据库正常，可以点击 <strong>现在安装</strong>。接着按照提示输入相关信息，</p><p><img src="https://wsmcb.github.io/img/wp输入博客信息.jpg" alt="wp输入博客信息"></p><p>站点标题：输入你的博客名称，例如我的博客叫 <strong>冰是睡着的水的博客</strong> 就需要输入冰是睡着的水的博客，用户名：输入一个用户名 用来登录博客后台，要写文章的时候就需要登录到后台。密码：输入一个密码用来登录后台。邮箱：输入你的邮箱，当有人在你的文章下评论时会有邮件通知。输入完成后点击 <strong>安装WordPress</strong>。</p><p>看到 <strong>成功</strong> 后就可以登录了，输入之前设置的用户名和密码登录</p><p><img src="https://wsmcb.github.io/img/wp登录.jpg" alt="wp登录"></p><p>登录后点击 <strong>查看站点</strong> 可以查看博客首页，也就是别人访问你的博客时看到的页面</p><p><img src="https://wsmcb.github.io/img/查看站点.jpg" alt="查看站点"></p><p>默认的2019主题可能有点丑，也不知道<strong>WordPress</strong>设计师是怎么想的？</p><p><img src="https://wsmcb.github.io/img/wp博客首页.jpg" alt="wp博客首页"></p><p>点击 <strong>主题</strong> 可以更换主题，点击右边的加耗可以下载更多主题，因为WordPress除了博客外还能作CMS甚至配合一些插件还能作电商网站，所以不是每一个主题都适合博客，</p><p><img src="https://wsmcb.github.io/img/wp主题.jpg" alt="wp主题"></p><p>默认有一篇文章可以删除</p><p><img src="https://wsmcb.github.io/img/wp删除文章.jpg" alt="wp删除文章"></p><p>在常规设置中可以更改网站的标题和副标题，</p><p><img src="https://wsmcb.github.io/img/wp设置.jpg" alt="wp设置"></p><p>点击 安装插件可以下载插件安装，</p><p><img src="https://wsmcb.github.io/img/wp插件.jpg" alt="wp插件"></p><p>如果在写文章的时候发现默认的编辑器用不习惯的话，可以安装一个 <strong>Classic Editor</strong>，退出登录后如果要登录的话可以在侧边栏的功能分类中找到登录，或者直接访问 域名/wp-login.php。</p><p>以上就是wordpress的简单安装和设置，更多的wordpress设置可以自己摸索，其实除了wordpress外PHP的开源博客还有<a href="http://typecho.org/" target="_blank" rel="noopener">Typecho</a>，Typecho还是国人自己开发的PHP博客，因为Typecho的功能没有wordpress的多，所以速度也要更快一些，如果觉得wordpress比较卡的话，也可以选择Typecho。</p><p>相关参考文章：</p><ul><li><a href="http://www.changbin.me/index.php/2018/09/11/%e4%bd%bf%e7%94%a8linux-vps-%e5%ae%9d%e5%a1%94linux%e9%9d%a2%e6%9d%bf%e5%bf%ab%e9%80%9f%e6%90%ad%e5%bb%ba%e7%bd%91%e7%ab%99/" target="_blank" rel="noopener">使用Linux VPS + 宝塔Linux面板快速搭建网站</a></li><li><a href="http://www.changbin.me/index.php/2018/11/17/%e5%9c%a8namesilo%e8%b4%ad%e4%b9%b0%e5%9f%9f%e5%90%8d/" target="_blank" rel="noopener">在namesilo购买域名</a></li><li><a href="http://www.changbin.me/index.php/2018/12/28/linux%e5%8e%8b%e7%bc%a9%e5%92%8c%e6%89%93%e5%8c%85%e6%96%87%e4%bb%b6/" target="_blank" rel="noopener">Linux压缩和打包文件</a></li></ul><p>我的博客：<a href="http://www.changbin.me](http://www.changbin.me)" target="_blank" rel="noopener">www.changbin.me](http://www.changbin.me)</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VPS </tag>
            
            <tag> 博客 </tag>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux压缩和打包文件</title>
      <link href="/2018/12/28/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E6%89%93%E5%8C%85%E6%96%87%E4%BB%B6/"/>
      <url>/2018/12/28/Linux%E5%8E%8B%E7%BC%A9%E5%92%8C%E6%89%93%E5%8C%85%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>在使用计算机的时候，压缩文件应该是经常会用到的功能。首先：通过压缩文件可以减小文件体积，节省存储空间。其次：通过打包或压缩文件可以把多个文件整合为一个文件，方便传输，尤其是对于多个小文件。这里就来简单的写一下Linux的压缩和打包文件，使用的是Linux自带的gzip、bzip2、xz，其他的压缩工具例如rar以后有时间在写，为了方便查看，这里把压缩和打包分开写。<br><a id="more"></a></p><h2 id="打包文件"><a href="#打包文件" class="headerlink" title="打包文件"></a>打包文件</h2><p>打包文件就是把多个文件整合为一个文件，主要是打包，没有压缩，下面是/home目录的两个文件，文件大小为6字节：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# ls -lh</span><br><span class="line">总用量 0</span><br><span class="line">-rw-rw-rw- 1 root root 6 12月 27 23:55 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 6 12月 27 23:56 2.txt</span><br></pre></td></tr></table></figure><p>打包的命令是 <strong>tar cf 新文件名 要打包文件的文件名</strong>，多个文件可用空格分隔，下面把1.txt和2.txt打包为一个名为12.tar的文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# tar cf 12.tar 1.txt 2.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/home# ls</span><br><span class="line">12.tar  1.txt  2.txt</span><br></pre></td></tr></table></figure><p>查看一下大小：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# ls -lh</span><br><span class="line">总用量 12K</span><br><span class="line">-rw-rw-rw- 1 root root 10K 12月 28 00:03 12.tar</span><br><span class="line">-rw-rw-rw- 1 root root   6 12月 27 23:55 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root   6 12月 27 23:56 2.txt</span><br></pre></td></tr></table></figure><p>可以看到两个6B的文件打包后变成了10K，下面在把/tmp目录下的5个2.3K的文件进行打包：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 20K</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# tar cf 12345.tar 1.txt 2.txt 3.txt 4.txt 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 52K</span><br><span class="line">-rw-rw-rw- 1 root root  20K 12月 28 00:16 12345.tar</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br></pre></td></tr></table></figure><p>5个2.3K的文件打包后变成了20K，多出来的那几K应该是存储的文件信息，如果要打包目录也是可以的，要打包的文件名写目录名即可。后缀名使用<strong>tar</strong>是为了方便查看和辨认。</p><p>使用 <strong>tar tf 文件名</strong> 可查看打包的文件，下面是查看/home目录下的12.tar：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# ls</span><br><span class="line">12.tar  1.txt  2.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/home# tar tf 12.tar</span><br><span class="line">1.txt</span><br><span class="line">2.txt</span><br></pre></td></tr></table></figure><p>使用 <strong>tar xf 文件名</strong> 可提取文件，下面还是提取/home目录下的12.tar里的文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# ls</span><br><span class="line">12.tar</span><br><span class="line">root@DESKTOP-VKKQVTF:/home# tar xf 12.tar</span><br><span class="line">root@DESKTOP-VKKQVTF:/home# ls</span><br><span class="line">12.tar  1.txt  2.txt</span><br></pre></td></tr></table></figure><p>使用 <strong>tar vf 文件名</strong> 可查看文件信息，下面是查看/home/12.tar的文件信息：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/home# tar vf 12.tar</span><br><span class="line">tar: You must specify one of the '-Acdtrux', '--delete' or '--test-label' options</span><br><span class="line">Try 'tar --help' or 'tar --usage' for more information.</span><br><span class="line">root@DESKTOP-VKKQVTF:/home#</span><br></pre></td></tr></table></figure><p>下面是<strong>tar</strong>的参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>c</td><td>打包文件</td></tr><tr><td>t</td><td>查看已打包的文件</td></tr><tr><td>x</td><td>提取文件</td></tr><tr><td>v</td><td>查看文件信息</td></tr><tr><td>f</td><td>文件，用来分隔参数和文件名</td></tr></tbody></table><p>使用的方法上面都有，<strong>tar 参数f 文件名</strong>，参数前面不用加-。</p><h2 id="压缩文件"><a href="#压缩文件" class="headerlink" title="压缩文件"></a>压缩文件</h2><h3 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h3><p>压缩文件和打包文件的命令差不多，创建压缩文件也需要用到tar打包文件的参数，使用 <strong>tar zcf 文件名 要压缩的文件名</strong>，下面把/tmp目录下的5个txt文件进行压缩：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 40K</span><br><span class="line">-rw-rw-rw- 1 root root  20K 12月 28 00:16 12345.tar</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# tar zcf 12345.tar.gz 1.txt 2.txt 3.txt 4.txt 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 44K</span><br><span class="line">-rw-rw-rw- 1 root root  20K 12月 28 00:16 12345.tar</span><br><span class="line">-rw-rw-rw- 1 root root  690 12月 28 16:55 12345.tar.gz</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp#</span><br></pre></td></tr></table></figure><p>5个2.3K的文件压缩后变为690字节，相比起打包文件来说，效果还是比较明显的，这里的后缀名还是为了方便查看和辨认，关于查看和解压文件：方法和上面的查看文件和提取文件是一样的，<strong>tar 参数f 文件名</strong>。</p><h3 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h3><p>压缩文件 <strong>tar jcf 文件名 要压缩的文件名</strong> ，下面还是把/tmp目录下的5个txt文件进行压缩：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/tmp# tar jcf 12345.tar.bz2 1.txt 2.txt 3.txt 4.txt 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 48K</span><br><span class="line">-rw-rw-rw- 1 root root  20K 12月 28 00:16 12345.tar</span><br><span class="line">-rw-rw-rw- 1 root root  834 12月 28 17:06 12345.tar.bz2</span><br><span class="line">-rw-rw-rw- 1 root root  690 12月 28 16:55 12345.tar.gz</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br></pre></td></tr></table></figure><p>5个2.3K的文件压缩后变为834字节。</p><h3 id="xz"><a href="#xz" class="headerlink" title="xz"></a>xz</h3><p>压缩文件 <strong>tar Jcf 文件名 要压缩的文件名</strong> ，这里的<strong>J</strong>使用大写，下面还是压缩/tmp目录下的5个txt文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@DESKTOP-VKKQVTF:/tmp# tar Jcf 12345.tar.xz 1.txt 2.txt 3.txt 4.txt 5.txt</span><br><span class="line">root@DESKTOP-VKKQVTF:/tmp# ls -lh</span><br><span class="line">总用量 52K</span><br><span class="line">-rw-rw-rw- 1 root root  20K 12月 28 00:16 12345.tar</span><br><span class="line">-rw-rw-rw- 1 root root  834 12月 28 17:06 12345.tar.bz2</span><br><span class="line">-rw-rw-rw- 1 root root  690 12月 28 16:55 12345.tar.gz</span><br><span class="line">-rw-rw-rw- 1 root root  616 12月 28 17:11 12345.tar.xz</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:11 1.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:12 2.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 3.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 4.txt</span><br><span class="line">-rw-rw-rw- 1 root root 2.3K 12月 28 00:15 5.txt</span><br></pre></td></tr></table></figure><p>5个2.3K的文件压缩后变为616字节，看来效果还是可以的。</p><p>面是3种压缩文件的参数：</p><table><thead><tr><th>压缩工具</th><th>参数</th><th>后缀名</th></tr></thead><tbody><tr><td>gzip</td><td>z</td><td>gz</td></tr><tr><td>bzip2</td><td>j</td><td>bz2</td></tr><tr><td>xz</td><td>J</td><td>xz</td></tr></tbody></table><p>后缀名只是为了方便查看，这里的压缩是和tar打包一起使用的，解压和查看文件可以参考上面的打包相关的命令，关于rar和7z相关的工具以后有时间在写。</p><p>我的博客：<a href="http://www.changbin.me](http://www.changbin.me)" target="_blank" rel="noopener">www.changbin.me](http://www.changbin.me)</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于网站的无障碍（Accessibility）</title>
      <link href="/2018/12/24/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%AB%99%E7%9A%84%E6%97%A0%E9%9A%9C%E7%A2%8D%EF%BC%88Accessibility%EF%BC%89/"/>
      <url>/2018/12/24/%E5%85%B3%E4%BA%8E%E7%BD%91%E7%AB%99%E7%9A%84%E6%97%A0%E9%9A%9C%E7%A2%8D%EF%BC%88Accessibility%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在HTML5出现之前，网站的可访问性可以说是比较差的，这里说的可访问性主要包括移动端的兼容和对残障人士的支持，因为标题写的是无障碍，所以我这里主要要说的也是对残障人士的支持，这里的残障人士主要是使用辅助功能，例如屏幕阅读器的视力障碍人群，对于听力或肢体残疾的人群来说，浏览网页的障碍相比起视力障碍人群来说要相对低一些，因为大多数网站主要还是靠视觉来接收信息。<br><a id="more"></a></p><p>记得在苹果的官网有这样一句话： <strong>让每一个人受益的科技，才是真正强大的。</strong>而我国的残疾人数量已经达到了8502万，其中视力残疾就达到了1263万，这还是2012年的统计数据，虽然这些人相比起中国的人口来说很少，但也是上千万的，如果你的网站能够做好无障碍方面的支持或许就能增加一批用户。在网站的无障碍方面，国内感觉目前还不是太重视，大多网站都只注重外观，忽略了残障人士的可访问性，相比起国内来说，国外做的要好一些，例如 <a href="https://www.google.com/" target="_blank" rel="noopener">Google</a>、<a href="https://www.youtube.com/" target="_blank" rel="noopener">YouTube</a>、<a href="https://www.facebook.com/" target="_blank" rel="noopener">Facebook</a>、<a href="https://twitter.com/?lang=zh-cn" target="_blank" rel="noopener">Twitter</a>、<a href="https://www.microsoft.com/" target="_blank" rel="noopener">Microsoft</a>，还有谷歌旗下的网站等……这些网站都是对无障碍方面支持比较好的。</p><p>其实想增强网站的可访问性并不难，在HTML5中增加了很多标签，在开发的时候只需要按照W3C的标准，在相应的地方使用相应的标签即可，例如导航条可以使用 <code>&lt;nav&gt;</code> ，而不是 <code>&lt;div&gt;</code> ，还有按钮可以这样写：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>虽然button标签可能会有默认样式，而且在不同的浏览器可能显示的会不一样，但是button是专为按钮设计的，对屏幕阅读器的支持也比较好，当光标切到button上时，屏幕阅读器就会朗读出 按钮和按钮文本，如果你在开发过程中给控件的定义就是按钮的话，请使用button，还有 不建议使用 <strong><div></div></strong>或 <strong><span></span></strong> 来模拟按钮，虽然div和span的样式没有button复杂，但是div和span是无法使用键盘访问的，如果要用 <code>&lt;a&gt;</code> 标签来模拟按钮的话，建议这样写：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:;"</span> <span class="attr">role</span>=<span class="string">"button"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>主要就是加一个 <strong>role属性</strong>。还有不建议用表格来布局，虽然table布局对视觉没有多大影响，但是可能会对屏幕阅读器造成一些影响，主要的影响就是屏幕阅读器可能会朗读一些与表格相关的内容，例如行和列，哪怕你的表格没有边框，这样会给人造成一些困惑，建议在需要用表格的地方在使用<strong>table标签</strong>，在使用<strong>table标签</strong>的时候请区分<strong>th</strong>和<strong>td</strong>。</p><p><img> 在使用img标签时，建议加入alt属性，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img.jpg"</span> <span class="attr">alt</span>=<span class="string">"图片描述"</span>&gt;</span></span><br></pre></td></tr></table></figure><p>对于图片链接来说，<strong>alt属性</strong> 很重要，如果没有<strong>alt属性</strong>，屏幕阅读器根本不知道链接的意图，而且<strong>alt属性</strong> 在图片无法正常显示的时候也能显示图片描述。</p><p>输入框 在使用表单输入框时，不建议这样写：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    用户名 <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果这样写的话，屏幕阅读器只知道这是一个输入框，但不知道需要输入什么内容，所以需要一个<strong>label标签</strong>来关联，最好在加一个<strong>placeholder属性</strong>，<strong>如下：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"username"</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">placeholder</span>=<span class="string">"请输入注册时填写的用户名"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样的话 当<strong>input</strong>获取焦点时，屏幕阅读器就能朗读<strong>label</strong>的内容，还有 在使用单选框或复选框时，建议也用<strong>label</strong>关联，不建议用其他标签来模拟单选框或复选框，因为其他标签无法很好的支持键盘访问，而且屏幕阅读器无法朗读选中状态。</p><p><strong>WAI-ARIA</strong></p><p>WAI-ARIA 是W3C编写的规范，定义了一组可用于其他元素的HTML 特性，用于提供额外的语义化以及改善缺乏的可访问性。</p><p>重要的一点关于 WAI-ARIA 属性是它不会对web 页面有任何影响，除了让更多的信息从浏览器暴露给 accessibility APIs (无障碍API)，这也是屏幕阅读器一类的软件的信息源。WAI-ARIA 不会影响网页的结构，以及DOM 等等，尽管这些属性可用于作为css 选择器。</p><p>WAI-ARIA 给浏览器增加了 <strong>role属性</strong>，这允许我们给站点中的元素增加我们想要的语义属性。第一个主要区域便是用于为屏幕阅读器提供信息，以便用户可以找到常见的页面元素。例如消息弹框，浏览器默认的 <strong>alert</strong> 弹框屏幕阅读器是可以正常朗读的，但是出于对外观和用户体验考虑，很少会有网站用 <strong>alert</strong> 来作为消息弹框，大部分网站都会自定义消息弹框，但是自定义的消息弹框屏幕阅读器是无法朗读的，为了支持屏幕阅读器就需要用到 <strong>role属性</strong>，这是<a href="https://www.youtube.com/" target="_blank" rel="noopener">YouTube</a> 的一个消息提示，</p><p><img src="https://wsmcb.github.io/img/youtube消息提示.jpg" alt="youtube消息提示"></p><p>默认情况下，这种消息提示是无法被屏幕阅读器朗读的，但是这里用到了<strong>role属性</strong> ，</p><p><img src="https://wsmcb.github.io/img/youtube的role.jpg" alt="YouTube代码"></p><p>通过查看HTML代码可以看到，这里的 <strong>role=”alert”</strong>，有了这个属性 打开网页屏幕阅读器就能直接朗读到 <strong>role=”alert”</strong>的内容，下面是<a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a>的警告框：</p><p><img src="https://wsmcb.github.io/img/bootstrap警告框.jpg" alt="bootstrap警告框"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-success"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-info"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-danger"</span> <span class="attr">role</span>=<span class="string">"alert"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>也包含了 <strong>role=”alert”</strong>，只要警告框出现屏幕阅读器就能立即朗读，<strong>role</strong>的属性值有很多，更详细的可以在<a href="https://www.google.com/" target="_blank" rel="noopener">Google</a>搜索。</p><p><strong>aria-label 属性</strong> 有些时候可能出于对美观或浏览器兼容性的考虑会使用一些自定义控件，例如 日期选择器、进度条、字体图标等……但是自定义控件对于屏幕阅读器来说，可能无法正确朗读，甚至字体图标直接就无法朗读，这里就需要用到 <strong>aria-label属性</strong>，下面是一个没有文本的按钮：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">aria-label</span>=<span class="string">"这是按钮"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#68217A</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/空按钮.jpg" alt="空按钮"></p><p>可以看到按钮上面没有任何文字，但是因为有了 <strong>aria-label属性</strong>，当按钮获取焦点时，屏幕阅读器就会朗读<strong>这是按钮</strong>，微软的OneDrive网页版也用到了图形按钮，</p><p><img src="https://wsmcb.github.io/img/OneDrive图形按钮.jpg" alt="OneDrive图形按钮"></p><p><img src="https://wsmcb.github.io/img/OneDrive图形按钮代码.jpg" alt="OneDrive图形按钮代码"></p><p>虽然设置按钮只是一个图标，但是当设置图标获取焦点时，屏幕阅读器就会朗读 <strong>利用向下箭头来使用 设置 窗格</strong>。所以在使用自定义控件或字体图标时，增加一个 <strong>aria-label属性</strong> 可让屏幕阅读器朗读到你想表达的内容，<strong>aria-label属性</strong>的属性值就是你要让屏幕阅读器朗读的内容。</p><p><strong>aria-live 属性</strong> 现在的网站为了用户体验可能会动态的增加、删除、改变DOM的内容，这些改变对于使用屏幕阅读器的盲人来说是无法及时获取内容的，如果给标签增加一个 <strong>aria-live属性</strong>，屏幕阅读器就能直接朗读内容，</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">aria-live</span>=<span class="string">"assertive"</span>&gt;</span>Are you OK<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果上面的<strong>p</strong>标签内的内容改变的话，屏幕阅读器就能及时朗读到，如果新增一个包含<strong>aria-live属性</strong>的DOM元素屏幕阅读器也能及时朗读，<strong>aria-live</strong>的属性值可以是以下的一种：</p><table><thead><tr><th>属性值</th><th>说明</th></tr></thead><tbody><tr><td>off</td><td>默认值，更新不会提醒</td></tr><tr><td>polite</td><td>只有用户空闲的情况下提醒</td></tr><tr><td>assertive</td><td>尽快提醒</td></tr><tr><td>rude</td><td>会以打断用户操作的方式直接提醒</td></tr></tbody></table><p><strong>tabindex 属性</strong> 如果你开发的网站必须要用其他不能被键盘操作的标签来模拟按钮的话，可以给标签加入一个 <strong>tabindex属性</strong>，下面是属性值说明：</p><table><thead><tr><th>属性值</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>这个值让不能被tab 的元素变得 tabbable，如果你的div用了tabindex=”0″，div就可以获取焦点被键盘操作</td></tr><tr><td>-1</td><td>这允许通常不可列表的元素以编程方式来接收focus。例如用： JavaScript，或者作为链接的目标</td></tr></tbody></table><p>所以如果你要用<strong>div</strong>或<strong>i</strong>标签来模拟按钮的话，别忘了加一个<strong>tabindex=”0″</strong>。</p><p><strong>aria-hidden 属性</strong> 如果你有不想让屏幕阅读器朗读的内容，可以把<strong>aria-hidden属性</strong>设置未<strong>true</strong>，<strong>aria-hidden=”true”</strong>，否则可以忽略此属性。</p><p>除了上面说的HTML外，验证码也是影响视障人士使用网站的因素之一，目前国内用的比较多的还是图片验证码，也有一些网站使用的是滑动验证的验证码，这两种验证码对于盲人来说都是无法操作的，图片验证码屏幕阅读器无法朗读，滑动验证码无法用键盘操作，而且也不知道需要滑动到哪里。相比起图片和滑动验证来说，Google提供的 <a href="https://www.google.com/recaptcha/intro/v3.html" target="_blank" rel="noopener">reCAPTCHA</a> 就是对无障碍支持比较好的，只需要点击复选框来验证，而且在遇到需要选择图片的时候也有语音验证可以选择，</p><p><img src="https://wsmcb.github.io/img/reCAPTCHA.gif" alt="reCAPTCHA"></p><p>因为reCAPTCHA验证的时候只需要点击复选框，所以用键盘也是可以正常操作的。这里也希望国内网站的验证码能够 做的更人性化一些，毕竟验证码就是用来区分人和机器的，如果连人都无法识别验证码的话，那网站到底是未了什么而存在！我个人在浏览Google、YouTube、甚至steam基本都没遇到过验证码，除了邮箱验证和短信验证，而国内有些网站基本每次登录都需要验证码。</p><p>上面只是举了一部分例子，关于网站可访问性优化还有很多没有说到，关于<strong>role属性</strong>，详细的<strong>role</strong>属性值可以看 <a href="https://www.w3.org/TR/wai-aria-1.1/#role_definitions" target="_blank" rel="noopener">https://www.w3.org/TR/wai-aria-1.1/#role_definitions</a>，关于屏幕阅读器，windows自带一个屏幕阅读器，如果需要测试的话，打开<strong>讲述人</strong>就可以，iphone也自带一个屏幕阅读器 <strong>旁白</strong>，不过如果不是太熟悉旁白的使用的话建议谨慎开启。</p><p>这里也希望国内的网站能够重视起无障碍，也不仅仅是网站，也包括各种PC或移动端的APP。只要按照相关的标准来开发，作无障碍支持其实很简单。毕竟 <strong>让每一个人受益的科技，才是真正强大的科技</strong>。</p><p>参考文章：</p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility/What_is_accessibility" target="_blank" rel="noopener">什么是可访问性?</a></li><li><a href="http://www.changbin.me/index.php/2018/11/26/javascript%e4%bd%bf%e7%94%a8%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f/" target="_blank" rel="noopener">HTML: 确保可访问性的良好基础</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/learn/Accessibility/WAI-ARIA_basics" target="_blank" rel="noopener">无障碍网页应用基础</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/learn/Accessibility/Mobile" target="_blank" rel="noopener">移动设备可访问性</a></li></ul><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
            <tag> 验证码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript使用正则表达式</title>
      <link href="/2018/11/26/JavaScript%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/2018/11/26/JavaScript%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>正则表达式（英语：Regular Expression，在代码中常简写为regex、regexp或RE）使用单个字符串来描述、匹配一系列符合某个句法规则的字符串搜索模式。而在网站开发中，正则表达式可以说也是经常会用到，例如用户注册时，为了确保用户输入的用户名和密码符合要求，就需要用正则表达式来匹配验证。而在用户发布文章或评论时，也需要用正则表达式来过滤一些铭感词或不文明词。<br><a id="more"></a></p><p>因为正则表达式比较复杂，一篇博客也很难说清楚，所以这里主要写的还是JavaScript使用正则表达式的一些函数和方法。</p><p>在JavaScript中，正则表达式需要用两个斜杠包裹，也就是把正则表达式写在两个斜杠的中间，下面是一个匹配 <strong>baidu</strong>的正则表达式：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/baidu/</span>;</span><br></pre></td></tr></table></figure><p>上面的写法其实是一种简写，还有一种完整的写法如下，同样是匹配 <strong>baidu</strong>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'baidu'</span>);</span><br></pre></td></tr></table></figure><p>正则表达式是区分大小写的，如果要在匹配时忽略大小写就需要用到修饰符，例如我要匹配一个不区分大小写的 <strong>a</strong>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="regexp">/a/i</span>;</span><br></pre></td></tr></table></figure><p>后面的 <strong>i</strong> 就是修饰符，下面是一些修饰符说明：</p><table><thead><tr><th>修饰符</th><th>说明</th></tr></thead><tbody><tr><td>i</td><td>执行对大小写不敏感的匹配。</td></tr><tr><td>g</td><td>执行全局匹配（查找所有匹配而非在找到第一个匹配后停止）。</td></tr><tr><td>m</td><td>执行多行匹配。</td></tr></tbody></table><p>RegExp的第二个参数就是写修饰符的，下面还是一个不区分大小写的匹配 <strong>a</strong>：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'a'</span>, <span class="string">'i'</span>);</span><br></pre></td></tr></table></figure><p>下面是一些 <strong>RegExp</strong>的方法：</p><p><strong>test() 方法</strong> 检索字符串中指定的值，传入要检索的字符，返回true或false，下面是代码演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'404 not found'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/404/</span>;  <span class="comment">//  匹配404</span></span><br><span class="line"><span class="keyword">var</span> result = re.test(str);  <span class="comment">//  检索str的内容</span></span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>最终在控制台输出的结果为 <strong>true。</strong></p><p><strong>exec 方法</strong> 检索字符串中指定的值。返回找到的值，并确定其位置。下面是代码演示：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'中国移动10086'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = re.exec(str);</span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>上面的代码是匹配数字，非全局匹配，输出结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    index: <span class="number">4</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>上面输出了匹配到的第一个数字、位置、匹配的字符串，如果使用全局匹配，也就是加<strong>g</strong>修饰符的话，每次调用后位置都会+1，下面是代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'中国移动10086'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/g</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = [];  <span class="comment">//  用来保存结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  当结果为null时就会停止循环，因为如果exec匹配失败就会返回null</span></span><br><span class="line"><span class="keyword">while</span> (result != <span class="literal">null</span>) &#123;</span><br><span class="line">    result = re.exec(str);  <span class="comment">//  执行匹配</span></span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>) &#123;  <span class="comment">//  如果匹配成功</span></span><br><span class="line">        <span class="built_in">console</span>.log(result); <span class="comment">//  在控制台输出结果</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    index: <span class="number">4</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br><span class="line">[</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    index: <span class="number">5</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br><span class="line">[</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    index: <span class="number">6</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br><span class="line">[</span><br><span class="line">    <span class="number">8</span>,</span><br><span class="line">    index: <span class="number">7</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br><span class="line">[</span><br><span class="line">    <span class="number">6</span>,</span><br><span class="line">    index: <span class="number">8</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>上面输出了5个数组，分别是10086的匹配结果，每次匹配位置都会往后增加。</p><p>下面是一些支持正则表达式的String方法：</p><p><strong>search() 方法</strong> 检索字符串中指定的子字符串， 或检索与正则表达式相匹配的子字符串，返回匹配成功的第一个字符的位置，下面是代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'中国移动10086'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = str.search(re);</span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>控制台输出的结果为 <strong>4</strong>，也就是第一个数字的位置，search方法不支持正则表达式的<strong>g</strong>修饰符，无论调用多少次输出的结果都是一样的。</p><p><strong>match() 方法</strong> 在字符串内检索指定的值， 或找到一个或多个正则表达式的匹配，匹配成功会返回一个数组，否则返回null。下面还是匹配数字的代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'中国移动10086'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = str.match(re);</span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>这里没有使用<strong>g</strong>修饰符，下面是输出的结果：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    index: <span class="number">4</span>,</span><br><span class="line">    input: <span class="string">"中国移动10086"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>输出的结果和exec方法的差不多，包括匹配到的第1个字符、第1个字符的位置、匹配的字符串，下面是使用全局匹配的结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">8</span>,</span><br><span class="line">    <span class="number">6</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>加入<strong>g</strong>修饰符后输出了匹配到的所有字符。</p><p><strong>replace() 方法</strong> 在字符串中用一些字符替换另一些字符， 或替换一个与正则表达式匹配的子串，返回替换后的字符串。</p><p>下面是代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'中国移动10086'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = str.replace(re, <span class="string">'*'</span>);  <span class="comment">//  替换</span></span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>这里把数字替换为<em>，因为没有使用全局匹配，所以只会替换第1个数字，输出的结果为：**中国移动\</em>0086<strong>，如果加入</strong>g<strong>修饰符的话，替换后输出的结果为：</strong>中国移动*<em>****</em>。</p><p><strong>split() 方法</strong> 把一个字符串分割成字符串数组，参数为分隔符字符或正则表达式，第二个参数为数组长度，可省略。下面是代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'java1PHP2Python3C#'</span>; <span class="comment">//  字符串</span></span><br><span class="line"><span class="keyword">var</span> re = <span class="regexp">/\d/g</span>;  <span class="comment">//  匹配数字</span></span><br><span class="line"><span class="keyword">var</span> result = str.split(re);  <span class="comment">//  拆分</span></span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//  在控制台输出结果</span></span><br></pre></td></tr></table></figure><p>上面的代码是用数字作为分隔符，下面是结果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    <span class="string">"java"</span>,</span><br><span class="line">    <span class="string">"PHP"</span>,</span><br><span class="line">    <span class="string">"Python"</span>,</span><br><span class="line">    <span class="string">"C#"</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>上面就是JavaScript中经常会用到的一些正则表达式的方法。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> 正则表达式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Linux VPS 搭建SS服务器 实现科学上网</title>
      <link href="/2018/11/25/%E5%9C%A8Linux-VPS-%E6%90%AD%E5%BB%BASS%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
      <url>/2018/11/25/%E5%9C%A8Linux-VPS-%E6%90%AD%E5%BB%BASS%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%AE%9E%E7%8E%B0%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/</url>
      
        <content type="html"><![CDATA[<p>对于一个程序员来说，科学上网应该是最基本的技能，毕竟有的开源社区和网站在国内是无法访问的，即使是可以访问的速度也会很慢，而在这种情况下，掌握科学上网就是必须的了。关于搭建SS服务器的博客，我在一年前就想写了，但是因为一些原因一直没有写，这里说的SS应该很多人都知道是什么软件，虽然说除了SS外，还有很多的科学上网方法，但是就现在的情况来看，还是SS要安全一些，而且自己购买服务器除了能搭SS外，还能搭个网站、跑个爬虫什么的。<br><a id="more"></a><br>关于VPS的购买我这里就暂时不写了，只要是国外的VPS基本都可以，这里推荐一下 搬瓦工 和 Vultr，搬瓦工的价格相对便宜一些，Vultr的数据中心更多一些、而且换IP比较方便，关于机房位置：首选亚洲机房，在购买之前可以ping一下IP测试延迟，建议最好选择延迟在250以下的机房。</p><p>我这里使用的Linux版本是CentOS7，搭建SS的方法有很多种，这里写的是比较简单的，使用的是<a href="https://teddysun.com/342.html" target="_blank" rel="noopener">Teddysun</a> 的一键安装脚本，首先用远程工具连接到VPS，关于远程工具的使用这里就暂时不写了，以后可能会写，连接成功后输入下面的3条命令下载脚本执行。</p><p>下载脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/下载脚本.jpg" alt="下载脚本"></p><p>下载完成后添加可执行权限：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x shadowsocks.sh</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/添加可执行权限.jpg" alt="添加可执行权限"></p><p>执行脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log</span><br></pre></td></tr></table></figure><p>等待一段时间，设置密码，这个密码是客户端连接SS用的，</p><p><img src="https://wsmcb.github.io/img/设置密码.jpg" alt="设置密码"></p><p>设置端口，可以输入一个数字，但不要用80或21或22端口，</p><p><img src="https://wsmcb.github.io/img/设置端口.jpg" alt="设置端口"></p><p>设置加密方式，建议先选择aes-256-cfb，防止无法使用，有的加密方式需要安装相应的软件才能用，直接输入数字选择，不要输入aes-256-cfb,，</p><p><img src="https://wsmcb.github.io/img/设置加密.jpg" alt="设置加密"></p><p>设置完加密方式后，按回车开始安装，</p><p><img src="https://wsmcb.github.io/img/开始安装SS.jpg" alt="开始安装SS"></p><p>安装完成后会显示IP 端口 密码 加密方式，可以记录下来，连接的时候需要用到，</p><p><img src="https://wsmcb.github.io/img/SS安装完成.jpg" alt="SS安装完成"></p><p>到这里基本上服务端就已经部署完成了，接下来就是下载客户端，<a href="https://github.com/shadowsocks/shadowsocks-windows/releases" target="_blank" rel="noopener">点此进入Github下载</a> ，下载完成后打开SS客户端，点击 服务器、打开编辑服务器，</p><p><img src="https://wsmcb.github.io/img/进入服务器编辑.jpg" alt="进入服务器编辑"></p><p>点击添加，把安装完成时显示的信息填入到相应的输入框中，加密方式下拉菜单选择，插件程序、插件选项、插件参数 可以不用管，超时和代理端口不用改，填写完成后确定，</p><p><img src="https://wsmcb.github.io/img/SS客户端填写.jpg" alt="SS客户端填写"></p><p>服务器设置完成后，打开系统代理，把代理模式设置为全局代理，</p><p><img src="https://wsmcb.github.io/img/设置SS代理.jpg" alt="设置SS代理"></p><p>点击PAC 、从 GFWList 更新本地 PAC，</p><p><img src="https://wsmcb.github.io/img/更新PAC.jpg" alt="更新PAC"></p><p>更新完成后 点击 使用本地 PAC，把代理模式设置为PAC 模式，点击 启用系统代理，这样就可以访问被ban的网站了。</p><p>如果按照上面的方法设置了还用不了的话：可能是下面的几种原因之一：</p><ul><li>没有打开端口：解决方法就是打开端口，例如在安装时设置了666端口就需要打开666端口，关于Linux的端口设置这里就暂时不写了，以后可能会写，</li><li>相关信息填写错误：核对信息，确保和安装完成时显示的信息一致，</li><li>服务端没有启动SS服务：启动服务端的SS服务，关于服务端的一些控制下面会有说明，</li><li>设置的加密方式不支持：把加密方式改为 aes-256-cfb，在SS的配置文件可以更改，配置文件的位置下面会有说明，</li></ul><p>下面是SS服务端的一些操作命令：</p><p>启动：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks start</span><br></pre></td></tr></table></figure><p>停止：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks stop</span><br></pre></td></tr></table></figure><p>重启：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks restart</span><br></pre></td></tr></table></figure><p>查看状态：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/shadowsocks status</span><br></pre></td></tr></table></figure><p>如果需要修改SS的端口或密码可以打开SS的配置文件，SS的配置文件在 <strong>/etc/shadowsocks.json</strong> ，配置文件是JSON的，注意！每次修改完SS的配置文件都需要重新启动SS，</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"server_port"</span>:<span class="number">6666</span>,</span><br><span class="line">    <span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"password"</span>:<span class="string">"hello"</span>,</span><br><span class="line">    <span class="attr">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"chacha20"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果要设置多用户的话，端口和密码可以这样写：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"port_password"</span>:&#123;</span><br><span class="line">        <span class="attr">"8989"</span>:<span class="string">"password0"</span>,</span><br><span class="line">        <span class="attr">"9001"</span>:<span class="string">"password1"</span>,</span><br><span class="line">        <span class="attr">"9002"</span>:<span class="string">"password2"</span>,</span><br><span class="line">        <span class="attr">"9003"</span>:<span class="string">"password3"</span>,</span><br><span class="line">        <span class="attr">"9004"</span>:<span class="string">"password4"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"chacha20"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>:<span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主要就是更改一下端口和密码的写法，加密方式还是一样的 可以自己设置。</p><p>如果要在其他平台使用SS可以到这里下载对应的客户端：<a href="http://shadowsocks.org/en/download/clients.html" target="_blank" rel="noopener">http://shadowsocks.org/en/download/clients.html</a> ，使用方法和上面演示的Windows版差不多，填入相应的信息即可使用，如果你的IOS的app store是国区的话，可能无法下载上面网站中的应用，如果嫌切换美区麻烦的话，可以使用下面这款应用，</p><p><img src="https://wsmcb.github.io/img/IOS_SS1.png" alt="IOS商店SS界面"></p><p>这款软件在国区的app store是可以下载的，不过需要8元购买，使用方法和PC版差不多，填入相关信息，或者直接扫描PC上分享的二维码，</p><p><img src="https://wsmcb.github.io/img/IOS_SS2.png" alt="IOS的SS客户端截图"></p><p>Android的话直接在上面的网站下载安装即可。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> VPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CentOS + Aria2搭建离线下载服务器</title>
      <link href="/2018/11/23/CentOS-Aria2%E6%90%AD%E5%BB%BA%E7%A6%BB%E7%BA%BF%E4%B8%8B%E8%BD%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2018/11/23/CentOS-Aria2%E6%90%AD%E5%BB%BA%E7%A6%BB%E7%BA%BF%E4%B8%8B%E8%BD%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>今天是黑色星期五，正好 Bandwagon Host 的一款VPS有打折，180元的售价就可以买到1年 1核 + 512M 内存+ 1T流量 + 20G SSD 而且还是CM2线路的服务器，虽然配置比起双11的缩水了很多，但价格比起vultr的还是要便宜很多，正好我之前买的服务器还有十多天就要到期了，所以下单买了一年的。<br><a id="more"></a></p><p>一个月的价格差不多是15元，如果人民币汇率在高一些的话价格还会更便宜。之前我一直用的下载工具是Transmission，我也写过一篇教程 <a href="http://www.changbin.me/index.php/2018/04/05/%e4%bd%bf%e7%94%a8linux-vps-transmission%e6%90%ad%e5%bb%ba%e7%a6%bb%e7%ba%bf%e4%b8%8b%e8%bd%bd%e6%9c%8d%e5%8a%a1%e5%99%a8/" target="_blank" rel="noopener">使用Linux VPS + Transmission搭建离线下载服务器</a>，Transmission对于下载BT和磁力来说还是比较好用的，但是不能下载普通链接和FTP链接，感觉功能还是少了些，而Aria2除了能下载磁力和种子外还可以下载普通链接和FTP链接，而且Aria2的AriaNg网页面板也要比Transmission好用。</p><p>我这里使用的Linux版本是 CentOS7，首先下载相关文件和脚本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install wget unzip curl</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/helloxz/ccaa/archive/master.zip</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip master.zip &amp;&amp; cd ccaa-master &amp;&amp; sh ccaa.sh</span><br></pre></td></tr></table></figure><p>等待一段时间，当出现如下图的提示时，输入1 回车，选择安装CCAA，</p><p><img src="https://wsmcb.github.io/img/安装CCAA.jpg" alt="安装CCAA"></p><p>按照提示设置下载位置，</p><p><img src="https://wsmcb.github.io/img/设置下载位置.jpg" alt="设置下载位置"></p><p>接着设置RPC密钥，第一次进入的时候需要密钥验证，</p><p><img src="https://wsmcb.github.io/img/设置密钥.jpg" alt="设置密钥"></p><p>接着设置用户名和密码，用于登录Web下载管理，设置完成后等待一段时间，安装完成后会显示进入下载管理的地址和你输入的用户名和密码，</p><p><img src="https://wsmcb.github.io/img/安装完成.jpg" alt="安装完成"></p><p>一般进入下载管理的地址就是 IP + 6080端口号，如果有域名和网站服务器的话可以设置反向代理，通过域名来访问。</p><p>在浏览器地址栏输入地址，然后输入之前设置的用户名和密码进入下载管理，</p><p><img src="https://wsmcb.github.io/img/输入用户名.jpg" alt="输入用户名"></p><p>进入后点击 AriaNg设置、选择RPC 、输入RPC密钥、刷新，</p><p><img src="https://wsmcb.github.io/img/设置RPC密钥.jpg" alt="设置RPC密钥"></p><p>下载文件的方法和大多数下载工具都差不多，点击 新建、输入下载地址、点击 立即下载，</p><p><img src="https://wsmcb.github.io/img/新建下载任务.jpg" alt="新建下载任务"></p><p>下载完成后，点击 文件管理就可以查看下载的文件了，这个文件管理的位置也就是之前设置的下载目录，</p><p><img src="https://wsmcb.github.io/img/文件管理.jpg" alt="文件管理"></p><p><img src="https://wsmcb.github.io/img/查看文件.jpg" alt="查看文件"></p><p>如果要把文件下载到本地的话，操作方法和网盘差不多，选中文件 点击 下载，</p><p><img src="https://wsmcb.github.io/img/下载到本地.jpg" alt="下载到本地"></p><p>如果要下载磁力也是可以的，直接输入磁力链接，</p><p><img src="https://wsmcb.github.io/img/测试磁力.jpg" alt="测试磁力"></p><p>感觉速度还可以，</p><p><img src="https://wsmcb.github.io/img/速度还可以.jpg" alt="速度还可以"></p><p>注意！软件开机并不会自启动，重启需要手动启动，下面是一些操作命令：</p><p>查看CCAA状态：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccaa status</span><br></pre></td></tr></table></figure><p>启动CCAA：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccaa start</span><br></pre></td></tr></table></figure><p>停止CCAA：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccaa stop</span><br></pre></td></tr></table></figure><p>重启CCAA：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccaa restart</span><br></pre></td></tr></table></figure><p>更新BT Tracker：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/ccaa/upbt.sh</span><br></pre></td></tr></table></figure><p>这个BT Tracker相当于BT服务器列表，建议一个月至少更新一次，防止服务器失效，</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@host ~]# /etc/ccaa/upbt.sh</span><br><span class="line">--2018-12-29 01:18:38--  https://api.xiaoz.org/trackerslist/</span><br><span class="line">Resolving api.xiaoz.org (api.xiaoz.org)... 162.220.14.19</span><br><span class="line">Connecting to api.xiaoz.org (api.xiaoz.org)|162.220.14.19|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: unspecified [text/html]</span><br><span class="line">Saving to: ‘/tmp/trackers_best.txt’</span><br><span class="line"></span><br><span class="line">    [ &lt;=&gt;                                                                           ] 789         --.-K/s   in 0s      </span><br><span class="line"></span><br><span class="line">2018-12-29 01:18:39 (54.5 MB/s) - ‘/tmp/trackers_best.txt’ saved [789]</span><br><span class="line"></span><br><span class="line">-------------------------------------</span><br><span class="line">bt-tracker update completed.</span><br><span class="line">-------------------------------------</span><br></pre></td></tr></table></figure><p>如果输入<strong>IP:6080</strong> 无法进入下载管理的话，请检查是否打开了<strong>6080端口</strong> 和 <strong>6800端口</strong>。</p><p>以上就是在 CentOS 安装 Aria2的最简单方法，更多的Aria2设置可以自己调整。这里也要感谢一下写shell脚本的大佬，因为有他们的脚本，我们才能更方便的安装和配置软件，当然也要感谢软件的开发者。</p><p><a href="hppt://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 下载 </tag>
            
            <tag> VPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在namesilo购买域名</title>
      <link href="/2018/11/17/%E5%9C%A8namesilo%E8%B4%AD%E4%B9%B0%E5%9F%9F%E5%90%8D/"/>
      <url>/2018/11/17/%E5%9C%A8namesilo%E8%B4%AD%E4%B9%B0%E5%9F%9F%E5%90%8D/</url>
      
        <content type="html"><![CDATA[<p>最近我的博客域名就要到期了，因为之前使用的域名比较长，所以这次准备换一个域名，因为在国内购买域名还需要实名认证，比较麻烦，所以我准备在国外代理商购买。目前国外最大的域名提供商应该就是GoDaddy了，不过 我看了一下GoDaddy的价格发现第一年的价格虽然比较便宜，但是续费的价格还是比较高的，而且GoDaddy如果需要隐藏whois信息的话还需要加60元。看了一下其他代理商发现namesilo的评价还不错，价格也不是太贵，而且namesilo隐藏whois信息是免费的，namesilo也是经过ICANN认证的域名提供商，所以也不用担心会突然跑路之类的。<br><a id="more"></a><br>下面就简单的写一下购买和设置的过程。</p><p>namesilo的地址是 <a href="https://www.namesilo.com/" target="_blank" rel="noopener">https://www.namesilo.com</a> ，网站如下：</p><p><img src="https://wsmcb.github.io/img/namesilo主页.jpg" alt="namesilo主页"></p><p>首先需要注册一个账号，点击 <a href="https://www.namesilo.com/create_account.php" target="_blank" rel="noopener">Create New Account</a> 注册，只需要按照提示填写相应的信息即可，传真号可以不用填，地址如果是国内的话建议用拼音，填写完成后选中同意条款，然后点击 <strong>CREATE MY NEW ACCOUNT</strong> 按钮注册，</p><p><img src="https://wsmcb.github.io/img/namesilo注册.jpg" alt="namesilo注册"></p><p>提交后验证一下邮箱地址就注册完成了，然后就可以搜索域名了，</p><p><img src="https://wsmcb.github.io/img/namesilo搜索域名.jpg" alt="namesilo搜索域名"></p><p><img src="https://wsmcb.github.io/img/namesilo搜索域名2.jpg" alt="namesilo搜索域名2"></p><p>如果发现没有想要的后缀的话可以点击 <strong>See Many More</strong> 勾选更多后缀，可选的后缀还是比较全的，不过有些后缀只能在所属国家使用，就比如cn就只能在中国使用，而且还需要备案，jp就只能在日本使用。</p><p><img src="https://wsmcb.github.io/img/namesilo更多域名.jpg" alt="namesilo更多域名"></p><p>选择完成后点击 <strong>REGISTER CHECKED DOMAINS</strong> 进入购物车，</p><p><img src="https://wsmcb.github.io/img/namesilo购物车.jpg" alt="namesilo购物车"></p><p>设置可以使用默认设置，后期可以更改，使用优惠码 <strong>silooneoff</strong> 或 <strong>onesaving</strong> 可优惠1美元，确认无误后可点击 <strong>CONTINUE</strong> 继续付款，付款支持支付宝，</p><p><img src="https://wsmcb.github.io/img/namesilo选择付款.jpg" alt="namesilo选择付款"></p><p>选中支付宝，输入支付宝绑定的邮箱地址，点击 <strong>Go</strong> 跳转到支付宝付款页付款，购买完成后会跳转到账户首页，点击 <strong>Domain Manager</strong> 进入域名管理，</p><p><img src="https://wsmcb.github.io/img/namesilo进入域名管理.jpg" alt="namesilo进入域名管理"></p><p>点击管理DNS</p><p><img src="https://wsmcb.github.io/img/namesilo设置DNS.jpg" alt="namesilo设置DNS"></p><p>默认有几条记录，可以删除，我这里使用的是A记录，点击 <strong>A</strong> 创建一条A记录，</p><p><img src="https://wsmcb.github.io/img/namesilo创建A记录.jpg" alt="namesilo创建A记录"></p><p>HOSTNAME 可以留空，也可以填www，IPV4 ADDRESS 填写服务器IP，TTL 改为3600，设置完成后点击提交，</p><p><img src="https://wsmcb.github.io/img/namesilo设置A记录1.jpg" alt="namesilo设置A记录1"></p><p>我的方案是创建两条A记录，一条的HOSTNAME留空，一条的HOSTNAME填www，这样的话无论加不加www都能解析到我的服务器。</p><p>以上就是我在namesilo购买域名的过程，当然 还有很多namesilo的设置这里还没有写到，不过那些并不重要，如果需要续费或转出的话在写。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 域名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP PDO简单使用教程</title>
      <link href="/2018/10/24/PHP-PDO%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2018/10/24/PHP-PDO%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>PDO是PHP中用来访问数据库的一个轻量型的接口，相比起Mysqlli来说，PDO可支持更多种的数据库，而Mysqli只支持Mysql。通过PDO可实现使用同样的方法来访问不同的数据库，如果您建站初期使用的是Mysql，但后期需要更换数据库的话，只需要修改一些配置信息，不用修改类和方法就可以实现更换数据库。<br><a id="more"></a><br>连接数据库</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> DATABASE_TYPE = <span class="string">'mysql'</span>;  <span class="comment">//  数据库类型</span></span><br><span class="line"><span class="keyword">const</span> DATABASE_SERVER = <span class="string">'127.0.0.1'</span>;  <span class="comment">//  服务器地址</span></span><br><span class="line"><span class="keyword">const</span> DATABASE_NAME = <span class="string">'bbs'</span>;  <span class="comment">//  要连接的数据库名称</span></span><br><span class="line"><span class="keyword">const</span> USER_NAME = <span class="string">'root'</span>;  <span class="comment">//  数据库用户名</span></span><br><span class="line"><span class="keyword">const</span> PASSWORD = <span class="string">'root'</span>;  <span class="comment">//  数据库密码</span></span><br><span class="line"><span class="keyword">const</span> DSN = DATABASE_TYPE . <span class="string">':host='</span> . DATABASE_SERVER . <span class="string">';dbname='</span> . DATABASE_NAME;  <span class="comment">//  数据源</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    $pdo = <span class="keyword">new</span> PDO(DSN, USER_NAME,PASSWORD);  <span class="comment">//  创建PDO对象</span></span><br><span class="line">&#125;<span class="keyword">catch</span> (PDOexception $e) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $e-&gt;getMessage();  <span class="comment">//  输出异常信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的 DSN常量是一个包含了数据库种类、数据库主机名、数据库名称 的字符串，下面是不使用拼接的写法：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DSN = <span class="string">'mysql:host=127.0.0.1;dbname=bbs'</span>;</span><br></pre></td></tr></table></figure><p>除了上面的写法外，也还有其他的写法，在PHP的官网教程中有说明，不过感觉这种写法用的要多一些。</p><p><strong>PDO() 对象</strong> PDO是操作数据库必须的一个对象，它包含了一系列的操作数据库的方法，下面是参数说明：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>dsn</td><td>string</td><td>包含了 数据库种类、数据库主机名、数据库名称的数据源</td></tr><tr><td>userName</td><td>string</td><td>数据库用户名</td></tr><tr><td>password</td><td>string</td><td>数据库密码</td></tr></tbody></table><p>插入数据</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="string">"INSERT INTO user (userName, password) VALUES ('Charlie', '123456')"</span>;  <span class="comment">//  SQL语句</span></span><br><span class="line">$result = $pdo-&gt;exec($sql);  <span class="comment">//  执行插入</span></span><br><span class="line"><span class="keyword">echo</span> $result;  <span class="comment">//  输出受影响的行数</span></span><br></pre></td></tr></table></figure><p><strong>exec() 方法</strong> exec执行SQL语句，返回受影响的行数。</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>sql</td><td>string</td><td>要执行的SQL语句</td></tr></tbody></table><p>exec方法 还可以用于修改和删除数据，代码如下：</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  把Charlie的密码修改为000000</span></span><br><span class="line">$sql = <span class="string">"UPDATE user SET password = '000000' WHERE userName = 'Charlie'"</span>;  <span class="comment">//  SQL语句</span></span><br><span class="line">$result = $pdo-&gt;exec($sql);  <span class="comment">//  执行修改</span></span><br><span class="line"><span class="keyword">echo</span> $result;  <span class="comment">//  输出受影响的行数</span></span><br></pre></td></tr></table></figure><p>删除和修改都差不多，只是SQL语句不一样，这里就不写了。</p><p>下面是查询的PHP代码：</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  查询出user表的所有数据</span></span><br><span class="line">$sql = <span class="string">"SELECT * FROM user"</span>;  <span class="comment">//  SQL语句</span></span><br><span class="line">$data = $pdo-&gt;query($sql);  <span class="comment">//  执行查询语句</span></span><br><span class="line"><span class="keyword">if</span> ($data-&gt;rowCount() &gt; <span class="number">0</span>) &#123;  <span class="comment">//  判断查询到的行数是否大于0</span></span><br><span class="line">    $dataArr = $data-&gt;fetchAll();  <span class="comment">//  把所有查询到的数据转换为数组</span></span><br><span class="line">    print_r($dataArr);  <span class="comment">//  输出数组</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'未能查询到数据！'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>查询到的数据：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [id] =&gt; <span class="number">1</span></span><br><span class="line">            [<span class="number">0</span>] =&gt; <span class="number">1</span></span><br><span class="line">            [userName] =&gt; John</span><br><span class="line">            [<span class="number">1</span>] =&gt; John</span><br><span class="line">            [password] =&gt; <span class="number">123456</span></span><br><span class="line">            [<span class="number">2</span>] =&gt; <span class="number">123456</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [id] =&gt; <span class="number">2</span></span><br><span class="line">            [<span class="number">0</span>] =&gt; <span class="number">2</span></span><br><span class="line">            [userName] =&gt; George</span><br><span class="line">            [<span class="number">1</span>] =&gt; George</span><br><span class="line">            [password] =&gt; <span class="number">123456</span></span><br><span class="line">            [<span class="number">2</span>] =&gt; <span class="number">123456</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="keyword">Array</span></span><br><span class="line">        (</span><br><span class="line">            [id] =&gt; <span class="number">3</span></span><br><span class="line">            [<span class="number">0</span>] =&gt; <span class="number">3</span></span><br><span class="line">            [userName] =&gt; Charlie</span><br><span class="line">            [<span class="number">1</span>] =&gt; Charlie</span><br><span class="line">            [password] =&gt; <span class="number">000000</span></span><br><span class="line">            [<span class="number">2</span>] =&gt; <span class="number">000000</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>user表：</p><p><img src="https://wsmcb.github.io/img/user表内容.jpg" alt="user表内容"></p><p><strong>query() 方法</strong> query执行SQL语句，返回PDOStatement对象，可以理解为结果集。下面是query的参数：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>sql</td><td>string</td><td>要执行的SQL语句</td></tr></tbody></table><p>PDOStatement对象中又有一些方法：</p><p><strong>rowCount() 方法</strong> 获取返回的行数，这个方法在一些数据库可能用不了，但在Mysql可以用。</p><p><strong>fetchAll() 方法</strong> 返回一个包含结果集中所有行的数组，也就是把查询到的所有行转换为数组。</p><p><strong>fetch() 方法</strong> 从结果集中获取下一行，如果只查询一行数据的话，就比较适合用这个方法。</p><p>下面是通过 fetch方法 获取数据：</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  查询出user表的所有数据</span></span><br><span class="line">$sql = <span class="string">"SELECT * FROM user"</span>;  <span class="comment">//  SQL语句</span></span><br><span class="line">$data = $pdo-&gt;query($sql);  <span class="comment">//  执行查询语句</span></span><br><span class="line"></span><br><span class="line">$dataArr = $data-&gt;fetch();  <span class="comment">//  获取一行</span></span><br><span class="line">print_r($dataArr);  <span class="comment">//  输出数组</span></span><br></pre></td></tr></table></figure><p>查询结果：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Array</span></span><br><span class="line">(</span><br><span class="line">    [id] =&gt; <span class="number">1</span></span><br><span class="line">    [<span class="number">0</span>] =&gt; <span class="number">1</span></span><br><span class="line">    [userName] =&gt; John</span><br><span class="line">    [<span class="number">1</span>] =&gt; John</span><br><span class="line">    [password] =&gt; <span class="number">123456</span></span><br><span class="line">    [<span class="number">2</span>] =&gt; <span class="number">123456</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>通过 fetch方法 无论查询到多少行都只会获取一行。</p><p>以上就是PHP PDO的简单使用方法，这里只是写了简单的 增、删、改、查，如果要查看所有方法可以到PHP官网。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
            <tag> 数据库 </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于Linux的软链接和硬链接</title>
      <link href="/2018/09/28/%E5%85%B3%E4%BA%8ELinux%E7%9A%84%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%92%8C%E7%A1%AC%E9%93%BE%E6%8E%A5/"/>
      <url>/2018/09/28/%E5%85%B3%E4%BA%8ELinux%E7%9A%84%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%92%8C%E7%A1%AC%E9%93%BE%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<p>在使用Windows安装软件的时候，安装程序一般都会在桌面创建一个快捷方式，方便使用，而在Linux上也有一种类似于Windows快捷方式的文件类型，这就是软链接。虽然大多数Linux服务器都没有桌面，但是对于一些经常需要查看或修改的目录层级比较升的配置文件或日志文件来说，建立一个软链接，放在常用的文件夹，找起来也会比较方便。<br><a id="more"></a><br>下面是创建软链接的方法</p><p><strong>ln -s</strong> 命令可以创建一个软链接，使用方法为 ln -s 指向的文件名 软链接的名称，</p><p>例如我要给home/index.php创建一个软链接，</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /home/index.php /home/首页</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/创建软链接.jpg" alt="创建软链接"></p><p>查看文件信息，</p><p><img src="https://wsmcb.github.io/img/查看软链接.jpg" alt="查看文件信息"></p><p>在上图中可以看到 首页文件是指向 index.php，所以如果删除了index.php 创建的首页软链接就不能用了，当打开 首页文件时，其实打开的也就是 index.php，也就是说 当打开软链接时，其实打开的就是软链接指向的原文件，删除软链接不会影响原文件。</p><p>删除原文件后，</p><p><img src="https://wsmcb.github.io/img/删除原文件后.jpg" alt="删除原文件后"></p><p>如果现在在创建一个名为 index.php 的文件，首页 软链接又可以恢复使用了，所以即使是指向的原文件不存在也是可以创建软链接的。</p><p>除了软链接外，在Linux中还有一种名为硬链接的文件类型，当给一个文件创建硬链接时，Linux会复制一个与源文件的inode编号相同的文件，当修改硬链接文件内容时，源文件的内容也会改变，类似于我们平时使用的云同步，当修改本地文件时，云端的文件内容也会改变。不过Linux上如果删除了硬链接源文件并不会一起被删除，而且删除了源文件硬链接文件也可以继续使用，但硬链接需要原文件存在才能创建，不可以为不存在的文件创建硬链接，也不能为目录创建硬链接。</p><p>下面是创建硬链接的方法</p><p><strong>ln 或 link</strong> 都可以创建，格式为 link 要指向的文件名 硬链接名称，ln也是一样的。</p><p>这里还是给 /home/index.php 创建硬链接，</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">link /home/index.php /home/首页</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/创建硬链接.jpg" alt="创建硬链接"></p><p>使用 <strong>ls -l -i</strong> 可以显示inode编号，</p><p><img src="https://wsmcb.github.io/img/查看inode.jpg" alt="查看inode"></p><p>从上图中可以看到 除了文件名不同，index.php 和 首页 都是一样的，这两个文件的inode节点数量都是2，如果在给其中一个文件创建一个硬链接inode节点数量就会变为3，如果修改了其中一个文件的内容，inode编号相同的文件的内容也会改变，如果删除了一个文件，inode相同的文件也不会受到影响。软链接和硬链接比较不同的地方就是，软链接只是一个保存了源文件位置的文件，只要没有了源文件，软链接也不能打开。而硬链接是一个完整的文件，和源文件之间相互关联又相互独立，即使删除了源文件，关联的硬链接文件也可以继续使用。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Linux VPS + 宝塔Linux面板快速搭建网站</title>
      <link href="/2018/09/11/%E4%BD%BF%E7%94%A8Linux-VPS-%E5%AE%9D%E5%A1%94Linux%E9%9D%A2%E6%9D%BF%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E7%BD%91%E7%AB%99/"/>
      <url>/2018/09/11/%E4%BD%BF%E7%94%A8Linux-VPS-%E5%AE%9D%E5%A1%94Linux%E9%9D%A2%E6%9D%BF%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<p>对于刚学网站开发的初学者来说，最简单的建站方法应该就是使用虚拟主机了，购买以后直接自动配置好网站运行环境，只需要用FTP工具上传网页就可以直接访问了，我刚学编程的时候也是用这种方法。虚拟主机虽然方便，但可设置的选项也比较少，而且有的便宜的虚拟主机还不支持多站点和多数据库，网站数据库只能放在默认的一个数据库中，也不能设置数据库。而使用VPS服务器搭建网站就可以解决以上说的这些问题，不过在Linux上搭建网站也不是一件容易的事情，就连在windows配置PHP运行环境都不容易，这时候就需要用到Web的Linux管理面板了，这里就写一下宝塔Linux管理面板搭建网站的方法。<br><a id="more"></a><br>用国外的VPS搭建网站价格是真的便宜，而且还能干其他事情，下面是国内虚拟主机和国外VPS的价格对比图。</p><p><img src="https://wsmcb.github.io/img/虚拟主机截图.jpg" alt="虚拟主机截图"></p><p>VPS</p><p><img src="http://wsmcb.github.io/img/VPS截图.jpg" alt="VPS截图"></p><p>下面说搭建方法</p><p>使用Linux远程控制工具连接VPS服务器，这里推荐Xshell 5，个人家庭使用免费，而且有中文，连接完成后进入宝塔面板的官网 <a href="https://www.bt.cn/" target="_blank" rel="noopener">https://www.bt.cn/</a>，选择Linux免费版，</p><p><img src="https://wsmcb.github.io/img/宝塔官网.jpg" alt="宝塔官网"></p><p>根据Linux的版本选择脚本地址粘贴，我用的是CentOS，所以我选择CentOS的：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y wget &amp;&amp; wget -O install.sh http://download.bt.cn/install/install.sh &amp;&amp; sh install.sh</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/安装宝塔P1.jpg" alt="安装"></p><p>粘贴完成后回车，等待一段时间会询问是否确认安装，直接输入y 回车，</p><p><img src="https://wsmcb.github.io/img/安装宝塔P2.jpg" alt="询问是否安装"></p><p>在等待一段时间，安装完成后会显示面板的登录地址 用户名 密码，</p><p><img src="https://wsmcb.github.io/img/宝塔安装完成.jpg" alt="宝塔安装完成"></p><p>在浏览器中输入地址，默认为IP + 端口号，进入宝塔面板登录界面，输入账号和密码登录，新版本的还需要加一些参数，直接复制地址到浏览器粘贴登录，</p><p><img src="https://wsmcb.github.io/img/宝塔登录.jpg" alt="宝塔登录"></p><p>登录完成后会弹出运行环境的安装弹框，选择服务器和PHP版本安装，</p><p><img src="https://wsmcb.github.io/img/宝塔安装PHP.jpg" alt="选择安装环境"></p><p>如果有时间的话建议选择编译安装，安装时间在30分钟以上，在安装的时候可以关闭面板 做其他的事情，不用一直等着，安装完成后建议先更改一下面板的设置，</p><p><img src="https://wsmcb.github.io/img/宝塔设置P1.jpg" alt="宝塔设置"></p><p>可以直接给面板绑定一个二级域名，防止其他人用域名 + 端口号登录，还有默认的账号和密码是自动生成的，建议更改，</p><p><img src="https://wsmcb.github.io/img/宝塔设置P2.jpg" alt="宝塔设置"></p><p>接着就可以建立站点了，点击侧边栏的网站，进入站点管理页，点击添加站点，根据提示输入域名，数据库可以不用创建，后期自己创建，FTP根据情况选择，然后选择一个已安装的PHP版本，点击提交来创建站点，</p><p><img src="https://wsmcb.github.io/img/宝塔建立网站.jpg" alt="宝塔建立网站"></p><p>宝塔面板自带一个Web版的文件管理，站点创建完成后 点击侧边栏的文件，找到以下路径：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/www/wwwroot</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/宝塔文件.jpg" alt="宝塔文件"></p><p>在这里有一个和域名相同的目录，这就是网站目录，进入网站目录后会有几个自动生成的HTML文件，可以直接删除，然后点击上传或使用FTP工具来上传网页，上传完成后如果不出意外的话，输入域名或IP就可以访问网站了，如果要管理数据库的话，点击侧边栏的数据库，默认的Mysql是没有密码的，可以设置一个密码，</p><p><img src="https://wsmcb.github.io/img/宝塔mysql.jpg" alt="宝塔mysql"></p><p>宝塔面板自带一个phpmyadmin，可以使用phpmyadmin自己创建数据库，这样一个网站就已经创建完成了。</p><p>以上就是使用宝塔Linux面板快速建站的方法，我上面只是写了简单创建的方法，还有很多设置项还没有配置。</p><p>下面是宝塔面板的一些命令：</p><p>停止：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/bt stop</span><br></pre></td></tr></table></figure><p>启动：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/bt start</span><br></pre></td></tr></table></figure><p>重启：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/bt restart</span><br></pre></td></tr></table></figure><p>卸载：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/bt stop &amp;&amp; chkconfig --del bt &amp;&amp; rm -f /etc/init.d/bt &amp;&amp; rm -rf /www/server/panel</span><br></pre></td></tr></table></figure><p>查看当前面板端口：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/server/panel/data/port.pl</span><br></pre></td></tr></table></figure><p>查看宝塔日志：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /tmp/panelBoot.pl</span><br></pre></td></tr></table></figure><p>查看软件安装日志：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /tmp/panelExec.log</span><br></pre></td></tr></table></figure><p>站点配置文件位置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/www/server/panel/vhost</span><br></pre></td></tr></table></figure><p>清理登陆限制：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/server/panel/data/limitip.conf</span><br></pre></td></tr></table></figure><p>查看面板授权IP：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/server/panel/data/limitip.conf</span><br></pre></td></tr></table></figure><p>关闭访问限制：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -f /www/server/panel/data/limitip.conf</span><br></pre></td></tr></table></figure><p>查看许可域名：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/server/panel/data/domain.conf</span><br></pre></td></tr></table></figure><p>更详细的命令可以访问：<a href="https://www.bt.cn/btcode.html" target="_blank" rel="noopener">https://www.bt.cn/btcode.html</a> 。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> VPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>启用Win10的Linux子系统</title>
      <link href="/2018/08/30/%E5%90%AF%E7%94%A8Win10%E7%9A%84Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/"/>
      <url>/2018/08/30/%E5%90%AF%E7%94%A8Win10%E7%9A%84Linux%E5%AD%90%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>对于使用windows的用户来说，学习Linux最方便的方法就是安装虚拟机，然后在虚拟机里安装Linux，毕竟要在同一台电脑上安装windows和Linux还是有一定难度的，但即使是在虚拟机里安装Linux也有一堆的参数需要设置，对于不太了解的人来说，还是比较繁琐的。不过在Win10系统里内置了一个Linux的子系统，只需要通过几步简单的设置就可以开启，这里就来记录一下我开启的过程。<br><a id="more"></a><br>打开设置，找到 更新和安全，找到 开发者选项，打开 开发人员模式，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP1.jpg" alt="开发者选项"></p><p>打开控制面板，找到 卸载程序，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP2.jpg" alt="控制面板"></p><p>点击 启用或关闭 Windows 功能，勾选 适用于 Linux 的 Windows 子系统，选择完成后 确定，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP3.jpg" alt="卸载程序"></p><p>等待一段时间，然后 重启，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP4.jpg" alt="启用Linux"></p><p>重启后打开命令行，输入 lxrun /install /y 安装Linux，</p><p><img src="https://wsmcb.github.io/img/win10Linux5.jpg" alt="安装Linux"></p><p>等待一段时间，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP6.jpg" alt="正在安装Linux"></p><p>安装完成后，在命令行输入 bash 进入Ubuntu，进入以后就可以使用了，默认root用户，没有密码，如果需要的话也可以设置，</p><p><img src="https://wsmcb.github.io/img/win10LinuxP7.jpg" alt="Linux界面"></p><p><img src="https://wsmcb.github.io/img/win10LinuxP8.jpg" alt="Linux界面"></p><p>以上就是在Win10启用Linux的方法，后续可能会有补充。</p><hr><p>2019年2月12日更新</p><p>如果输入 <strong>lxrun /install /y</strong> 不能安装的话可以打开应用商店，搜索 <strong>wsl</strong> 会搜索到几个可选的Linux系统，选择一个，</p><p><img src="https://wsmcb.github.io/img/wsl1.jpg" alt="搜索wsl"></p><p>然后和平时安装应用一样的安装，</p><p><img src="https://wsmcb.github.io/img/wsl2.jpg" alt="安装wsl"></p><p>安装完成后在开始菜单可以找到，</p><p><img src="https://wsmcb.github.io/img/wsl3.jpg" alt="开始菜单"></p><p>有其他的以后在更新。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> Win10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML5 Notification桌面通知</title>
      <link href="/2018/07/28/HTML5-Notification%E6%A1%8C%E9%9D%A2%E9%80%9A%E7%9F%A5/"/>
      <url>/2018/07/28/HTML5-Notification%E6%A1%8C%E9%9D%A2%E9%80%9A%E7%9F%A5/</url>
      
        <content type="html"><![CDATA[<p>通知是很多网站中比较重要的一个功能，无论是邮箱还是在线Web聊天程序，又或是论坛 留言板等都会用到通知功能。网页和APP不同，APP可以直接在通知栏或任务栏显示通知，而网页是运行在浏览器中的，所以只能在页面上显示通知，网页常见的通知方式有 弹窗 变换网页标题 或者直接显示未读消息数量等，这些通知有时候可能不会被用户注意到。<br><a id="more"></a><br>HTML5中加入的Notification通知可以解决用户注意不到通知的问题，Notification通知在浏览器最小化或浏览其它网页时也能显示通知，虽然还不能脱离浏览器显示，但比起自定义网页弹窗来说体验要更好，例如QQ邮箱在收到新邮件时只有网页标题会改变，只有随时注意着网页标题或收件箱才能及时看到邮件，而Gmail邮箱在收到新邮件时就会显示Notification通知，而且还有提示音，只要浏览器不关闭就可以显示通知。</p><p>下面是Notification的简单使用方法</p><p>要显示Notification通知需要获得用户的授权，当用户允许后，同站点下的网页都可以显示通知。</p><p>首先需要判断浏览器是否允许显示通知，</p><p><strong>Notification.permission属性</strong></p><p>Notification.permission属性可以获取浏览器是否允许通知，可能返回的值如下：</p><table><thead><tr><th>返回值</th><th>含义</th></tr></thead><tbody><tr><td>default</td><td>默认 不知道用户的选择</td></tr><tr><td>granted</td><td>用户允许显示通知</td></tr><tr><td>denied</td><td>用户不允许显示通知</td></tr></tbody></table><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  判断是否允许显示通知</span></span><br><span class="line"><span class="keyword">if</span> (Notification.permission == <span class="string">"default"</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'用户还未选择过'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (Notification.permission == <span class="string">"granted"</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'用户允许通知'</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'用户不允许通知'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果用户不允许显示通知的话就不能请求通知权限了，只能引导用户在设置中允许通知。</p><p>如果用户还未选择过的话就可以请求通知权限了，一般浏览器默认都是未选择的，不过Google Chrome只能是启用了HTTPS的网站才能显示通知，所以下面的示范都是在Edge浏览器下进行的。</p><p><strong>Notification.requestPermission() 方法</strong></p><p>Notification.requestPermission()方法可以请求通知权限，如果用户已经允许通知的话就不用请求了。</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  请求通知权限</span></span><br><span class="line">Notification.requestPermission().then(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (result == <span class="string">"granted"</span>) &#123;  <span class="comment">//  是否同意显示通知</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'允许通知'</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (result == <span class="string">"default"</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户未选择'</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'用户不允许通知'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/浏览器通知询问.jpg" alt="浏览器通知询问"></p><p>返回值可以参考上面的表格，</p><p>成功获取通知权限后就可以显示通知了。</p><p><strong>new Notification(title, options) 构造方法</strong></p><p>new Notification() 的构造方法可以显示通知，需要传入两个参数，参数说明如下：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>title</td><td>String</td><td>通知的标题</td></tr><tr><td>options</td><td>Json</td><td>通知的配置信息</td></tr></tbody></table><p>下面是配置信息说明：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>dir</td><td>String</td><td>文字的方向；它的值可以是：auto 自动、ltr 从左到右、rtl 从右到左</td></tr><tr><td>lang</td><td>String</td><td>通知使用的语言，一般可省略</td></tr><tr><td>body</td><td>String</td><td>通知内容</td></tr><tr><td>tag</td><td>String</td><td>赋予通知一个ID，以便在必要的时候对通知进行刷新、替换或移除</td></tr><tr><td>icon</td><td>String</td><td>一个图片的URL，将被用于显示通知的图标</td></tr><tr><td>silent</td><td>boolean</td><td>通知提示音，默认为 false</td></tr><tr><td>sound</td><td>String</td><td>通知提示音地址，因为提示音是在线加载的，所以文件不要太大</td></tr></tbody></table><p>上面的配置信息很多都可以省略，下面是简单的代码演示</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> N = <span class="keyword">new</span> Notification(<span class="string">'用户通知'</span>, &#123;</span><br><span class="line">    <span class="string">"body"</span>: <span class="string">"您的会员到期了，赶快充值吧"</span>,</span><br><span class="line">    <span class="string">"tag"</span>: <span class="string">"n1"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/浏览器通知.jpg" alt="浏览器通知"></p><p>上面的通知只包含 标题 内容和ID，</p><p>Notification还有一些方法和事件，这些方法只能在 new Notification 后才能用，</p><p><strong>Notification.onclick 事件</strong></p><p>通知被点击，</p><p>代码演示</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  显示通知</span></span><br><span class="line"><span class="keyword">var</span> N = <span class="keyword">new</span> Notification(<span class="string">'用户通知'</span>, &#123;</span><br><span class="line">    <span class="string">"body"</span>: <span class="string">"您的会员到期了，赶快充值吧"</span>,</span><br><span class="line">    <span class="string">"tag"</span>: <span class="string">"n1"</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  通知被点击</span></span><br><span class="line">N.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    location.href = <span class="string">'http://www.machangbin.com'</span>;  <span class="comment">//  跳转</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Notification.close() 方法</strong></p><p>Notification.close() 方法可以关闭通知，不过一般通知显示一段时间后也会自动关闭，</p><p>代码演示</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  显示通知</span></span><br><span class="line"><span class="keyword">var</span> N = <span class="keyword">new</span> Notification(<span class="string">'用户通知'</span>, &#123;</span><br><span class="line">    <span class="string">"body"</span>: <span class="string">"您的会员到期了，赶快充值吧"</span>,</span><br><span class="line">    <span class="string">"tag"</span>: <span class="string">"n1"</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  3秒后关闭通知</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    N.close();  <span class="comment">//  关闭通知</span></span><br><span class="line">&#125;, <span class="number">3000</span>);</span><br></pre></td></tr></table></figure><p><strong>Notification.onerror 事件</strong></p><p>Notification.onerror 方法在通知遇到异常时触发，使用这个事件可以在Notification通知遇到异常时启用其它备用通知。</p><p>以上就是Notification通知的简单使用方法，目前我测试了Microsoft Edge 可以正常显示，Google Chrome只能在HTTPS的网站显示，IE12不能显示，手机浏览器我测试了微信的浏览器和小米自带的浏览器都不能显示，所以如果要使用Notification通知的话，建议在准备一套备用通知方案，在不支持Notification的浏览器或者通知遇到异常时可以使用备用方案。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用AJAX + FormData上传文件</title>
      <link href="/2018/07/25/%E4%BD%BF%E7%94%A8AJAX-FormData%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/"/>
      <url>/2018/07/25/%E4%BD%BF%E7%94%A8AJAX-FormData%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>FormData是HTML5中新增的一个API，FormData可以把数据封装成类似HTML表单的包含 key和value 的数据，主要用于AJAX提交，有了FormData在使用AJAX提交数据的时候就没必要使用类似拼接URL的方式来拼接数据了。FormData除了能封装字符串外也能封装文件，使用FormData配合AJAX可实现无刷新上传文件，在配上进度条可以极大的提升用户体验。这里就来简单的写一下使用FormData + AJAX上传文件。<br><a id="more"></a><br>HTML代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"file"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">progress</span> <span class="attr">max</span>=<span class="string">"100"</span> <span class="attr">value</span>=<span class="string">"0"</span> <span class="attr">id</span>=<span class="string">"progress"</span>&gt;</span><span class="tag">&lt;/<span class="name">progress</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"uploadBtn"</span>&gt;</span>开始上传<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>上面包含一个文件选择控件，一个进度条控件和一个按钮，这个进度条控件是HTML5中新加入的，在不同浏览器下显示的外观也可能会不一样，如果要在所有浏览器下都显示一样的话，可以通过其他HTML标签嵌套并更改长度的方式来模拟进度条，不过在无障碍支持方面可能不太好。</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fileBox = <span class="built_in">document</span>.querySelector(<span class="string">'#file'</span>);  <span class="comment">//  获取文件选择控件</span></span><br><span class="line"><span class="keyword">var</span> uploadBtn = <span class="built_in">document</span>.querySelector(<span class="string">'#upload-btn'</span>);  <span class="comment">//  获取上传按钮</span></span><br><span class="line"><span class="keyword">var</span> progress = <span class="built_in">document</span>.querySelector(<span class="string">'#progress'</span>);  <span class="comment">//  获取进度条</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  上传按钮点击</span></span><br><span class="line">uploadBtn.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  验证一下文件名是否为空</span></span><br><span class="line">    <span class="keyword">if</span> (fileBox.value == <span class="string">''</span>) &#123;</span><br><span class="line">        alert(<span class="string">'请选择文件'</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  新建FormData对象</span></span><br><span class="line">    <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    <span class="comment">//  给FormData添加一个键值对，传入key和文件</span></span><br><span class="line">    formData.append(<span class="string">'file'</span>, fileBox.files[<span class="number">0</span>]);</span><br><span class="line">    <span class="comment">// 新建XMLHttpRequest对象</span></span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    <span class="comment">//  设置提交方式 url 是否异步</span></span><br><span class="line">    xhr.open(<span class="string">'post'</span>, <span class="string">'server.php'</span>, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//  设置请求头</span></span><br><span class="line">    xhr.setRequestHeader(<span class="string">'X-Request-With'</span>, <span class="string">'XMLHttpRequest'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  此方法在上传进度改变时触发</span></span><br><span class="line">    xhr.upload.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//  是否包含进度数据</span></span><br><span class="line">        <span class="keyword">if</span> (event.lengthComputable) &#123;</span><br><span class="line">            <span class="comment">//  根据已上传文件的大小和总大小计算出百分比</span></span><br><span class="line">            <span class="keyword">var</span> complete = <span class="built_in">Math</span>.floor(event.loaded / event.total * <span class="number">100</span>);</span><br><span class="line">            <span class="comment">//  把百分比传给进度条</span></span><br><span class="line">            progress.value = complete;</span><br><span class="line">            <span class="comment">//  把百分比传给进度条</span></span><br><span class="line">            progress.innerHTML = complete;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  提交数据，传入已封装的FormData</span></span><br><span class="line">    xhr.send(formData);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  此方法在成功提交并接收到数据的时候触发</span></span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//  验证一下是否全部接收完成</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="comment">//  在控制台输出接收到的数据</span></span><br><span class="line">            <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的代码包含注释，所以可能会有些长，实际上很简单，几行代码就能完成。</p><p>下面是一些用到的对象和方法：</p><p><strong>FormData(form) 对象</strong> 建立FormData对象，可以传入HTML的form表单，也可以为空。</p><p><strong>append(key, value) 方法</strong> 给FormData添加一个键值对，需要传入key和value，类似表单的name和value，值可以传入字符串和文件。</p><p>下面是XMLHttpRequest的上传进度方法，有关XMLHttpRequest对象的使用可以看<a href="http://www.changbin.me/index.php/2018/04/17/ajax%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" target="_blank" rel="noopener">AJAX简单使用教程</a> 。</p><p><strong>upload.onprogress事件</strong> 此事件只会在上传时触发，如果要监听上传进度需要传入event。</p><p><strong>event.loaded属性</strong> 已上传文件的字节数。</p><p><strong>event.total属性</strong> 文件的总大小 字节。</p><p>根据event.loaded已上传文件的字节数和event.total文件的总大小就可以计算出已上传的百分比。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AJAX </tag>
            
            <tag> 上传文件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP删除文件夹和文件夹下的所有文件</title>
      <link href="/2018/07/24/PHP%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9%E5%92%8C%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6/"/>
      <url>/2018/07/24/PHP%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E5%A4%B9%E5%92%8C%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>在PHP网站中可能会遇到需要用PHP删除文件夹的情况，例如一些网盘或在线文件管理等，最近我开发的一个在线文件管理器就需要用PHP删除文件夹，这个在线文件管理器主要是给我用来远程管理Linux的文件，Linux虽然可以通过FTP来管理文件，但只能在电脑上使用，而Web的文件管理器只要在有浏览器的设备上就能使用。在开发删除功能的时候遇到了一个问题，PHP删除文件夹的函数 rmdir 只能删除空文件夹，在遇到非空文件夹的情况下就会报错，要解决这个问题只能写一个自定义函数或方法，这里我就记录一下我写的函数，可以直接调用。<br><a id="more"></a><br>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  删除文件，需要传入一个包含文件名的数组，可删除多个文件或文件夹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteDir</span><span class="params">($fileNameArr = array<span class="params">()</span>)</span> </span>&#123;</span><br><span class="line">    $successfullyDeleted = <span class="keyword">array</span>();  <span class="comment">//  用来保存已删除文件的文件名</span></span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; count($fileNameArr);$i ++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (file_exists($fileNameArr[$i])) &#123;  <span class="comment">//  文件是否存在</span></span><br><span class="line">            <span class="keyword">if</span> (!is_dir($fileNameArr[$i])) &#123;  <span class="comment">//  是否是文件而不是文件夹</span></span><br><span class="line">                <span class="comment">//  如果不是文件夹就直接删除文件</span></span><br><span class="line">                <span class="keyword">if</span> (unlink($fileNameArr[$i])) &#123;</span><br><span class="line">                    <span class="comment">//  如果删除成功就把已删除的文件添加到数组</span></span><br><span class="line">                    array_push($successfullyDeleted, $fileNameArr[$i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//  如果是文件夹就匹配文件夹内的所有文件</span></span><br><span class="line">                $fileListArr = glob($fileNameArr[$i] . <span class="string">'/*'</span>);</span><br><span class="line">                <span class="keyword">if</span> (count($fileListArr) &lt; <span class="number">1</span>) &#123;  <span class="comment">//  是否匹配到文件</span></span><br><span class="line">                    <span class="comment">//  如果没有匹配到文件，说明这是一个空文件夹，直接删除</span></span><br><span class="line">                    <span class="keyword">if</span> (rmdir($fileNameArr[$i])) &#123;</span><br><span class="line">                        <span class="comment">//  如果删除成功就把已删除的文件添加到数组</span></span><br><span class="line">                        array_push($successfullyDeleted, $fileNameArr[$i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//  如果匹配到文件就调用自身，继续匹配删除</span></span><br><span class="line">                    deleteDir($fileListArr);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//  判断一下需要删除的文件或文件夹是否还存在</span></span><br><span class="line">            <span class="keyword">if</span> (file_exists($fileNameArr[$i])) &#123;</span><br><span class="line">                <span class="comment">//  如果还存在的话就调用自身继续删除</span></span><br><span class="line">                deleteDir(<span class="keyword">array</span>($fileNameArr[$i]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//  执行完毕后返回已删除文件或文件夹的名称</span></span><br><span class="line">    <span class="keyword">return</span> $successfullyDeleted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面是调用方法</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  模拟要删除的文件数组</span></span><br><span class="line">$fileName = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'新建文件夹'</span>,</span><br><span class="line">    <span class="string">'文本.txt'</span>,</span><br><span class="line">    <span class="string">'图片.jpg'</span>,</span><br><span class="line">    <span class="string">'音频.mp3'</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">//  调用删除函数，接收返回的已删除文件的文件名</span></span><br><span class="line">$files = deleteDir($fileName);</span><br></pre></td></tr></table></figure><p>以上就是我写的一个删除文件的函数，因为代码比较简单，而且大多数都有注释，一看就懂，这里就不详细的解释了。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux VI编辑器简单使用教程</title>
      <link href="/2018/06/11/Linux-VI%E7%BC%96%E8%BE%91%E5%99%A8%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2018/06/11/Linux-VI%E7%BC%96%E8%BE%91%E5%99%A8%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>vi编辑器是Linux和Unix上最基本的文本编辑器，工作在字符模式下。由于不需要图形界面，vi是效率很高的文本编辑器。尽管在Linux上也有很多图形界面的编辑器可用，但vi在系统和服务器管理中的功能是那些图形编辑器所无法比拟的。<br><a id="more"></a><br>还有一个vi改进版叫vim，主要加入了一些代码高亮功能，操作方法和vi差不多，因为vi是每种Linux都有的编辑器，所以这里就只说vi。</p><p>通过vi打开文件</p><p>vi打开文件的方法是 vi + 空格 + 文件名，例如我要打开home目录下的1.php：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /home/1.php</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/vi1.jpg" alt="Vi打开文件"></p><p>打开以后会看到如下界面，</p><p><img src="https://wsmcb.github.io/img/vi2.jpg" alt="Vi"></p><p>这个1.php文件里有一些内容，可以用 键盘的 上 下 左 右 来控制编辑器的光标，不过现在还不能编辑，如果要编辑的话可以按i，一般的输入和windows的差不多，如果要退出编辑模式的话可以按ESC，按ESC后会退出编辑模式，但不会退出vi。</p><p>保存</p><p>保存文件需要在退出编辑模式的情况下输入命令，</p><p>下面是操作命令：</p><table><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>:w</td><td>保存</td></tr><tr><td>:wq</td><td>保存并退出vi</td></tr><tr><td>:q!</td><td>不保存直接退出vi</td></tr></tbody></table><p>注意！命令前面的冒号不能少，还有退出后面的叹号也不能少，下面掩饰保存退出：</p><p><img src="https://wsmcb.github.io/img/vi保存退出.jpg" alt="vi保存退出"></p><p>输入完成后按下回车就可以保存退出了。</p><p>下面是vi的一些快捷键，需要退出编辑模式才可用：</p><table><thead><tr><th>快捷键</th><th>说明</th></tr></thead><tbody><tr><td>u</td><td>撤销</td></tr><tr><td>x</td><td>删除</td></tr><tr><td>v</td><td>选择文本</td></tr><tr><td>y</td><td>复制</td></tr><tr><td>yy</td><td>复制光标所在行</td></tr><tr><td>dd</td><td>删除光标所在行</td></tr><tr><td>p</td><td>粘贴</td></tr></tbody></table><p>这里的u就类似windows的编辑器的ctrl + z撤销。x删除光标选中的文字，如果在编辑模式下也可以按退格键删除。按住v移动光标可选择文字，类似于windows编辑器的shift。y可以复制选中的文字。连续按两次y可以复制光标所在行，连续按两次d可以删除光标所在行，p粘贴，类似于windows的ctrl + v。注意！上面说的快捷键需要退出编辑模式才能用。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP实现简单缩略图</title>
      <link href="/2018/05/14/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%BC%A9%E7%95%A5%E5%9B%BE/"/>
      <url>/2018/05/14/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%BC%A9%E7%95%A5%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p>在电商网站和社交网站或者新闻网站中，为了更快的加载网页和图片，通常会在商品列表或头像等地方使用缩略图。现在的手机和相机的像素都比较高，1张照片基本都在4M以上，如果每一个地方都加载原图的话，等待所有图片加载完成的时间，估计用户都可以打一局游戏了。而且国内大多数低配的服务器的带宽只有1 – 2M，所以缩小图片体积就显得尤为重要了。<br><a id="more"></a><br>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$fileName = <span class="string">'img/image.jpg'</span>;  <span class="comment">//  文件名</span></span><br><span class="line"></span><br><span class="line">$fileInfo = getimagesize($fileName);  <span class="comment">//  获取图片信息</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">list</span>($srcW, $srcH) = $fileInfo;  <span class="comment">//  把原始图片的宽度和高度传给单独的变量</span></span><br><span class="line"></span><br><span class="line">$dstW = <span class="number">100</span>;  <span class="comment">//  新画布的宽度</span></span><br><span class="line">$dstH = <span class="number">100</span>;  <span class="comment">//  新画布的高度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  新建画布</span></span><br><span class="line">$dstImage = imagecreatetruecolor($dstW, $dstH);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  创建原始图片画布</span></span><br><span class="line">$srcImage = imagecreatefromjpeg($fileName);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  拷贝图片到新画布</span></span><br><span class="line">imagecopyresampled($dstImage, $srcImage, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, $dstW, $dstH, $srcW, $srcH);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  保存jpg图片</span></span><br><span class="line">imagejpeg($dstImage, <span class="string">'img/new_image.jpg'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  销毁画布</span></span><br><span class="line">imagedestroy($srcImage);</span><br><span class="line">imagedestroy($dstImage);</span><br></pre></td></tr></table></figure><p>下面是一些函数说明：</p><p><strong>getimagesize(string $fileName)</strong> 获取图片大小，接收一个图片文件名，返回包含图片大小的数组，如果无法获取会返回false，这个函数也可以用来判断是否是真实图片。</p><p><strong>imagecreatetruecolor(int $width, int $height)</strong> 新建一个真彩色图像，接收两个参数，分别是宽度和高度，返回一个图像标识符，代表了一幅大小为 x_size 和 y_size 的黑色图像。</p><p><strong>imagecreatefromjpeg(string $fileName)</strong> 由文件或 URL 创建一个新图象，接收一个文件url，返回一图像标识符，代表了从给定的文件名取得的图像。</p><p><strong>imagecopyresampled(resource $dstImage, resource $srcImage, int $dstX, int $dstY, int $srcX , int $srcY, int $dstW, int $dstH, int $srcW , int $srcH)</strong> 重采样拷贝部分图像并调整大小，这个函数的参数较多，下面是参数说明：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>dstImage</td><td>resource</td><td>目标图象连接资源</td></tr><tr><td>srcImage</td><td>resource</td><td>源图象连接资源</td></tr><tr><td>dstX</td><td>int</td><td>目标 X 坐标点，也就是粘贴图像的X起始位置</td></tr><tr><td>dstY</td><td>int</td><td>目标 Y 坐标点，也就是粘贴图像的Y起始位置</td></tr><tr><td>srcX</td><td>int</td><td>源的 X 坐标点，也就是拷贝图像的X起始位置</td></tr><tr><td>srcY</td><td>int</td><td>源的 Y 坐标点，也就是拷贝图像的Y起始位置</td></tr><tr><td>dstW</td><td>int</td><td>目标宽度，也就是粘贴图像的宽度</td></tr><tr><td>dstH</td><td>int</td><td>目标高度，也就是粘贴图像的高度</td></tr><tr><td>srcW</td><td>int</td><td>源图象的宽度，也就是拷贝图像的宽度</td></tr><tr><td>srcH</td><td>int</td><td>源图象的高度，也就是拷贝图像的高度</td></tr></tbody></table><p>如果成功会返回true，失败会返回false，</p><p><strong>imagejpeg(resource $image, string $fileName, int $quality)</strong> 输出图象到浏览器或文件，下面是参数说明：</p><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>image</td><td>resource</td><td>由图象创建函数(例如imagecreatetruecolor())返回的图象资源</td></tr><tr><td>fileName</td><td>string</td><td>文件保存的路径，如果未设置或为 NULL，将会直接输出原始图象流，如果要省略这个参数而提供 quality 参数，使用NULL</td></tr><tr><td>quality</td><td>int</td><td>图片质量，范围从 0（最差质量，文件更小）到 100（最佳质量，文件最大）。默认为 IJG 默认的质量值（大约 75）</td></tr></tbody></table><p>成功时返回 true， 或者在失败时返回 false。</p><p><strong>imagedestroy(resource $image)</strong> 释放与 image 关联的内存。image 是由图像创建函数返回的图像标识符，例如 imagecreatetruecolor()。</p><p>这里因为只是简单掩饰，所以新画布的宽度和高度是固定的，如果遇到原图片和新画布的宽高比不一样的话，图片会被强制拉升，如果不想强制拉升图片，又要限制图片的比例的话，可以用javascript来写一个选择图片范围的程序，当用户上传图片的时候在图片上面会有一个方框可以让用户拖拽选择范围，选择完成后在把参数发送到服务器，由PHP根据参数来拷贝图片。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP使用百度翻译API给网站加入翻译功能</title>
      <link href="/2018/05/01/PHP%E4%BD%BF%E7%94%A8%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91API%E7%BB%99%E7%BD%91%E7%AB%99%E5%8A%A0%E5%85%A5%E7%BF%BB%E8%AF%91%E5%8A%9F%E8%83%BD/"/>
      <url>/2018/05/01/PHP%E4%BD%BF%E7%94%A8%E7%99%BE%E5%BA%A6%E7%BF%BB%E8%AF%91API%E7%BB%99%E7%BD%91%E7%AB%99%E5%8A%A0%E5%85%A5%E7%BF%BB%E8%AF%91%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<p>百度翻译API是百度为开发者提供的翻译服务，只要在您的网站或APP里调用百度翻译API，您的网站或应用就可以实现翻译功能。对于国际网站来说，翻译功能是必不可少的，向Facebook和Twitter也都有翻译功能，只需点击一下就可以把推文或评论翻译为你使用的语言。而我也把百度翻译加入到了我的图像识别里，OCR识别完成后就可以翻译识别到的文字，如果我想翻译一段不能直接复制粘贴的文字而又不想手动输入的话就可以直接拍照或截图上传，等待OCR识别完成后就可以直接翻译。<br><a id="more"></a><br>百度翻译API分为通用翻译API和定制化翻译API，下面是百度给出的介绍：</p><blockquote><p>通用翻译API支持28种语言互译，覆盖中、英、日、韩、西、法、泰、阿、俄、葡、德、意、荷、芬、丹等；支持28种语言的语言检测。您只需要通过调用通用翻译API，传入待翻译的内容，并指定要翻译的源语言（支持源语言语种自动检测）和目标语言，即可得到相应的翻译结果。任何第三方应用或网站都可以通过使用通用翻译API为用户提供实时优质的多语言翻译服务，提升产品体验。</p><p>定制化翻译API是指在通用翻译模型基础上，基于开发者提供的领域数据，通过自适应技术，快速构建的定制化训练模型。定制化翻译API目前支持中英、英中方向，后续逐步支持其他语言方向。开发者使用定制化翻译API可以更好地与您的应用场景相匹配，获得更好的翻译效果。</p></blockquote><p>这里就以通用翻译API为例，简单说一下百度翻译API的注册和使用</p><h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><p>点击 <a href="http://api.fanyi.baidu.com/api/trans/product/index" target="_blank" rel="noopener">百度翻译开放平台</a> 进入百度翻译开放平台来申请服务，</p><p><img src="https://wsmcb.github.io/img/百度翻译开放平台.jpg" alt="百度翻译开放平台"></p><p>点击立即使用，如果没有登录百度账号的话就需要登录百度账号，按照提示填写个人信息，主要就是邮箱和手机号之类的，接着需要填写服务信息，应用或网站名称可以直接填你的网站名称，如果还没有网站的话可以随便填写，例如 翻译，相关网址可以直接填你的域名，如果没有域名的话就直接填服务器IP，网站或应用简介可以随便填，服务器地址可以填你的服务器IP，如果是APP的话可以不用填写，如果填写了服务器地址后就只有填写的服务器IP才能调用百度翻译，填写完成后提交申请，注册完成。</p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>百度翻译API是通过发送get请求或post请求来调用的，所以只要能发送这两种请求的语言都可以使用百度翻译API，因为我对PHP比较熟，所以这里就用PHP来掩饰。</p><p>下面是请求地址</p><p>通用翻译API HTTP地址：</p><p><a href="http://api.fanyi.baidu.com/api/trans/vip/translate" target="_blank" rel="noopener">http://api.fanyi.baidu.com/api/trans/vip/translate</a></p><p>通用翻译API HTTPS地址：</p><p><a href="https://fanyi-api.baidu.com/api/trans/vip/translate" target="_blank" rel="noopener">https://fanyi-api.baidu.com/api/trans/vip/translate</a></p><p>申请完成后会获得一个 APP ID和密钥，发送翻译请求的时候需要用来验证身份，下面是需要发送的信息：</p><table><thead><tr><th>字段名</th><th>必填参数</th><th>说明</th></tr></thead><tbody><tr><td>q</td><td>是</td><td>请求翻译query，也就是要翻译的内容</td></tr><tr><td>from</td><td>是</td><td>翻译源语言，设置为auto可自动检测</td></tr><tr><td>to</td><td>是</td><td>译文语言，不能设置为auto</td></tr><tr><td>appid</td><td>是</td><td>APP ID，可以在管理控制台查看</td></tr><tr><td>salt</td><td>是</td><td>随机数，随便生成一个随机数就可以</td></tr><tr><td>sign</td><td>是</td><td>签名，appid+q+salt+密钥 的MD5值</td></tr></tbody></table><p>下面就用PHP来掩饰一下：</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> APP_ID = <span class="string">'34354646'</span>;  <span class="comment">//  使用常量来保存APP ID</span></span><br><span class="line"><span class="keyword">const</span> KEY = <span class="string">'dfefer343ff'</span>;  <span class="comment">//  使用常量来保存密钥</span></span><br><span class="line"></span><br><span class="line">$query = <span class="string">'Are you ok'</span>;  <span class="comment">//  要翻译的内容</span></span><br><span class="line">$url = <span class="string">'http://api.fanyi.baidu.com/api/trans/vip/translate'</span>;  <span class="comment">//  发送请求的URL</span></span><br><span class="line">$salt = mt_rand(<span class="number">11111111</span>, <span class="number">99999999</span>);  <span class="comment">//  随机数</span></span><br><span class="line">$sign = APP_ID . $query . $salt . KEY;  <span class="comment">//  APPID+翻译内容+随机数+密钥</span></span><br><span class="line">$sign = md5($sign);  <span class="comment">//  md5加密，生成签名</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  下面是url拼接</span></span><br><span class="line">$url = $url . <span class="string">'?q='</span> . urlencode($query) . <span class="string">'&amp;from=auto&amp;to=zh&amp;appid='</span> . APP_ID . <span class="string">'&amp;salt='</span> . $salt . <span class="string">'&amp;sign='</span> . $sign;</span><br><span class="line"></span><br><span class="line">$data = file_get_contents($url);  <span class="comment">//  发送get请求</span></span><br></pre></td></tr></table></figure><p>上面把Are you ok翻译为中文，mt_rand用来生成随机数的函数，我把翻译源语言设置为auto，译文语言设置为中文，为了方便 使用的是GET方式提交，如果需要翻译的内容比较长的话可以使用POST方式提交，关于PHP发送POST可以看 <a href="http://www.changbin.me/index.php/2019/02/19/php%e5%8f%91%e9%80%81get%e5%92%8cpost%e8%af%b7%e6%b1%82/" target="_blank" rel="noopener">PHP发送GET和POST请求</a>。</p><p>翻译源语言和译文语言需要使用语言简写，下面是语言简写：</p><table><thead><tr><th>语言简写</th><th>名称</th></tr></thead><tbody><tr><td>auto</td><td>自动检测</td></tr><tr><td>zh</td><td>中文</td></tr><tr><td>en</td><td>英语</td></tr><tr><td>yue</td><td>粤语</td></tr><tr><td>wyw</td><td>文言文</td></tr><tr><td>jp</td><td>日语</td></tr><tr><td>fra</td><td>法语</td></tr><tr><td>spa</td><td>西班牙语</td></tr><tr><td>th</td><td>泰语</td></tr><tr><td>ara</td><td>阿拉伯语</td></tr><tr><td>ru</td><td>俄语</td></tr><tr><td>pt</td><td>葡萄牙语</td></tr><tr><td>de</td><td>德语</td></tr><tr><td>it</td><td>意大利语</td></tr><tr><td>el</td><td>希腊语</td></tr><tr><td>nl</td><td>荷兰语</td></tr><tr><td>pl</td><td>波兰语</td></tr><tr><td>bul</td><td>保加利亚语</td></tr><tr><td>est</td><td>爱沙尼亚语</td></tr><tr><td>dan</td><td>丹麦语</td></tr><tr><td>fin</td><td>芬兰语</td></tr><tr><td>cs</td><td>捷克语</td></tr><tr><td>rom</td><td>罗马尼亚语</td></tr><tr><td>slo</td><td>斯洛文尼亚语</td></tr><tr><td>swe</td><td>瑞典语</td></tr><tr><td>hu</td><td>匈牙利语</td></tr><tr><td>cht</td><td>繁体中文</td></tr><tr><td>vie</td><td>越南语</td></tr></tbody></table><p>翻译完成后会返回一个JSON数据，下面是参数说明：</p><table><thead><tr><th>字段名</th><th>描述</th></tr></thead><tbody><tr><td>from</td><td>翻译源语言</td></tr><tr><td>to</td><td>译文语言</td></tr><tr><td>trans_result</td><td>翻译结果，trans_result里包含原文和译文</td></tr><tr><td>src</td><td>原文</td></tr><tr><td>dst</td><td>译文</td></tr></tbody></table><p>下面是返回的JSON：</p><p>JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"from"</span>: <span class="string">"en"</span>,</span><br><span class="line">    <span class="attr">"to"</span>: <span class="string">"zh"</span>,</span><br><span class="line">    <span class="attr">"trans_result"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"src"</span>: <span class="string">"Are you ok"</span>,</span><br><span class="line">            <span class="attr">"dst"</span>: <span class="string">"你还好吗？"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>因为这个JSON只是一个字符串，如果要操作的话需要转换为PHP对象，有关PHP操作JSON的方法可以看 <a href="http://www.machangbin.com/index.php/2018/04/09/php%e6%93%8d%e4%bd%9cjson%e6%a0%bc%e5%bc%8f%e6%95%b0%e6%8d%ae/" target="_blank" rel="noopener">PHP操作JSON格式数据</a> 。</p><p>如果翻译发生错误也会返回一个JSON，其中就包含错误码，下面是错误码说明：</p><table><thead><tr><th>错误码</th><th>含义</th><th>解决方法</th></tr></thead><tbody><tr><td>52000</td><td>成功</td><td></td></tr><tr><td>52001</td><td>请求超时</td><td>重试</td></tr><tr><td>52002</td><td>系统错误</td><td>重试</td></tr><tr><td>52003</td><td>未授权用户</td><td>检查您的 appid 是否正确，或者服务是否开通</td></tr><tr><td>54000</td><td>必填参数为空</td><td>检查是否少传参数</td></tr><tr><td>54001</td><td>签名错误</td><td>请检查您的签名生成方法</td></tr><tr><td>54003</td><td>访问频率受限</td><td>请降低您的调用频率</td></tr><tr><td>54004</td><td>账户余额不足</td><td>请前往管理控制平台为账户充值</td></tr><tr><td>54005</td><td>长query请求频繁</td><td>请降低长query的发送频率，3s后再试</td></tr><tr><td>58000</td><td>客户端IP非法</td><td>检查个人资料里填写的 IP地址 是否正确，可前往管理控制平台修改</td></tr><tr><td>58001</td><td>译文语言方向不支持</td><td>检查译文语言是否在语言列表里</td></tr></tbody></table><p>下面是请求发生错误时返回的JSON：</p><p>JSON：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"error_code"</span>: <span class="string">"58000"</span>,</span><br><span class="line">    <span class="attr">"error_msg"</span>: <span class="string">"INVALID_CLIENT_IP"</span>,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;</span><br><span class="line">        <span class="attr">"client_ip"</span>: <span class="string">"38.128.114.146"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>根据错误码来定位错误，客户端IP非法。</p><h2 id="价格说明"><a href="#价格说明" class="headerlink" title="价格说明"></a>价格说明</h2><p>通用翻译API每月提供200万字符免费额度，超出后需要按照字符数收费。</p><p>当月翻译字符数≤200万，当月免费。</p><p>超过200万字符，按照49元人民币/百万字符，支付当月全部翻译字符数费用。</p><p>字符数以翻译的源语言字符长度为标准计算。一个汉字，英文字母，标点符号等，均计为一个字符。注：空格、html标签等均计入在内。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jQuery AJAX简单使用教程</title>
      <link href="/2018/04/24/jQuery-AJAX%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2018/04/24/jQuery-AJAX%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>在上一篇文章AJAX简单使用教程 中，我写了原生AJAX的使用，但是编写常规的 AJAX 代码并不容易，因为不同的浏览器对 AJAX 的实现并不相同。这意味着您必须编写额外的代码对浏览器进行测试。不过，jQuery 团队为我们解决了这个难题，我们只需要一行简单的代码，就可以实现 AJAX 功能。<br><a id="more"></a><br>有关AJAX的介绍可以参考我的上一篇文章：<a href="http://www.machangbin.com/index.php/2018/04/17/ajax%e7%ae%80%e5%8d%95%e4%bd%bf%e7%94%a8%e6%95%99%e7%a8%8b/" target="_blank" rel="noopener">AJAX简单使用教程</a> 。</p><p>jQuery提供了多种使用AJAX的方法，下面就来简单的说一下这些方法的使用。</p><h2 id="get-方法"><a href="#get-方法" class="headerlink" title="get() 方法"></a>get() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  通过get方式请求</span></span><br><span class="line">$.<span class="keyword">get</span>("server.php", 'userName=12346',</span><br><span class="line">    function (response , textStatus, jqXHR) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);  <span class="comment">//  在控制台输出请求到的数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span>(data));  <span class="comment">//  在控制台输出数据类型</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"json"</span>  <span class="comment">//  设置返回的数据类型</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>这是一个简单的 GET 请求功能以取代复杂 $.ajax 。请求成功时可调用回调函数。如果需要在出错时执行函数，请使用 $.ajax。</p><p>下面是参数说明：</p><table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>url</td><td>设置要请求的文件的url地址</td></tr><tr><td>data</td><td>要发送的数据，数据格式为 参数名=参数值，多条数据之间用&amp;分隔</td></tr><tr><td>success</td><td>请求成功后要执行的函数，这个函数会返回3条数据 ，response：请求返回的数据，status：请求的状态，jqXHR XMLHttpRequest 对象</td></tr><tr><td>dataType</td><td>预计服务器返回的数据类型，如果您不确定服务器返回的数据类型，此参数可以省略，下面是可以设置的类型：xml、html、json、text、script</td></tr></tbody></table><p>特别说明：这里的dataType参数可以根据设置的参数自动转换返回的数据类型，例如我设置dateType参数为json，jQuery就会把请求返回的数据自动转换为JSON对象，如果我设置为script，就会自动执行请求返回的JavaScript代码。</p><h2 id="post-方法"><a href="#post-方法" class="headerlink" title="post() 方法"></a>post() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  使用POST方式请求</span></span><br><span class="line">$.post(<span class="string">"server.php"</span>, <span class="string">'userName=123456'</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">data, textStatus, jqXHR</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);  <span class="comment">//  在控制台输出数据</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>最简单的发送post请求，连请求头都可以不用设置，参数和返回内容和get方法是一样的。</p><h2 id="getJSON-方法"><a href="#getJSON-方法" class="headerlink" title="getJSON() 方法"></a>getJSON() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$.getJSON(<span class="string">"server.php"</span>, <span class="string">'email=123@gmail.com'</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">data, textStatus, jqXHR</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);  <span class="comment">//  在控制台输出请求到的JSON数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(textStatus);  <span class="comment">//  在控制台输出状态</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span>(data));  <span class="comment">//  在控制台输出数据类型</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>getJSON方法可以通过Ajax异步请求的方式，获取服务器中的数据，并对获取的数据进行解析，也就是说返回的JSON数据可以直接使用，无需手动转换，参数基本和上面的get和post差不多，但可以直接返回JSON数据，所以不需要设置dataType参数。</p><h2 id="getScript-方法"><a href="#getScript-方法" class="headerlink" title="getScript() 方法"></a>getScript() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  请求一个JS文件，并且自动执行请求到的JS代码</span></span><br><span class="line">$.getScript(<span class="string">"getJSON.js"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">script, textStatus, jqXHR</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(script);  <span class="comment">//  在控制台输出一下请求到的JS代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>getScript可以通过get方式从服务器请求JS代码，并且可以自动执行请求到的JS代码，参数和上面的getJSON是一样的，无需设置dataType。</p><h2 id="ajax-方法"><a href="#ajax-方法" class="headerlink" title="ajax() 方法"></a>ajax() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">    type: <span class="string">"get"</span>,  <span class="comment">//  请求方式 post或get</span></span><br><span class="line">    url: <span class="string">"server1.php"</span>,  <span class="comment">//  要请求的url</span></span><br><span class="line">    data: <span class="string">"data=hello"</span>,  <span class="comment">//  要发送的数据</span></span><br><span class="line">    <span class="keyword">async</span>: <span class="literal">true</span>,  <span class="comment">//  是否是异步请求，默认为true</span></span><br><span class="line">    dataType: <span class="string">"text"</span>,  <span class="comment">//  预计服务器返回的数据类型</span></span><br><span class="line">    timeout: <span class="number">3000</span>,  <span class="comment">//  请求超时时间 毫秒</span></span><br><span class="line">    cache: <span class="literal">false</span>,  <span class="comment">//  是否从浏览器缓存中加载请求信息，默认为true</span></span><br><span class="line">    global: <span class="literal">false</span>,  <span class="comment">//  是否触发全局ajax事件</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params">data , status</span>) </span>&#123;  <span class="comment">//  请求成功时调用的函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(data);  <span class="comment">//  在控制台输出数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(status);  <span class="comment">//  在控制台输出状态</span></span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, error, abnormal</span>) </span>&#123;  <span class="comment">//  请求失败时调用的函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(error);  <span class="comment">//  输出错误信息</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>发送ajax请求，这个方法可自定义的参数较多，此方法接收一个JSON对象，下面是JSON参数说明：</p><table><thead><tr><th>参数名</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>type</td><td>string</td><td>请求方式，get或post</td></tr><tr><td>url</td><td>string</td><td>要请求的url</td></tr><tr><td>data</td><td>string</td><td>要发送的数据，格式为 参数名=参数值</td></tr><tr><td>async</td><td>boolean</td><td>是否是异步请求，默认为true</td></tr><tr><td>dataType</td><td>string</td><td>预计服务器返回的数据类型，jQuery会根据此设置自动转换数据类型，下面是可设置的类型：xml、html、json、text、script</td></tr><tr><td>timeout</td><td>number</td><td>请求超时时间 毫秒</td></tr><tr><td>cache</td><td>boolean</td><td>是否从浏览器缓存中加载请求信息，默认为true</td></tr><tr><td>global</td><td>boolean</td><td>是否触发全局 AJAX 事件。设置为 false 将不会触发全局 AJAX 事件，如 ajaxStart 或 ajaxStop 。可用于控制不同的Ajax事件，默认为true</td></tr><tr><td>ifModified</td><td>boolean</td><td>仅在服务器数据改变时获取新数据。使用 HTTP 包 Last-Modified 头信息判断，默认为false</td></tr><tr><td>beforeSend</td><td>function</td><td>发送请求前可修改 XMLHttpRequest 对象的函数，如添加自定义 HTTP 头</td></tr><tr><td>complete</td><td>function</td><td>请求完成后回调函数 (请求成功或失败时均调用)。参数： XMLHttpRequest 对象，成功信息字符串</td></tr><tr><td>success</td><td>function</td><td>请求成功后回调函数。这个方法有两个参数：服务器返回数据，返回状态</td></tr><tr><td>error</td><td>function</td><td>请求失败时调用的函数，这个函数有三个参数：XMLHttpRequest 对象，错误信息，（可能）捕获的错误对象。</td></tr></tbody></table><p>上面就是ajax方法的参数，如果没有特殊需要的话不必每个参数都写。</p><h2 id="ajaxSetup-方法"><a href="#ajaxSetup-方法" class="headerlink" title="ajaxSetup() 方法"></a>ajaxSetup() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$.ajaxSetup(&#123;</span><br><span class="line">    url: <span class="string">"server.php"</span>,  <span class="comment">//  设置url</span></span><br><span class="line">    type: <span class="string">"get"</span>,  <span class="comment">//  请求类型 get或post</span></span><br><span class="line">    data: <span class="string">"Hello PHP"</span>,  <span class="comment">//  要发送的数据</span></span><br><span class="line">    <span class="keyword">async</span>: <span class="literal">true</span>,  <span class="comment">//  是否是异步请求</span></span><br><span class="line">    dataType: <span class="string">"json"</span>,  <span class="comment">//  预计服务器返回的数据类型</span></span><br><span class="line">    timeout: <span class="number">3000</span>,  <span class="comment">//  请求超时时间 毫秒</span></span><br><span class="line">    cache: <span class="literal">false</span>,  <span class="comment">//  是否从浏览器缓存中加载请求信息，默认为true</span></span><br><span class="line">    success: <span class="function"><span class="keyword">function</span> (<span class="params">data , status</span>) </span>&#123;  <span class="comment">//  请求成功时的回掉函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(data);  <span class="comment">//  在控制台输出数据</span></span><br><span class="line">        <span class="built_in">console</span>.log(status);</span><br><span class="line">    &#125;,</span><br><span class="line">    error: <span class="function"><span class="keyword">function</span> (<span class="params">xhr, error, abnormal</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);  <span class="comment">//  在控制台输出错误信息</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$.ajax();  <span class="comment">//  设置完成后调用ajax方法就不需要重新设置了</span></span><br></pre></td></tr></table></figure><p>ajaxSetup方法可以设置Ajax请求的一些全局性参数，设置完成后，后面的Ajax请求将不需要再添加这些参数，使用ajax设置的参数会覆盖ajaxSetup设置的参数，这个方法也是需要传入一个JSON对象，具体的JSON参数可参考上面的ajax参数。</p><h2 id="ajaxStart-和-ajaxStop-方法"><a href="#ajaxStart-和-ajaxStop-方法" class="headerlink" title="ajaxStart() 和 ajaxStop() 方法"></a>ajaxStart() 和 ajaxStop() 方法</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ajaxStart(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="comment">//  ajax请求开始前</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'正在发送请求'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ajaxStop(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="comment">//  ajax请求完成后</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'请求完成'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  发送一个get请求</span></span><br><span class="line">$.<span class="keyword">get</span>("server.php", 'data=123',</span><br><span class="line">    function (data, textStatus, jqXHR) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ajaxStart方法用来设置ajax开始请求前要执行的函数，ajaxStop方法用来设置ajax请求完成后要执行的函数，ajaxStart方法和ajaxStop方法需要绑定在document上，只要执行ajax请求就会触发。这两个方法常被用来设置按钮显示的名称或加载动画。</p><p>上面就是jQuery常用的ajax方法，新版jQuery已删除的方法这里就没有写了。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AJAX </tag>
            
            <tag> jQuery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AJAX简单使用教程</title>
      <link href="/2018/04/17/AJAX%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2018/04/17/AJAX%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>AJAX 是一种用于创建快速动态网页的技术。<br>通过在后台与服务器进行少量数据交换，AJAX 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。传统的网页要更新内容只能重新加载整个页面。<br><a id="more"></a><br>因为无需刷新页面就能和后端进行数据传输，所以AJAX的出现极大的改善了用户体验，例如在使用搜索引擎搜索内容的时候只需要输入一部分关键词无需提交，搜索引擎就会根据你输入的内容来提供相应的搜索建议，又或者是在用户注册的时候输入完手机号或邮箱地址，后台就会判断输入的手机号或邮箱地址是否被注册过，无需重新加载整个网页，减小了数据的传输量，节省了时间。</p><p>下面是一个简单的AJAX</p><h2 id="get方式"><a href="#get方式" class="headerlink" title="get方式"></a>get方式</h2><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  创建XMLHttpRequest对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">//  设置提交方式，url，是否异步</span></span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'server.php'</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">//  提交</span></span><br><span class="line">xhr.send();</span><br><span class="line"></span><br><span class="line"><span class="comment">//  每当 readyState 改变时，就会触发 onreadystatechange 事件</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  根据XMLHttpRequest的状态值来判断是否成功获取数据</span></span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="comment">//  根据HTTP状态码来判断是否有错误</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">//  在控制台输出获取的内容</span></span><br><span class="line">            <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  输出HTTP错误码</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'出错了，错误代码'</span> + xhr.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>XMLHttpRequest 对象</strong> 提供了对 HTTP 协议的完全的访问，包括做出 POST 和 HEAD 请求以及普通的 GET 请求的能力。XMLHttpRequest 可以同步或异步地返回 Web 服务器的响应，并且能够以文本或者一个 DOM 文档的形式返回内容。</p><p>XMLHttpRequest对象需要IE7以上的浏览器才能使用，不过现在已经是2018年了，已经很少会有人用IE6了，国内的XP用户也大多会用360或QQ这一类的浏览器，这些浏览器大多是Chrome内核的，所以不用太担心兼容性问题。</p><p><strong>open(method, url, async, username, password) 方法</strong> 初始化 HTTP 请求参数，例如 URL 和 HTTP 方法，但是并不发送请求。</p><p>参数说明：</p><ol><li>method 请求方式，get或post</li><li>url 要请求的url</li><li>async 是否异步 如果为true在等待服务器响应的时候，后面的JS代码可以继续执行，如果为false等待服务器响应的这段时间，后面的JS代码不会执行</li><li>username 如果后台启用了身份验证就需要设置用户名</li><li>password 如果后台启用了身份验证就需要设置密码</li></ol><p>如果使用get方式请求，数据就需要写在url的后面，格式和超链接发送数据的格式是一样的，? + 参数名= + 数据，多条数据之间用&amp;分隔，</p><p>例如我要给server.php发送用户名和密码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.php?userName=123456&amp;password=123456</span><br></pre></td></tr></table></figure><p>注意！这里的get方式和表单的get是一样的，参数名和数据都是可见的，所以不建议用get方式来发送密码，而且get允许的数据量笔post小，不能发送太多内容。</p><p><strong>send(body) 方法</strong> 发送HTTP请求，如果为post方式就需要填写发送数据，如果是get方式可省略参数。</p><p><strong>onreadystatechange 事件</strong> 每当 readyState 改变时，就会触发此事件。</p><p><strong>readyState 属性</strong> HTTP 请求的状态.当一个 XMLHttpRequest 初次创建时，这个属性的值从 0 开始，直到接收到完整的 HTTP 响应，这个值增加到 4。</p><p>下面是readyState状态值的详细说明：</p><table><thead><tr><th>状态值</th><th>说明</th></tr></thead><tbody><tr><td>0</td><td>初始化状态。XMLHttpRequest 对象已创建或已被 abort() 方法重置。</td></tr><tr><td>1</td><td>open() 方法已调用，但是 send() 方法未调用。请求还没有被发送。</td></tr><tr><td>2</td><td>Send() 方法已调用，HTTP 请求已发送到 Web 服务器。未接收到响应。</td></tr><tr><td>3</td><td>所有响应头部都已经接收到。响应体开始接收但未完成。</td></tr><tr><td>4</td><td>HTTP 响应已经完全接收。</td></tr></tbody></table><p><strong>status 属性</strong> 由服务器返回的 HTTP 状态代码，如 200 表示成功，而 404 表示 “Not Found” 错误。当 readyState 小于 3 的时候读取这一属性会导致一个异常。更详细的HTTP状态码可在百度上查询。</p><p><strong>responseText 属性</strong> 接收到的数据，如果readyState为3，responseText为空字符串。</p><p>上面就是通过get方式发送AJAX请求。</p><h2 id="post方式"><a href="#post方式" class="headerlink" title="post方式"></a>post方式</h2><p>下面是通过post方式发送AJAX请求：</p><p>代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  创建XMLHttpRequest对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"><span class="comment">//  设置提交方式，url，是否异步</span></span><br><span class="line">xhr.open(<span class="string">'post'</span>, <span class="string">'server.php'</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">//  设置请求头</span></span><br><span class="line">xhr.setRequestHeader(<span class="string">"Content-type"</span>,<span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line"><span class="comment">//  提交</span></span><br><span class="line">xhr.send(<span class="string">'userName=123456&amp;password=123456'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//  每当 readyState 改变时，就会触发 onreadystatechange 事件</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//  根据XMLHttpRequest的状态来判断是否成功获取数据</span></span><br><span class="line">    <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="comment">//  根据HTTP状态码来判断是否有错误</span></span><br><span class="line">        <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="comment">//  在控制台输出获取的内容</span></span><br><span class="line">            <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  输出HTTP错误码</span></span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'出错了，错误代码'</span> + xhr.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>post方式和get方式的区别不是太大，post方式open的第一个参数要设置为post。</p><p>post方式的发送数据不再是写在url后面，而是写在send方法里，通过post发送数据还需要设置请求头。</p><p><strong>setRequestHeader(name, value) 方法</strong> 设置HTTP请求的头部，它应该包含在通过后续 send() 调用而发布的请求中。这个方法只有当 readyState 为 1 的时候才能调用，例如，在调用了 open() 之后，但在调用 send() 之前。</p><p>上面就是通过post方式发送请求，post方式的安全性比起get来说要高一些，而且可传输的数据量也要更大。</p><p>以上就是AJAX的使用方法，如果用jQuery的话会更简单。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> AJAX </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP操作JSON格式数据</title>
      <link href="/2018/04/09/PHP%E6%93%8D%E4%BD%9CJSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE/"/>
      <url>/2018/04/09/PHP%E6%93%8D%E4%BD%9CJSON%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p>JSON(JavaScript Object Notation, JS 对象标记) 是一种轻量级的数据交换格式。它基于 ECMAScript (w3c制定的js规范)的一个子集，采用完全独立于编程语言的文本格式来存储和表示数据。简洁和清晰的层次结构使得 JSON 成为理想的数据交换语言。 易于人阅读和编写，同时也易于机器解析和生成，并有效地提升网络传输效率。<br><a id="more"></a><br>想要用PHP操作JSON就离不开下面两个函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">json_decode();  <span class="comment">//  对JSON格式的字符串进行解码</span></span><br><span class="line">json_encode();  <span class="comment">//  对变量进行 JSON 编码</span></span><br></pre></td></tr></table></figure><p>这里先说 json_decode 对JSON格式的字符串进行解码，前端上传的JSON数据对于PHP来说就是字符串，json_decode 可以把JSON字符串转换为PHP对象，</p><p>下面是一个PHP写的JSON字符串：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$json = <span class="string">'&#123;"user": "Administrator", "password": "123456"&#125;'</span>;</span><br></pre></td></tr></table></figure><p>如果不经过转换是不能直接操作的，即使用正则表达式也很难，如果直接输出的话还是一样的字符串：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"user"</span>: <span class="string">"Administrator"</span>, <span class="attr">"password"</span>: <span class="string">"123456"</span>&#125;</span><br></pre></td></tr></table></figure><p>这里就需要用到 json_decode来转换 需要传入要转换的JSON字符串，返回转换后的PHP对象：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$json = <span class="string">'&#123;"user": "Administrator", "password": "123456"&#125;'</span>;  <span class="comment">//  JSON字符串</span></span><br><span class="line">$json = json_decode($json);  <span class="comment">//  JSON字符串解码</span></span><br></pre></td></tr></table></figure><p>现在就可以操作这个JSON对象了：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> $json-&gt;user;  <span class="comment">//  输出用户</span></span><br><span class="line"><span class="keyword">echo</span> $json-&gt;password;  <span class="comment">//  输出密码</span></span><br></pre></td></tr></table></figure><p>这是一个很简单的JSON数据，JSON数据是可以包含数组和多层嵌套的，</p><p>下面是一个稍微有点难度的JSON数据：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"user"</span>: <span class="string">"Administrator"</span>,</span><br><span class="line">    <span class="attr">"password"</span>: <span class="string">"123456"</span>,</span><br><span class="line">    <span class="attr">"phone_num"</span>: [</span><br><span class="line">        <span class="string">"13011112222"</span>,</span><br><span class="line">        <span class="string">"15522222222"</span>,</span><br><span class="line">        <span class="string">"13988888888"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">"friends"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"马云"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="string">"54"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"马化腾"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="string">"47"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"name"</span>: <span class="string">"李彦宏"</span>,</span><br><span class="line">            <span class="attr">"age"</span>: <span class="string">"50"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> $json-&gt;user;  <span class="comment">//  输出用户</span></span><br><span class="line"><span class="keyword">echo</span> $json-&gt;password;  <span class="comment">//  输出密码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>;$i &lt; count($json-&gt;phone_num);$i ++) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $json-&gt;phone_num[$i];  <span class="comment">//  输出手机号</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; count($json-&gt;friends);$i ++) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $json-&gt;friends[$i]-&gt;name;  <span class="comment">//  输出好友名字</span></span><br><span class="line">    <span class="keyword">echo</span> $json-&gt;friends[$i]-&gt;age;  <span class="comment">//  输出好友年龄</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JSON的字段名和值用冒号分隔，数组写在方括号里，对象写在花括号里，JSON对象里可以包含数组，数组里也可以包含JSON对象，只要知道了JSON的语法结构，无论在复杂的JSON数据也能迎刃而解。</p><p>最后来说一下 json_encode 对PHP变量进行JSON编码，也就是把PHP变量或对象转换为JSON字符串，常用于输出数据给前端。通常情况下在数据库查询出数据后为了便于操作都会把数据转换为PHP数组，可以直接输出到页面，但如果前端使用AJAX请求的话就不能直接输出数组了，这时候就需要用 json_encode 把数组转换为JSON字符串，方便前端解析。</p><p>下面是一个PHP数组：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$data = <span class="keyword">array</span>(</span><br><span class="line">    <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">"name"</span> =&gt; <span class="string">"小明"</span>,</span><br><span class="line">        <span class="string">"age"</span> =&gt; <span class="number">10</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">"name"</span> =&gt; <span class="string">"小强"</span>,</span><br><span class="line">        <span class="string">"age"</span> =&gt; <span class="number">8</span></span><br><span class="line">    ),</span><br><span class="line">    <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">"name"</span> =&gt; <span class="string">"小李"</span>,</span><br><span class="line">        <span class="string">"age"</span> =&gt; <span class="number">10</span></span><br><span class="line">    )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>如果直接用 print_r输出的话前端是不能解析的，这里使用 json_encode对数组进行编码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data = json_encode($data);</span><br></pre></td></tr></table></figure><p>传入要编码的PHP变量或对象，返回编码后的JSON字符串，下面是经过JSON编码后的效果：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"小明"</span>,</span><br><span class="line">        <span class="attr">"age"</span>: <span class="number">10</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"小强"</span>,</span><br><span class="line">        <span class="attr">"age"</span>: <span class="number">8</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"小李"</span>,</span><br><span class="line">        <span class="attr">"age"</span>: <span class="number">10</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>前端收到这个JSON字符串后在把这个字符串转换为JSON对象就可以使用了。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> JSON </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Linux VPS + Transmission搭建离线下载服务器</title>
      <link href="/2018/04/05/%E4%BD%BF%E7%94%A8Linux-VPS-Transmission%E6%90%AD%E5%BB%BA%E7%A6%BB%E7%BA%BF%E4%B8%8B%E8%BD%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2018/04/05/%E4%BD%BF%E7%94%A8Linux-VPS-Transmission%E6%90%AD%E5%BB%BA%E7%A6%BB%E7%BA%BF%E4%B8%8B%E8%BD%BD%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p>最近我的百度网盘超级会员就要到期了，对于百度网盘来说，不开超级会员基本是没法用的，虽然离线下载功能不开会员也可以用，但如果想把文件从网盘下载到电脑就必须要超级会员。而迅雷基本上也没法用了，尤其是被举报的资源，即使开了会员也不能下载。正好手里有台VPS服务器，每月5美元的价格如果只用来搭网站和SS的话就有点浪费了，为了让这台VPS能发挥出更大的价值，我用Transmission搭建了离线下载服务器，自己搭建离线下载功能有以下几点好处，<br><a id="more"></a></p><ol><li>无需担心资源类型，只要网上能找到的资源都可以下载，国内服务器除外，</li><li>下载的文件放在服务器不会被和谐，国内服务器除外，</li></ol><p>缺点也有，那就是一般的VPS的硬盘空间都不大，我的每月5美元的VPS也只有25G的硬盘，所以不能在服务器存太多文件，如果是电影的话建议看完就可以删了，不要留在服务器里，</p><p>下面是我的安装过程</p><p>先用远程工具连接服务器，我使用的Linux版本是CentOS6，</p><p>输入下面的命令来安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install transmission transmission-daemon</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/搭建离线下载1.jpg" alt="下载安装"></p><p>接下来会显示软件大小，然后询问是否继续，输入y继续安装</p><p><img src="https://wsmcb.github.io/img/搭建离线下载2.jpg" alt="询问是否继续"></p><p>等待一段时间，安装完成后启动Transmission-daemon服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service transmission-daemon start</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/搭建离线下载3.jpg" alt="启动服务"></p><p>第一次启动服务后会生成一个配置文件，接下来就是更改配置文件，配置文件是JSON格式的，大多数程序员应该都能看懂，不过要更改配置文件需要先停止Transmission-daemon服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service transmission-daemon stop</span><br></pre></td></tr></table></figure><p><img src="https://wsmcb.github.io/img/搭建离线下载4.jpg" alt="停止服务"></p><p>配置文件的位置在/var/lib/transmission/settings.json，可以用vi等工具编辑，主要要修改的有以下几项：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"rpc-whitelist-enabled": "false"</span><br></pre></td></tr></table></figure><p>这是白名单验证，只有设置过的IP才可以访问，建议设置为false：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"rpc-authentication-required": "true",</span><br><span class="line">"rpc-password": "设置用户名",</span><br><span class="line">"rpc-username": "设置密码"</span><br></pre></td></tr></table></figure><p>上面的3项分别是：</p><ol><li>启用用户名和密码的验证，建议设置为true，虽然这个离线下载页面一般不会有其他人访问，但还是建议开启用户名和密码验证，</li><li>设置登录的用户名，</li><li>设置登录的密码，</li></ol><p>除了上面说到的设置项外还可以设置端口和下载路径等，设置完成后保存，然后启动Transmission-daemon服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service transmission-daemon start</span><br></pre></td></tr></table></figure><p>这个软件可以通过web页面来新建下载任务，访问下载页面的方式是IP + 端口号，如果有域名的话也可以使用域名 + 端口号，或者设置反向代理也可以，IP + 端口号的格式是127.0.0.1:9091，这里的IP只是随便写的，默认的端口号是9091，也可以在配置文件里更改端口号，注意！修改设置文件需要先停止服务。</p><p>离线下载页面，</p><p><img src="https://wsmcb.github.io/img/离线下载页面.jpg" alt="离线下载页面"></p><p>输入设置的用户名和密码，如果没有启用用户名和密码验证的话直接就可以进入下载页面，</p><p>下载页面，</p><p><img src="https://wsmcb.github.io/img/离线下载页面2.jpg" alt="离线下载页面2"></p><p>点击Open新建任务，可以上传种子文件和输入磁力链接，</p><p><img src="https://wsmcb.github.io/img/新建任务.jpg" alt="新建任务"></p><p>点击Upload开始下载，默认的下载路径是/var/lib/transmission/Downloads，如果要把文件从服务器下载到本地可以使用FTP工具，推荐使用Xftp 5这个软件，或者也可以搭建一个Web服务器，把下载路径设置到Web目录，这样如果是视频或音频的话就可以在线观看了。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> Linux相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 下载 </tag>
            
            <tag> VPS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql数据库导入和导出</title>
      <link href="/2018/04/02/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA/"/>
      <url>/2018/04/02/Mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<p>对于站长来说可能会遇到需要完整迁移网站的情况，而和网站相关的数据库也必须要一起迁移，这里就来说一下Mysql数据库的简单导入和导出。<br><a id="more"></a></p><h2 id="在Linux下导出数据库"><a href="#在Linux下导出数据库" class="headerlink" title="在Linux下导出数据库"></a>在Linux下导出数据库</h2><p>完整语句</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -h198.13.60.124 -P3306 -proot wordpress  &gt; /home/wordpress.sql</span><br></pre></td></tr></table></figure><p>这里我导出了一个名为wordpress的数据库，下面是参数说明：</p><ul><li>mysqldump mysqldump是Mysql用于导出数据库的程序</li><li>-u -u后面紧跟用户名</li><li>-h -h后面紧跟服务器地址，如果是在本地或使用Linux远程工具操作可不写-h参数</li><li>-P -P后面紧跟端口号，如果是本地或Linux远程工具操作也可以不写-P参数</li><li>-p -p后面紧跟数据库密码，如果没有密码-p后面可空</li><li>这里的wordpress是我要导出数据库的名称</li><li>/home/wordpress.sql是导出保存的文件路径和文件名</li></ul><p>上面就是在Linux下导出数据库的方法。</p><h2 id="在Linux下导入数据库"><a href="#在Linux下导入数据库" class="headerlink" title="在Linux下导入数据库"></a>在Linux下导入数据库</h2><p>导入数据库也比较简单，先连接数据库</p><p><img src="https://wsmcb.github.io/img/连接数据库.jpg" alt="连接数据库"></p><p>连接数据库后选择你要导入到哪个数据库，还是用use语句，选择完成后输入导入的SQL语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SOURCE /home/wordpress.sql</span><br></pre></td></tr></table></figure><p>SOURCE是导入数据库资源的语句，/home/wordpress.sql是文件路径和文件名，</p><p>当看到如下提示的时候说明导入成功，</p><p><img src="https://wsmcb.github.io/img/mysql导入完成.jpg" alt="mysql导入完成"></p><p>这里的行数是根据你的数据量显示的，</p><p>上面就是Linux导入数据库的方法。</p><h2 id="Windows下导出数据库"><a href="#Windows下导出数据库" class="headerlink" title="Windows下导出数据库"></a>Windows下导出数据库</h2><p>方法和Linux的差不多，下面是语句</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -h127.0.0.1 -P3306 -proot message_board &gt; D:\message_board.sql</span><br></pre></td></tr></table></figure><p>方法和Linux的差不多，文件路径按照Windows的写</p><p><img src="https://wsmcb.github.io/img/win导出数据库.jpg" alt="win导出数据库"></p><p>具体的参数说明可参考上面Linux的，在本地操作可省略服务器地址和端口号，</p><p>上面就是Windows导出数据库的方法。</p><h2 id="Windows导入数据库"><a href="#Windows导入数据库" class="headerlink" title="Windows导入数据库"></a>Windows导入数据库</h2><p>方法还是和Linux的差不多，先连接数据库，然后在选择数据库，然后输入SQL语句，</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SOURCE D:\message_board.sql</span><br></pre></td></tr></table></figure><p>只有文件路径不同，</p><p><img src="https://wsmcb.github.io/img/win导入数据库.jpg" alt="win导入数据库"></p><p>导入完成，</p><p><img src="https://wsmcb.github.io/img/win导入成功.jpg" alt="win导入成功"></p><p>上面就是Windows导入数据库的方法。</p><p>除了上面的方法外也可以使用数据库管理工具来导入导出，例如JetBrains DataGrip和phpMyAdmin都可以导入和导出数据库，不过一般的虚拟主机都只能使用phpMyAdmin来管理数据库，这里就来说一下phpMyAdmin导入和导出数据库。</p><h2 id="phpMyAdmin导出数据库"><a href="#phpMyAdmin导出数据库" class="headerlink" title="phpMyAdmin导出数据库"></a>phpMyAdmin导出数据库</h2><p>进入phpMyAdmin后进入你要导出的数据库，点击导出</p><p><img src="https://wsmcb.github.io/img/php导出数据库.jpg" alt="php导出数据库"></p><p>参数可以不用改，直接点击 “执行” 选择文件夹就可以导出了，</p><p><img src="https://wsmcb.github.io/img/php执行导出.jpg" alt="php执行导出"></p><p>phpMyAdmin导出很简单，不用写命令。</p><h2 id="phpMyAdmin导入数据库"><a href="#phpMyAdmin导入数据库" class="headerlink" title="phpMyAdmin导入数据库"></a>phpMyAdmin导入数据库</h2><p>进入phpMyAdmin后在进入你要导入到的数据库，点击 “导入，</p><p><img src="https://wsmcb.github.io/img/PHP导入.jpg" alt="PHP导入"></p><p>先选择文件，然后点击 “执行”，</p><p><img src="https://wsmcb.github.io/img/php导入执行.jpg" alt="php导入执行"></p><p>导入完成</p><p><img src="https://wsmcb.github.io/img/php导入完成.jpg" alt="php导入完成"></p><p>注意！如果数据库文件无法上传的话可以检查一下PHP的配置文件，看一下数据库文件大小是否超出PHP配置文件设置的 最大允许上传文件的大小，这里说的是自己搭建服务器的站长，如果是虚拟主机的话，一般虚拟主机设置的都会比较大，而且虚拟主机也不能修改PHP配置文件。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Win10配置Mysql和PHP的环境变量</title>
      <link href="/2018/03/22/Win10%E9%85%8D%E7%BD%AEMysql%E5%92%8CPHP%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/"/>
      <url>/2018/03/22/Win10%E9%85%8D%E7%BD%AEMysql%E5%92%8CPHP%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<p>如果你想在CMD命令行运行MYSQL或PHP就需要配置环境变量，在命令行运行PHP无需依赖服务器环境。<br><a id="more"></a><br>MYSQL配置方法：</p><p>打开你的MYSQL安装目录，因为我这里用的是WAMP集成环境，所以我的MYSQL安装位置是”D:\phpStudy\MySQL”，进入MYSQL安装目录后在进入bin文件夹，然后复制地址栏的地址，</p><p><img src="https://wsmcb.github.io/img/mysql位置.jpg" alt="Mysql位置"></p><p>复制完成后打开控制面板-&gt;系统和安全-&gt;系统，点击 “高级系统设置”，</p><p><img src="https://wsmcb.github.io/img/控制面板-系统.jpg" alt="控制面板-系统"></p><p>进入高级系统设置后点击 “环境变量”，</p><p><img src="https://wsmcb.github.io/img/控制面板-系统控制.jpg" alt="控制面板-系统控制"></p><p>选择 “Path” 然后点击 “编辑”，</p><p><img src="https://wsmcb.github.io/img/控制变量.jpg" alt="控制变量"></p><p>点击 “添加”，</p><p><img src="https://wsmcb.github.io/img/新建.jpg" alt="新建"></p><p>粘贴之前复制的路径，如果你记得的话也可以直接输入，输入完成后回车然后确定，</p><p><img src="https://wsmcb.github.io/img/完成.jpg" alt="完成"></p><p>这样就完成了MYSQL环境变量的配置。</p><p>如果要在CMD命令行使用MYSQL的话可以直接输入 “mysql -u你的用户名 -p” 然后输入密码就可以进入MYSQL了，这里可以直接输入SQL语句，如果要退出就输入 “exit”。</p><p><img src="https://wsmcb.github.io/img/命令行用mysql.jpg" alt="命令行用mysql"></p><p>PHP的配置方法和MYSQL的差不多，打开你的PHP的安装目录，然后复制路径，我的路径是 “D:\phpStudy\php\php-7.0.12-nts”，</p><p><img src="https://wsmcb.github.io/img/PHP位置.jpg" alt="PHP位置"></p><p>然后和MYSQL一样添加环境变量，最后的添加内容是你的PHP的路径。</p><p>在命令行运行PHP的方法是输入php + 你的PHP的文件路径，例如我的D盘有一个名为hello.php的php文件，我要运行这个文件就需要输入 “php D:\hello.php”，</p><p><img src="https://wsmcb.github.io/img/CMD运行PHP.jpg" alt="CMD运行PHP"></p><p>注意！一些功能需要在服务器环境下才可以使用。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mysql </tag>
            
            <tag> PHP </tag>
            
            <tag> Win10 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript实现鼠标拖拽</title>
      <link href="/2018/03/18/JavaScript%E5%AE%9E%E7%8E%B0%E9%BC%A0%E6%A0%87%E6%8B%96%E6%8B%BD/"/>
      <url>/2018/03/18/JavaScript%E5%AE%9E%E7%8E%B0%E9%BC%A0%E6%A0%87%E6%8B%96%E6%8B%BD/</url>
      
        <content type="html"><![CDATA[<p>鼠标拖拽是计算机软件中常见的一种功能，无论是拖拽文件到回收站又或是拖拽窗口，都给我们的使用带来了很多便捷和乐趣。虽然在网站中拖拽功能并不常见，但在一些地方加入拖拽功能也能带来意想不到的好处，这里就用JavaScript实现元素拖拽。<br><a id="more"></a><br>HTML和CSS代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>拖拽<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        *&#123;</span></span><br><span class="line"><span class="undefined">            margin: 0;</span></span><br><span class="line"><span class="undefined">            padding: 0;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        div&#123;</span></span><br><span class="line"><span class="undefined">            width: 100px;</span></span><br><span class="line"><span class="undefined">            height: 100px;</span></span><br><span class="line"><span class="undefined">            background: #FF5080;</span></span><br><span class="line"><span class="undefined">            position: absolute;</span></span><br><span class="line"><span class="undefined">            cursor: move;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"拖拽.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>要实现拖拽功能需要给被拖拽的元素设置定位，把被拖拽元素的cursor属性设置为move可提醒用户此元素是可以拖动的。</p><p>JS代码：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Div = <span class="built_in">document</span>.querySelector(<span class="string">'div'</span>);  <span class="comment">//  获取div元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  div鼠标按下</span></span><br><span class="line">Div.onmousedown = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ev = ev || event;  <span class="comment">//  获取Event 对象</span></span><br><span class="line">    <span class="keyword">var</span> X = ev.clientX - <span class="keyword">this</span>.offsetLeft;  <span class="comment">//  鼠标位置的X轴 - div的left</span></span><br><span class="line">    <span class="keyword">var</span> Y = ev.clientY - <span class="keyword">this</span>.offsetTop;  <span class="comment">//  鼠标位置的Y轴 - div的top</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  文档鼠标移动</span></span><br><span class="line">    <span class="built_in">document</span>.onmousemove = <span class="function"><span class="keyword">function</span>(<span class="params">ev</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> ev = ev || event;  <span class="comment">//  获取Event 对象</span></span><br><span class="line">        Div.style.left = ev.clientX - X + <span class="string">'px'</span>;  <span class="comment">//  设置div的left</span></span><br><span class="line">        Div.style.top = ev.clientY - Y + <span class="string">'px'</span>;  <span class="comment">//  设置div的top</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  文档鼠标按键被松开</span></span><br><span class="line">    <span class="built_in">document</span>.onmouseup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.onmousemove = <span class="literal">null</span>;  <span class="comment">//  清空文档的移动事件</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;  <span class="comment">//  阻止一些浏览器的默认事件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>div鼠标被按下后 X变量会保存鼠标当前位置 – div的left，X变量会保存鼠标当前位置 – div的top，这里给document加移动事件是为了防止因鼠标移动过快而导致鼠标移出div，当鼠标按下并且移动的时候设置div的left为鼠标当前位置 – X变量的值，top也是同理，当鼠标放开后清空document的移动事件可停止移动。这里只是写了简单的拖拽，并没有限制div的可拖动范围。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP实现简单单文件上传</title>
      <link href="/2018/03/17/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%8D%95%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2018/03/17/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%8D%95%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<p>无论是社区网站还是电商网站都离不开上传文件的功能，这里就用PHP实现简单单文件上传，后续还会写更复杂的AJAX和多文件上传。<br><a id="more"></a></p><p>HTML表单：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"server1.php"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"img"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"上传文件"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>默认的文件选择按钮会比较丑，如果想美化文件选择按钮可以把文件选择按钮隐藏，定义一个普通按钮，通过普通按钮来调用文件选择按钮的点击事件。</p><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$file = $_FILES[<span class="string">'img'</span>];  <span class="comment">//  把文件传给一个变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  判断是否有错误，error大于0说明有错误</span></span><br><span class="line"><span class="keyword">if</span> ($file[<span class="string">'error'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">'文件上传出错!错误码'</span> . $file[<span class="string">'error'</span>]);  <span class="comment">//  不在往下执行，输出错误码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  判断文件大小是否超过1M</span></span><br><span class="line"><span class="keyword">if</span> ($file[<span class="string">'size'</span>] &gt; <span class="number">1048576</span>) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">'文件大小不能超过1M'</span>);  <span class="comment">//  文件超过1M，不在往下执行</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  判断文件扩展名的方法有很多，这里就用正则表达式来判断扩展名</span></span><br><span class="line">$re = <span class="string">"/\.jpg$|\.png$|\.gif$/"</span>;  <span class="comment">//  用一个简单的正则表达式来判断扩展名</span></span><br><span class="line">$extensionName = <span class="keyword">array</span>();  <span class="comment">//  用来接收扩展名的数组</span></span><br><span class="line">preg_match($re, $file[<span class="string">'name'</span>], $extensionName);  <span class="comment">//  如果匹配成功会返回扩展名</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  如果数组大于0说明匹配成功</span></span><br><span class="line"><span class="keyword">if</span> (count($extensionName) &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">'不支持的文件格式'</span>);  <span class="comment">//  不在往下执行</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  把上传的文件移动到指定文件夹，成功返回true 失败返回false</span></span><br><span class="line"><span class="keyword">if</span> (move_uploaded_file($file[<span class="string">'tmp_name'</span>], <span class="string">'files/'</span> . $file[<span class="string">'name'</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'文件上传成功'</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'文件上传失败'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$_FILES全局数组可接收客户端上传的文件，第一个参数是表单的 input name，第二个下标可以是 “name”, “type”, “size”, “tmp_name” 或 “error”，这里使用的表单的input名称就是img，</p><p>详细说明：</p><ul><li>$_FILES[‘img’][‘name’] 被上传文件的名称</li><li>$_FILES[‘img’][‘size’] 被上传文件的大小，以字节计</li><li>$_FILES[‘img’][‘type’] 被上传文件的类型</li><li>$_FILES[‘img’][‘tmp_name’] 存储在服务器的文件的临时副本的名称</li><li>$_FILES[‘img’][‘error’] 由文件上传导致的错误代码</li></ul><p>错误代码说明：</p><ul><li>0 没有错误</li><li>1 上传的文件超过了 php.ini 中 upload_max_filesize 选项限制的值</li><li>2 上传文件的大小超过了 HTML 表单中 MAX_FILE_SIZE 选项指定的值</li><li>3 文件只有部分被上传</li><li>4 没有文件被上传。 是指表单的file域没有内容</li></ul><p>move_uploaded_file()函数可以把上传的文件移动到指定文件夹，参数1是文件位置，参数2是文件名，同时也包含文件路径，成功会返回true，失败会返回false。</p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 上传文件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML5 localStorage的简单使用</title>
      <link href="/2017/12/07/HTML5-localStorage%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
      <url>/2017/12/07/HTML5-localStorage%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>localStorage是HTML5中新增的一种本地存储功能，localStorage和cookie相比具有存储容量更大和操作简单等优点，cookie的单个存储容量一般最大不能超过4KB，而localStorage一般最大为5MB。<br><a id="more"></a></p><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>保存：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">localStorage.setItem(key, value);  <span class="comment">//  保存数据，接收键名和键值</span></span><br><span class="line">localStorage.setItem(email, <span class="string">'12345678@qq.com'</span>);  <span class="comment">//  保存一个123456789@qq.com的email</span></span><br></pre></td></tr></table></figure><p>读取：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">localStorage.getItem(key);  <span class="comment">//  读取数据，接收一个键名，返回保存的文本内容，如果为找到 返回null</span></span><br><span class="line">localStorage.getItem(<span class="string">'email'</span>);  <span class="comment">//  读取刚才保存的email</span></span><br></pre></td></tr></table></figure><p>删除：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">localStorage.removeItem(key);  <span class="comment">//  删除指定键名的数据，接收一个键名</span></span><br><span class="line">localStorage.removeItem(<span class="string">'email'</span>);  <span class="comment">//  删除刚才保存的email</span></span><br><span class="line">localStorage.clear();;  <span class="comment">//  删除所有，只会删除此域名下的</span></span><br></pre></td></tr></table></figure><p>以上就是常用的localStorage方法，不过因为localStorage只能保存字符串，所以如果要存储JSON就需要先把JSON转换为字符串，而且读取的时候也需要把读取的字符串转换为JSON。localStorage是HTML5新加入的功能，只有支持HTML5的浏览器才可以使用localStorage。</p><p>下面是一些常用的localStorage功能：</p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>setItem</td><td>保存数据</td></tr><tr><td>getItem</td><td>读取数据</td></tr><tr><td>key</td><td>读取第i个数据的名字或称为键值(从0开始计数)</td></tr><tr><td>length</td><td>localStorage存储变量的个数</td></tr><tr><td>propertyIsEnumerable</td><td>用来检测属性是否属于某个对象的</td></tr><tr><td>valueOf</td><td>获取所有存储的数据</td></tr><tr><td>removeItem</td><td>删除某个具体变量</td></tr><tr><td>clear</td><td>清空localStorage上存储的数据</td></tr></tbody></table><p>我的个人博客： <a href="http://www.changbin.me" target="_blank" rel="noopener">http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> 前端开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP实现简单图片验证码</title>
      <link href="/2017/12/07/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81/"/>
      <url>/2017/12/07/PHP%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>验证码是网站会员系统中不可缺少的，目前验证码有很多种，但用的比较多的还是图片验证码，这里就用面向对象的方式来简单的实现图片验证码，<br><a id="more"></a></p><h2 id="PHP类"><a href="#PHP类" class="headerlink" title="PHP类"></a>PHP类</h2><p>PHP代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Administrator</span></span><br><span class="line"><span class="comment"> * Date: 2017/10/6</span></span><br><span class="line"><span class="comment"> * Time: 20:44</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Verification</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $fontfile = <span class="string">''</span>;  <span class="comment">//  字体文件</span></span><br><span class="line">    <span class="keyword">protected</span> $width = <span class="number">120</span>;  <span class="comment">//  图片宽度 默认120</span></span><br><span class="line">    <span class="keyword">protected</span> $height = <span class="number">40</span>;  <span class="comment">//  图片高度  默认40</span></span><br><span class="line">    <span class="keyword">protected</span> $size = <span class="number">20</span>;  <span class="comment">//  字体大小  默认20</span></span><br><span class="line">    <span class="keyword">protected</span> $length = <span class="number">4</span>;  <span class="comment">//  长度  默认4个字</span></span><br><span class="line">    <span class="keyword">protected</span> $image = <span class="keyword">null</span>;  <span class="comment">//  画布资源</span></span><br><span class="line">    <span class="keyword">protected</span> $snow = <span class="number">0</span>;  <span class="comment">//  雪花干扰  默认没有干扰</span></span><br><span class="line">    <span class="keyword">protected</span> $pixel = <span class="number">0</span>;  <span class="comment">//  像素点干扰  默认没有干扰</span></span><br><span class="line">    <span class="keyword">protected</span> $line = <span class="number">0</span>;  <span class="comment">//  线段干扰  默认没有干扰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//  初始化数据</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($config = array<span class="params">()</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_array($config) &amp;&amp; count($config) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//  检测字体文件是否存在</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'fontfile'</span>]) &amp;&amp; is_file($config[<span class="string">'fontfile'</span>])) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;fontfile = $config[<span class="string">'fontfile'</span>];  <span class="comment">//  设置字体文件位置</span></span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了宽度和宽度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'width'</span>]) &amp;&amp; $config[<span class="string">'width'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">//  设置宽度属性为传入的宽度</span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;width = (int)$config[<span class="string">'width'</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入高度和高度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'height'</span>]) &amp;&amp; $config[<span class="string">'height'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;height = (int)$config[<span class="string">'height'</span>];  <span class="comment">//  设置高度属性</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了字体大小和是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'size'</span>]) &amp;&amp; $config[<span class="string">'size'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;size = (int)$config[<span class="string">'size'</span>];  <span class="comment">//  设置字体大小属性</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否传入了验证码长度和长度是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'length'</span>]) &amp;&amp; $config[<span class="string">'length'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;length = (int)$config[<span class="string">'length'</span>];  <span class="comment">//  设置长度</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了雪花干扰以及雪花数量是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'snow'</span>]) &amp;&amp; $config[<span class="string">'lsnow'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;snow = (int)$config[<span class="string">'snow'</span>];  <span class="comment">//  设置雪花干扰</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了像素点干扰和数量是否大于0</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'pixel'</span>]) &amp;&amp; $config[<span class="string">'pixel'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;pixel = (int)$config[<span class="string">'pixel'</span>];  <span class="comment">//  设置像素点干扰</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//  判断是否设置了线条干扰和线条数量</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">isset</span>($config[<span class="string">'line'</span>]) &amp;&amp; $config[<span class="string">'line'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;line = (int)$config[<span class="string">'line'</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;image = imagecreatetruecolor(<span class="keyword">$this</span>-&gt;width,<span class="keyword">$this</span>-&gt;height);  <span class="comment">//  创建画布</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;image;  <span class="comment">//  返回i画布资源</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成验证码</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getCaptcha</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//  创建白色作为背景</span></span><br><span class="line">        $white = imagecolorallocate(<span class="keyword">$this</span>-&gt;image,<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">        <span class="comment">//  填充背景颜色</span></span><br><span class="line">        imagefilledrectangle(<span class="keyword">$this</span>-&gt;image, <span class="number">0</span>, <span class="number">0</span>, <span class="keyword">$this</span>-&gt;width, <span class="keyword">$this</span>-&gt;height, $white);</span><br><span class="line">        <span class="comment">//  调用生成验证码内容的方法</span></span><br><span class="line">        $str = <span class="keyword">$this</span>-&gt;generateStr(<span class="keyword">$this</span>-&gt;length);</span><br><span class="line">        <span class="comment">//  判断生成内容是否成功</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">false</span> === $str) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $fontfile = <span class="keyword">$this</span>-&gt;fontfile;  <span class="comment">//  设置字体文件位置</span></span><br><span class="line">        <span class="comment">//  使用for循环来生成图片验证码，循环次数是验证码的长度</span></span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;length;$i ++) &#123;</span><br><span class="line">            $size = <span class="keyword">$this</span>-&gt;size;  <span class="comment">//  设置字体大小</span></span><br><span class="line">            $angle = rand(<span class="number">-30</span>, <span class="number">30</span>);  <span class="comment">//  设置字体角度</span></span><br><span class="line">            $x = ceil(<span class="keyword">$this</span>-&gt;width / <span class="keyword">$this</span>-&gt;length) * $i + rand(<span class="number">5</span>, <span class="number">10</span>);  <span class="comment">//  设置X轴位置</span></span><br><span class="line">            $y = ceil(<span class="keyword">$this</span>-&gt;height / <span class="number">1.5</span>);  <span class="comment">//  设置X轴位置</span></span><br><span class="line">            <span class="comment">//  设置字体颜色，调用生成随机颜色的方法</span></span><br><span class="line">            $color = <span class="keyword">$this</span>-&gt;getRandColor();</span><br><span class="line">            $text = $str&#123;$i&#125;;  <span class="comment">//  设置验证码内容</span></span><br><span class="line">            <span class="comment">//  把验证码添加到画布上</span></span><br><span class="line">            imagettftext(<span class="keyword">$this</span>-&gt;image, $size, $angle, $x, $y, $color, $fontfile, $text);  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//  是否需要雪花干扰</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;snow &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;getSnow();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  只有在没有雪花干扰的情况下才可以使用像素点和线段干扰</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;pixel) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;getPixel();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;line) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;getLine();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        header(<span class="string">'content-type:image/png'</span>);  <span class="comment">//  设置显示方式</span></span><br><span class="line">        imagepng(<span class="keyword">$this</span>-&gt;image);  <span class="comment">//  把生成的验证码图片显示在网页上</span></span><br><span class="line">        imagedestroy(<span class="keyword">$this</span>-&gt;image);  <span class="comment">//  销毁画布 节省资源</span></span><br><span class="line">        <span class="keyword">return</span> strtolower($str);  <span class="comment">//  返回生成的验证码内容，用来设置session验证</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成雪花干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getSnow</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;snow;$i ++) &#123;</span><br><span class="line">            imagestring(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">1</span>, <span class="number">5</span>), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="string">'*'</span>, <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成像素点干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getPixel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;pixel;$i ++) &#123;</span><br><span class="line">            imagesetpixel(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  线段干扰</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getLine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>;$i &lt; <span class="keyword">$this</span>-&gt;line;$i ++) &#123;</span><br><span class="line">            imageline(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;width), rand(<span class="number">0</span>, <span class="keyword">$this</span>-&gt;height), <span class="keyword">$this</span>-&gt;getRandColor());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  生成验证码字符</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">generateStr</span><span class="params">($length = <span class="number">4</span>)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//  判断验证码长度是否小于1或大于30</span></span><br><span class="line">        <span class="keyword">if</span> ($length &lt; <span class="number">1</span> || $length &gt; <span class="number">30</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//  验证码可能出现的内容</span></span><br><span class="line">            $chars = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>, <span class="string">'g'</span>, <span class="string">'h'</span>, <span class="string">'j'</span>, <span class="string">'k'</span>, <span class="string">'m'</span>, <span class="string">'n'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>, <span class="string">'r'</span>, <span class="string">'s'</span>, <span class="string">'t'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'w'</span>, <span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>,</span><br><span class="line">                <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'J'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'R'</span>, <span class="string">'S'</span>,<span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>,</span><br><span class="line">                <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span></span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//  取出指定长度的验证码</span></span><br><span class="line">        $str = join(<span class="string">''</span>, array_rand(array_flip($chars), $length));</span><br><span class="line">        <span class="keyword">return</span> $str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  用来生成随机颜色的</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">getRandColor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> imagecolorallocate(<span class="keyword">$this</span>-&gt;image, rand(<span class="number">0</span>, <span class="number">255</span>), rand(<span class="number">0</span>, <span class="number">255</span>), rand(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>对象接收一个数组，除字体文件以外其他参数可以省略，省略的参数会使用默认参数，下面是简单说明：</p><table><thead><tr><th>参数</th><th>类型</th><th>参数可省略</th><th>说明</th></tr></thead><tbody><tr><td>fontfile</td><td>string</td><td>否</td><td>字体文件名称</td></tr><tr><td>width</td><td>int</td><td>是</td><td>图片宽度，默认120px</td></tr><tr><td>height</td><td>int</td><td>是</td><td>图片高度，默认40px</td></tr><tr><td>size</td><td>int</td><td>是</td><td>字体大小，默认20px</td></tr><tr><td>length</td><td>int</td><td>是</td><td>验证码长度，默认4个字</td></tr><tr><td>snow</td><td>int</td><td>是</td><td>雪花干扰，默认为0，没有干扰</td></tr><tr><td>pixel</td><td>int</td><td>是</td><td>像素点干扰，默认为0，没有干扰</td></tr><tr><td>line</td><td>int</td><td>是</td><td>线条干扰，默认为0，没有干扰</td></tr></tbody></table><p>代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by PhpStorm.</span></span><br><span class="line"><span class="comment"> * User: Administrator</span></span><br><span class="line"><span class="comment"> * Date: 2017/10/8</span></span><br><span class="line"><span class="comment"> * Time: 16:55</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'verification_class.php'</span>;  <span class="comment">//  引入类文件</span></span><br><span class="line">$arr = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'fontfile'</span>=&gt;<span class="string">'fonts/arial.ttf'</span>,  <span class="comment">//  字体文件位置</span></span><br><span class="line">    <span class="string">'line'</span>=&gt;<span class="number">4</span>,  <span class="comment">//  设置线条干扰数量为4</span></span><br><span class="line">    <span class="string">'pixel'</span>=&gt;<span class="number">50</span>  <span class="comment">//  设置像素点干扰为50</span></span><br><span class="line">);</span><br><span class="line">$img = <span class="keyword">new</span> Verification($arr);  <span class="comment">//  实例化对象并且传入数组</span></span><br><span class="line">session_start();  <span class="comment">//  启用session</span></span><br><span class="line">$_SESSION[<span class="string">'str'</span>] = $img-&gt;getCaptcha();  <span class="comment">//  把返回的验证码保存到session</span></span><br></pre></td></tr></table></figure><p>完整的传入数组参数可在类属性看到</p><p>最终效果如下：</p><p><img src="http://www.changbin.me/img/图片验证码.jpg" alt="验证码图片"></p><p>验证码的每一个字都是随机颜色，角度也是随机的，如果要让验证码在img标签显示 就把img的src设置为调用类的php文件即可。</p><h2 id="验证方法"><a href="#验证方法" class="headerlink" title="验证方法"></a>验证方法</h2><p>直接判断表单提交的参数和session保存的验证码是否一致即可。</p><p>这就是简单实现图片验证码的方法，这个验证码还有很大的优化空间。</p><p>代码下载可点击下方的下载代码链接，百度网盘提取码：w39g</p><p><a href="https://pan.baidu.com/s/1pKU5PB9" target="_blank" rel="noopener">下载代码</a></p><p><a href="http://www.changbin.me" target="_blank" rel="noopener">我的博客：http://www.changbin.me</a></p>]]></content>
      
      
      <categories>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> 验证码 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
